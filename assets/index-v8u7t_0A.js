var Bs=Object.defineProperty;var Ms=(n,e,t)=>e in n?Bs(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Pt=(n,e,t)=>(Ms(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function A(){}const ns=n=>n;function at(n,e){for(const t in e)n[t]=e[t];return n}function is(n){return n()}function dr(){return Object.create(null)}function we(n){n.forEach(is)}function St(n){return typeof n=="function"}function J(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let dt;function ce(n,e){return n===e?!0:(dt||(dt=document.createElement("a")),dt.href=e,n===dt.href)}function Fs(n){return Object.keys(n).length===0}function os(n,...e){if(n==null){for(const r of e)r(void 0);return A}const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function zs(n,e,t){n.$$.on_destroy.push(os(e,t))}function as(n,e,t,r){if(n){const s=ls(n,e,t,r);return n[0](s)}}function ls(n,e,t,r){return n[1]&&r?at(t.ctx.slice(),n[1](r(e))):t.ctx}function cs(n,e,t,r){if(n[2]&&r){const s=n[2](r(t));if(e.dirty===void 0)return s;if(typeof s=="object"){const i=[],o=Math.max(e.dirty.length,s.length);for(let l=0;l<o;l+=1)i[l]=e.dirty[l]|s[l];return i}return e.dirty|s}return e.dirty}function us(n,e,t,r,s,i){if(s){const o=ls(e,t,r,i);n.p(o,s)}}function hs(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let r=0;r<t;r++)e[r]=-1;return e}return-1}const ds=typeof window<"u";let Hs=ds?()=>window.performance.now():()=>Date.now(),Kt=ds?n=>requestAnimationFrame(n):A;const Je=new Set;function fs(n){Je.forEach(e=>{e.c(n)||(Je.delete(e),e.f())}),Je.size!==0&&Kt(fs)}function Js(n){let e;return Je.size===0&&Kt(fs),{promise:new Promise(t=>{Je.add(e={c:n,f:t})}),abort(){Je.delete(e)}}}function f(n,e){n.appendChild(e)}function _s(n){if(!n)return document;const e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function Gs(n){const e=p("style");return e.textContent="/* empty */",Ks(_s(n),e),e.sheet}function Ks(n,e){return f(n.head||n,e),e.sheet}function C(n,e,t){n.insertBefore(e,t||null)}function O(n){n.parentNode&&n.parentNode.removeChild(n)}function ye(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function p(n){return document.createElement(n)}function G(n){return document.createTextNode(n)}function $(){return G(" ")}function pe(){return G("")}function fe(n,e,t,r){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}function d(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function Vs(n){return Array.from(n.childNodes)}function ee(n,e){e=""+e,n.data!==e&&(n.data=e)}function Ee(n,e){n.value=e??""}function Qe(n,e,t,r){t==null?n.style.removeProperty(e):n.style.setProperty(e,t,"")}function ps(n,e,{bubbles:t=!1,cancelable:r=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:r})}function bt(n,e){return new n(e)}const vt=new Map;let wt=0;function Ws(n){let e=5381,t=n.length;for(;t--;)e=(e<<5)-e^n.charCodeAt(t);return e>>>0}function Ys(n,e){const t={stylesheet:Gs(e),rules:{}};return vt.set(n,t),t}function Xs(n,e,t,r,s,i,o,l=0){const a=16.666/r;let c=`{
`;for(let v=0;v<=1;v+=a){const k=e+(t-e)*i(v);c+=v*100+`%{${o(k,1-k)}}
`}const u=c+`100% {${o(t,1-t)}}
}`,h=`__svelte_${Ws(u)}_${l}`,_=_s(n),{stylesheet:m,rules:g}=vt.get(_)||Ys(_,n);g[h]||(g[h]=!0,m.insertRule(`@keyframes ${h} ${u}`,m.cssRules.length));const b=n.style.animation||"";return n.style.animation=`${b?`${b}, `:""}${h} ${r}ms linear ${s}ms 1 both`,wt+=1,h}function fr(n,e){const t=(n.style.animation||"").split(", "),r=t.filter(e?i=>i.indexOf(e)<0:i=>i.indexOf("__svelte")===-1),s=t.length-r.length;s&&(n.style.animation=r.join(", "),wt-=s,wt||Qs())}function Qs(){Kt(()=>{wt||(vt.forEach(n=>{const{ownerNode:e}=n.stylesheet;e&&O(e)}),vt.clear())})}let lt;function nt(n){lt=n}function Et(){if(!lt)throw new Error("Function called outside component initialization");return lt}function ct(n){Et().$$.on_mount.push(n)}function Zs(n){Et().$$.after_update.push(n)}function en(n){Et().$$.on_destroy.push(n)}function tn(){const n=Et();return(e,t,{cancelable:r=!1}={})=>{const s=n.$$.callbacks[e];if(s){const i=ps(e,t,{cancelable:r});return s.slice().forEach(o=>{o.call(n,i)}),!i.defaultPrevented}return!0}}function _r(n,e){const t=n.$$.callbacks[e.type];t&&t.slice().forEach(r=>r.call(this,e))}const ze=[],yt=[];let Ge=[];const pr=[],ms=Promise.resolve();let Bt=!1;function gs(){Bt||(Bt=!0,ms.then(vs))}function bs(){return gs(),ms}function _e(n){Ge.push(n)}const Rt=new Set;let Ne=0;function vs(){if(Ne!==0)return;const n=lt;do{try{for(;Ne<ze.length;){const e=ze[Ne];Ne++,nt(e),rn(e.$$)}}catch(e){throw ze.length=0,Ne=0,e}for(nt(null),ze.length=0,Ne=0;yt.length;)yt.pop()();for(let e=0;e<Ge.length;e+=1){const t=Ge[e];Rt.has(t)||(Rt.add(t),t())}Ge.length=0}while(ze.length);for(;pr.length;)pr.pop()();Bt=!1,Rt.clear(),nt(n)}function rn(n){if(n.fragment!==null){n.update(),we(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(_e)}}function sn(n){const e=[],t=[];Ge.forEach(r=>n.indexOf(r)===-1?e.push(r):t.push(r)),t.forEach(r=>r()),Ge=e}let tt;function nn(){return tt||(tt=Promise.resolve(),tt.then(()=>{tt=null})),tt}function mr(n,e,t){n.dispatchEvent(ps(`intro${t}`))}const gt=new Set;let Re;function W(){Re={r:0,c:[],p:Re}}function Y(){Re.r||we(Re.c),Re=Re.p}function w(n,e){n&&n.i&&(gt.delete(n),n.i(e))}function y(n,e,t,r){if(n&&n.o){if(gt.has(n))return;gt.add(n),Re.c.push(()=>{gt.delete(n),r&&(t&&n.d(1),r())}),n.o(e)}else r&&r()}const on={duration:0};function Le(n,e,t){const r={direction:"in"};let s=e(n,t,r),i=!1,o,l,a=0;function c(){o&&fr(n,o)}function u(){const{delay:_=0,duration:m=300,easing:g=ns,tick:b=A,css:v}=s||on;v&&(o=Xs(n,0,1,m,_,g,v,a++)),b(0,1);const k=Hs()+_,P=k+m;l&&l.abort(),i=!0,_e(()=>mr(n,!0,"start")),l=Js(T=>{if(i){if(T>=P)return b(1,0),mr(n,!0,"end"),c(),i=!1;if(T>=k){const S=g((T-k)/m);b(S,1-S)}}return i})}let h=!1;return{start(){h||(h=!0,fr(n),St(s)?(s=s(r),nn().then(u)):u())},invalidate(){h=!1},end(){i&&(c(),i=!1)}}}function te(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function kt(n,e){const t={},r={},s={$$scope:1};let i=n.length;for(;i--;){const o=n[i],l=e[i];if(l){for(const a in o)a in l||(r[a]=1);for(const a in l)s[a]||(t[a]=l[a],s[a]=1);n[i]=l}else for(const a in o)s[a]=1}for(const o in r)o in t||(t[o]=void 0);return t}function $t(n){return typeof n=="object"&&n!==null?n:{}}function L(n){n&&n.c()}function R(n,e,t){const{fragment:r,after_update:s}=n.$$;r&&r.m(e,t),_e(()=>{const i=n.$$.on_mount.map(is).filter(St);n.$$.on_destroy?n.$$.on_destroy.push(...i):we(i),n.$$.on_mount=[]}),s.forEach(_e)}function I(n,e){const t=n.$$;t.fragment!==null&&(sn(t.after_update),we(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function an(n,e){n.$$.dirty[0]===-1&&(ze.push(n),gs(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function K(n,e,t,r,s,i,o=null,l=[-1]){const a=lt;nt(n);const c=n.$$={fragment:null,ctx:[],props:i,update:A,not_equal:s,bound:dr(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:dr(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};o&&o(c.root);let u=!1;if(c.ctx=t?t(n,e.props||{},(h,_,...m)=>{const g=m.length?m[0]:_;return c.ctx&&s(c.ctx[h],c.ctx[h]=g)&&(!c.skip_bound&&c.bound[h]&&c.bound[h](g),u&&an(n,h)),_}):[],c.update(),u=!0,we(c.before_update),c.fragment=r?r(c.ctx):!1,e.target){if(e.hydrate){const h=Vs(e.target);c.fragment&&c.fragment.l(h),h.forEach(O)}else c.fragment&&c.fragment.c();e.intro&&w(n.$$.fragment),R(n,e.target,e.anchor),vs()}nt(a)}class V{constructor(){Pt(this,"$$");Pt(this,"$$set")}$destroy(){I(this,1),this.$destroy=A}$on(e,t){if(!St(t))return A;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(t),()=>{const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}$set(e){this.$$set&&!Fs(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const ln="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(ln);const qe=[];function ws(n,e){return{subscribe:Vt(n,e).subscribe}}function Vt(n,e=A){let t;const r=new Set;function s(l){if(J(n,l)&&(n=l,t)){const a=!qe.length;for(const c of r)c[1](),qe.push(c,n);if(a){for(let c=0;c<qe.length;c+=2)qe[c][0](qe[c+1]);qe.length=0}}}function i(l){s(l(n))}function o(l,a=A){const c=[l,a];return r.add(c),r.size===1&&(t=e(s,i)||A),l(n),()=>{r.delete(c),r.size===0&&t&&(t(),t=null)}}return{set:s,update:i,subscribe:o}}function ys(n,e,t){const r=!Array.isArray(n),s=r?[n]:n;if(!s.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const i=e.length<2;return ws(t,(o,l)=>{let a=!1;const c=[];let u=0,h=A;const _=()=>{if(u)return;h();const g=e(r?c[0]:c,o,l);i?o(g):h=St(g)?g:A},m=s.map((g,b)=>os(g,v=>{c[b]=v,u&=~(1<<b),a&&_()},()=>{u|=1<<b}));return a=!0,_(),function(){we(m),h(),a=!1}})}const We=Vt(localStorage.getItem("accType"));function cn(n,e){if(n instanceof RegExp)return{keys:!1,pattern:n};var t,r,s,i,o=[],l="",a=n.split("/");for(a[0]||a.shift();s=a.shift();)t=s[0],t==="*"?(o.push("wild"),l+="/(.*)"):t===":"?(r=s.indexOf("?",1),i=s.indexOf(".",1),o.push(s.substring(1,~r?r:~i?i:s.length)),l+=~r&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(l+=(~r?"?":"")+"\\"+s.substring(i))):l+="/"+s;return{keys:o,pattern:new RegExp("^"+l+"/?$","i")}}function un(n){let e,t,r;const s=[n[2]];var i=n[0];function o(l,a){let c={};for(let u=0;u<s.length;u+=1)c=at(c,s[u]);return a!==void 0&&a&4&&(c=at(c,kt(s,[$t(l[2])]))),{props:c}}return i&&(e=bt(i,o(n)),e.$on("routeEvent",n[7])),{c(){e&&L(e.$$.fragment),t=pe()},m(l,a){e&&R(e,l,a),C(l,t,a),r=!0},p(l,a){if(a&1&&i!==(i=l[0])){if(e){W();const c=e;y(c.$$.fragment,1,0,()=>{I(c,1)}),Y()}i?(e=bt(i,o(l,a)),e.$on("routeEvent",l[7]),L(e.$$.fragment),w(e.$$.fragment,1),R(e,t.parentNode,t)):e=null}else if(i){const c=a&4?kt(s,[$t(l[2])]):{};e.$set(c)}},i(l){r||(e&&w(e.$$.fragment,l),r=!0)},o(l){e&&y(e.$$.fragment,l),r=!1},d(l){l&&O(t),e&&I(e,l)}}}function hn(n){let e,t,r;const s=[{params:n[1]},n[2]];var i=n[0];function o(l,a){let c={};for(let u=0;u<s.length;u+=1)c=at(c,s[u]);return a!==void 0&&a&6&&(c=at(c,kt(s,[a&2&&{params:l[1]},a&4&&$t(l[2])]))),{props:c}}return i&&(e=bt(i,o(n)),e.$on("routeEvent",n[6])),{c(){e&&L(e.$$.fragment),t=pe()},m(l,a){e&&R(e,l,a),C(l,t,a),r=!0},p(l,a){if(a&1&&i!==(i=l[0])){if(e){W();const c=e;y(c.$$.fragment,1,0,()=>{I(c,1)}),Y()}i?(e=bt(i,o(l,a)),e.$on("routeEvent",l[6]),L(e.$$.fragment),w(e.$$.fragment,1),R(e,t.parentNode,t)):e=null}else if(i){const c=a&6?kt(s,[a&2&&{params:l[1]},a&4&&$t(l[2])]):{};e.$set(c)}},i(l){r||(e&&w(e.$$.fragment,l),r=!0)},o(l){e&&y(e.$$.fragment,l),r=!1},d(l){l&&O(t),e&&I(e,l)}}}function dn(n){let e,t,r,s;const i=[hn,un],o=[];function l(a,c){return a[1]?0:1}return e=l(n),t=o[e]=i[e](n),{c(){t.c(),r=pe()},m(a,c){o[e].m(a,c),C(a,r,c),s=!0},p(a,[c]){let u=e;e=l(a),e===u?o[e].p(a,c):(W(),y(o[u],1,1,()=>{o[u]=null}),Y(),t=o[e],t?t.p(a,c):(t=o[e]=i[e](a),t.c()),w(t,1),t.m(r.parentNode,r))},i(a){s||(w(t),s=!0)},o(a){y(t),s=!1},d(a){a&&O(r),o[e].d(a)}}}function gr(){const n=window.location.href.indexOf("#/");let e=n>-1?window.location.href.substr(n+1):"/";const t=e.indexOf("?");let r="";return t>-1&&(r=e.substr(t+1),e=e.substr(0,t)),{location:e,querystring:r}}const Wt=ws(null,function(e){e(gr());const t=()=>{e(gr())};return window.addEventListener("hashchange",t,!1),function(){window.removeEventListener("hashchange",t,!1)}}),fn=ys(Wt,n=>n.location);ys(Wt,n=>n.querystring);const br=Vt(void 0);async function _n(){await bs(),window.history.back()}function pn(n){n?window.scrollTo(n.__svelte_spa_router_scrollX,n.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function mn(n,e,t){let{routes:r={}}=e,{prefix:s=""}=e,{restoreScrollState:i=!1}=e;class o{constructor(E,j){if(!j||typeof j!="function"&&(typeof j!="object"||j._sveltesparouter!==!0))throw Error("Invalid component object");if(!E||typeof E=="string"&&(E.length<1||E.charAt(0)!="/"&&E.charAt(0)!="*")||typeof E=="object"&&!(E instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:D,keys:U}=cn(E);this.path=E,typeof j=="object"&&j._sveltesparouter===!0?(this.component=j.component,this.conditions=j.conditions||[],this.userData=j.userData,this.props=j.props||{}):(this.component=()=>Promise.resolve(j),this.conditions=[],this.props={}),this._pattern=D,this._keys=U}match(E){if(s){if(typeof s=="string")if(E.startsWith(s))E=E.substr(s.length)||"/";else return null;else if(s instanceof RegExp){const z=E.match(s);if(z&&z[0])E=E.substr(z[0].length)||"/";else return null}}const j=this._pattern.exec(E);if(j===null)return null;if(this._keys===!1)return j;const D={};let U=0;for(;U<this._keys.length;){try{D[this._keys[U]]=decodeURIComponent(j[U+1]||"")||null}catch{D[this._keys[U]]=null}U++}return D}async checkConditions(E){for(let j=0;j<this.conditions.length;j++)if(!await this.conditions[j](E))return!1;return!0}}const l=[];r instanceof Map?r.forEach((S,E)=>{l.push(new o(E,S))}):Object.keys(r).forEach(S=>{l.push(new o(S,r[S]))});let a=null,c=null,u={};const h=tn();async function _(S,E){await bs(),h(S,E)}let m=null,g=null;i&&(g=S=>{S.state&&(S.state.__svelte_spa_router_scrollY||S.state.__svelte_spa_router_scrollX)?m=S.state:m=null},window.addEventListener("popstate",g),Zs(()=>{pn(m)}));let b=null,v=null;const k=Wt.subscribe(async S=>{b=S;let E=0;for(;E<l.length;){const j=l[E].match(S.location);if(!j){E++;continue}const D={route:l[E].path,location:S.location,querystring:S.querystring,userData:l[E].userData,params:j&&typeof j=="object"&&Object.keys(j).length?j:null};if(!await l[E].checkConditions(D)){t(0,a=null),v=null,_("conditionsFailed",D);return}_("routeLoading",Object.assign({},D));const U=l[E].component;if(v!=U){U.loading?(t(0,a=U.loading),v=U,t(1,c=U.loadingParams),t(2,u={}),_("routeLoaded",Object.assign({},D,{component:a,name:a.name,params:c}))):(t(0,a=null),v=null);const z=await U();if(S!=b)return;t(0,a=z&&z.default||z),v=U}j&&typeof j=="object"&&Object.keys(j).length?t(1,c=j):t(1,c=null),t(2,u=l[E].props),_("routeLoaded",Object.assign({},D,{component:a,name:a.name,params:c})).then(()=>{br.set(c)});return}t(0,a=null),v=null,br.set(void 0)});en(()=>{k(),g&&window.removeEventListener("popstate",g)});function P(S){_r.call(this,n,S)}function T(S){_r.call(this,n,S)}return n.$$set=S=>{"routes"in S&&t(3,r=S.routes),"prefix"in S&&t(4,s=S.prefix),"restoreScrollState"in S&&t(5,i=S.restoreScrollState)},n.$$.update=()=>{n.$$.dirty&32&&(history.scrollRestoration=i?"manual":"auto")},[a,c,u,r,s,i,P,T]}class Yt extends V{constructor(e){super(),K(this,e,mn,dn,J,{routes:3,prefix:4,restoreScrollState:5})}}function vr(n){let e;return{c(){e=p("a"),e.textContent="Add book",d(e,"class","nav-link svelte-oup04o"),d(e,"href","./#/add-book")},m(t,r){C(t,e,r)},d(t){t&&O(e)}}}function gn(n){let e,t,r,s,i,o,l,a,c,u,h,_,m,g,b,v,k,P,T,S,E,j,D,U,z,q,M,oe,X,me,ie,ge,ue,H=n[0]=="staff"&&vr();return{c(){e=p("nav"),t=p("div"),r=p("a"),r.innerHTML=`<i class="bi bi-book"></i> 
      Library System
      <small class="fs-6 text-white-50 ms-2 d-sm-inline d-none">CTADVDBL Project</small>`,s=$(),i=p("button"),i.innerHTML='<span class="navbar-toggler-icon"></span>',o=$(),l=p("div"),a=p("div"),c=p("a"),c.textContent="Books",u=$(),h=p("a"),h.textContent="Authors",_=$(),m=p("a"),m.textContent="Publishers",g=$(),H&&H.c(),b=$(),v=p("li"),k=p("a"),k.innerHTML='<i class="bi bi-person-fill"></i> Salles',P=$(),T=p("ul"),S=p("li"),S.innerHTML='<a class="dropdown-item disabled svelte-oup04o" href="#">Profile</a>',E=$(),j=p("li"),j.innerHTML='<a class="dropdown-item disabled svelte-oup04o" href="#">Settings</a>',D=$(),U=p("li"),U.innerHTML='<hr class="dropdown-divider"/>',z=$(),q=p("li"),M=p("a"),M.textContent="Log Out",oe=$(),X=p("button"),me=p("span"),d(r,"class","navbar-brand m-0 svelte-oup04o"),d(r,"href","./#/"),d(i,"class","navbar-toggler"),d(i,"type","button"),d(i,"data-bs-toggle","collapse"),d(i,"data-bs-target","#navbarContent"),d(c,"class","nav-link svelte-oup04o"),d(c,"href","./#/search"),d(h,"class","nav-link svelte-oup04o"),d(h,"href","./#/search/author"),d(m,"class","nav-link svelte-oup04o"),d(m,"href","./#/search/publisher"),d(k,"class","nav-link dropdown-toggle svelte-oup04o"),d(k,"href","#"),d(k,"role","button"),d(k,"data-bs-toggle","dropdown"),d(k,"aria-expanded","false"),d(M,"class","dropdown-item text-danger"),d(M,"href","./#/"),d(T,"class","dropdown-menu"),d(v,"class","nav-item dropdown"),d(me,"class",ie="bi bi-"+n[1]+" svelte-oup04o"),d(X,"title","Switch theme"),d(X,"class","px-1 border-0 bg-transparent nav-link svelte-oup04o"),d(a,"class","navbar-nav ms-auto svelte-oup04o"),d(l,"class","collapse navbar-collapse"),d(l,"id","navbarContent"),d(t,"class","container px-4 fw-semibold"),d(e,"class","navbar navbar-expand-lg bg-primary bg-gradient shadow")},m(Q,be){C(Q,e,be),f(e,t),f(t,r),f(t,s),f(t,i),f(t,o),f(t,l),f(l,a),f(a,c),f(a,u),f(a,h),f(a,_),f(a,m),f(a,g),H&&H.m(a,null),f(a,b),f(a,v),f(v,k),f(v,P),f(v,T),f(T,S),f(T,E),f(T,j),f(T,D),f(T,U),f(T,z),f(T,q),f(q,M),f(a,oe),f(a,X),f(X,me),ge||(ue=[fe(M,"click",n[3]),fe(X,"click",n[2])],ge=!0)},p(Q,[be]){Q[0]=="staff"?H||(H=vr(),H.c(),H.m(a,b)):H&&(H.d(1),H=null),be&2&&ie!==(ie="bi bi-"+Q[1]+" svelte-oup04o")&&d(me,"class",ie)},i:A,o:A,d(Q){Q&&O(e),H&&H.d(),ge=!1,we(ue)}}}function bn(n,e,t){let r,s;We.subscribe(a=>t(0,s=a));let i=localStorage.getItem("theme")||"light";function o(){t(4,i=i=="light"?"dark":"light"),localStorage.setItem("theme",i)}function l(){We.set(""),localStorage.removeItem("accType")}return n.$$.update=()=>{n.$$.dirty&16&&document.querySelector("body").setAttribute("data-bs-theme",i),n.$$.dirty&16&&t(1,r=i=="dark"?"moon-stars-fill":"brightness-high-fill")},[s,r,o,l,i]}class ks extends V{constructor(e){super(),K(this,e,bn,gn,J,{})}}function vn(n){let e,t,r,s,i,o,l,a,c,u,h,_,m,g,b,v,k,P;return{c(){e=p("section"),t=p("div"),r=p("div"),s=p("div"),i=p("img"),l=$(),a=p("div"),c=p("img"),h=$(),_=p("div"),m=p("img"),b=$(),v=p("button"),v.innerHTML='<span class="carousel-control-prev-icon"></span>',k=$(),P=p("button"),P.innerHTML='<span class="carousel-control-next-icon"></span>',ce(i.src,o=It)||d(i,"src",o),d(i,"class","d-block w-100"),d(i,"alt","..."),d(s,"class","carousel-item active"),ce(c.src,u=It)||d(c,"src",u),d(c,"class","d-block w-100"),d(c,"alt","..."),d(a,"class","carousel-item"),ce(m.src,g=It)||d(m,"src",g),d(m,"class","d-block w-100"),d(m,"alt","..."),d(_,"class","carousel-item"),d(r,"class","carousel-inner"),d(v,"class","carousel-control-prev"),d(v,"type","button"),d(v,"data-bs-target","#homeAdCarousel"),d(v,"data-bs-slide","prev"),d(P,"class","carousel-control-next"),d(P,"type","button"),d(P,"data-bs-target","#homeAdCarousel"),d(P,"data-bs-slide","next"),d(t,"id","homeAdCarousel"),d(t,"class","carousel slide"),d(t,"data-bs-ride","carousel"),d(t,"data-bs-interval","8000")},m(T,S){C(T,e,S),f(e,t),f(t,r),f(r,s),f(s,i),f(r,l),f(r,a),f(a,c),f(r,h),f(r,_),f(_,m),f(t,b),f(t,v),f(t,k),f(t,P)},p:A,i:A,o:A,d(T){T&&O(e)}}}let It="./cover.jpg";class wn extends V{constructor(e){super(),K(this,e,null,vn,J,{})}}function yn(n){let e,t,r,s,i,o,l,a,c,u,h,_,m,g;return{c(){e=p("div"),t=p("img"),s=$(),i=p("div"),o=p("h5"),l=p("a"),a=G(n[1]),u=$(),h=p("small"),_=p("i"),m=$(),g=G(n[2]),ce(t.src,r="./"+n[0]+".jpg")||d(t,"src",r),d(t,"alt","book cover"),d(t,"class","svelte-1a99e4f"),d(l,"class","stretched-link svelte-1a99e4f"),d(l,"href",c="./#/book/"+n[0]),d(o,"class","card-title"),d(_,"class","bi bi-person"),d(h,"class","card-text"),d(i,"class","card-body"),d(e,"class","card col-md-3 col-6 svelte-1a99e4f")},m(b,v){C(b,e,v),f(e,t),f(e,s),f(e,i),f(i,o),f(o,l),f(l,a),f(i,u),f(i,h),f(h,_),f(h,m),f(h,g)},p(b,[v]){v&1&&!ce(t.src,r="./"+b[0]+".jpg")&&d(t,"src",r),v&2&&ee(a,b[1]),v&1&&c!==(c="./#/book/"+b[0])&&d(l,"href",c),v&4&&ee(g,b[2])},i:A,o:A,d(b){b&&O(e)}}}function kn(n,e,t){let{id:r=0}=e,{title:s}=e,{author:i}=e;return n.$$set=o=>{"id"in o&&t(0,r=o.id),"title"in o&&t(1,s=o.title),"author"in o&&t(2,i=o.author)},[r,s,i]}class Tt extends V{constructor(e){super(),K(this,e,kn,yn,J,{id:0,title:1,author:2})}}function wr(n){let e,t,r,s,i,o,l;return{c(){e=p("div"),t=p("a"),r=p("button"),s=G(n[3]),i=$(),o=p("i"),d(o,"class","bi bi-arrow-right"),d(r,"class","btn btn-outline-primary btn-sm"),d(t,"href",l="./#/"+n[2]),d(e,"class","align-middle align-self-center")},m(a,c){C(a,e,c),f(e,t),f(t,r),f(r,s),f(r,i),f(r,o)},p(a,c){c&8&&ee(s,a[3]),c&4&&l!==(l="./#/"+a[2])&&d(t,"href",l)},d(a){a&&O(e)}}}function $n(n){let e,t,r,s,i,o,l,a,c,u,h=n[2]!==""&&wr(n);const _=n[5].default,m=as(_,n,n[4],null);return{c(){e=p("section"),t=p("div"),r=p("h4"),s=p("i"),o=$(),l=G(n[0]),a=$(),h&&h.c(),c=$(),m&&m.c(),d(s,"class",i="bi bi-"+n[1]),d(r,"class","my-3"),d(t,"class","border-bottom border-2 d-flex justify-content-between mb-2")},m(g,b){C(g,e,b),f(e,t),f(t,r),f(r,s),f(r,o),f(r,l),f(t,a),h&&h.m(t,null),f(e,c),m&&m.m(e,null),u=!0},p(g,[b]){(!u||b&2&&i!==(i="bi bi-"+g[1]))&&d(s,"class",i),(!u||b&1)&&ee(l,g[0]),g[2]!==""?h?h.p(g,b):(h=wr(g),h.c(),h.m(t,null)):h&&(h.d(1),h=null),m&&m.p&&(!u||b&16)&&us(m,_,g,g[4],u?cs(_,g[4],b,null):hs(g[4]),null)},i(g){u||(w(m,g),u=!0)},o(g){y(m,g),u=!1},d(g){g&&O(e),h&&h.d(),m&&m.d(g)}}}function Sn(n,e,t){let{$$slots:r={},$$scope:s}=e,{title:i}=e,{icon:o}=e,{link:l=""}=e,{linkText:a="See All"}=e;return n.$$set=c=>{"title"in c&&t(0,i=c.title),"icon"in c&&t(1,o=c.icon),"link"in c&&t(2,l=c.link),"linkText"in c&&t(3,a=c.linkText),"$$scope"in c&&t(4,s=c.$$scope)},[i,o,l,a,s,r]}class Ie extends V{constructor(e){super(),K(this,e,Sn,$n,J,{title:0,icon:1,link:2,linkText:3})}}const En="modulepreload",Tn=function(n){return"/library-proj/"+n},yr={},Ye=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.all(t.map(l=>{if(l=Tn(l),l in yr)return;yr[l]=!0;const a=l.endsWith(".css"),c=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":En,a||(u.as="script",u.crossOrigin=""),u.href=l,o&&u.setAttribute("nonce",o),document.head.appendChild(u),a)return new Promise((h,_)=>{u.addEventListener("load",h),u.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${l}`)))})}))}return s.then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},jn=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ye(()=>Promise.resolve().then(()=>ht),void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class Xt extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class On extends Xt{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class An extends Xt{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Cn extends Xt{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Mt;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Mt||(Mt={}));var Pn=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function a(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(l,a)}c((r=r.apply(n,e||[])).next())})};class Rn{constructor(e,{headers:t={},customFetch:r,region:s=Mt.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=jn(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return Pn(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:o}=t;let l={},{region:a}=t;a||(a=this.region),a&&a!=="any"&&(l["x-region"]=a);let c;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",c=o):typeof o=="string"?(l["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(l["Content-Type"]="application/json",c=JSON.stringify(o)));const u=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),s),body:c}).catch(g=>{throw new On(g)}),h=u.headers.get("x-relay-error");if(h&&h==="true")throw new An(u);if(!u.ok)throw new Cn(u);let _=((r=u.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),m;return _==="application/json"?m=yield u.json():_==="application/octet-stream"?m=yield u.blob():_==="text/event-stream"?m=u:_==="multipart/form-data"?m=yield u.formData():m=yield u.text(),{data:m,error:null}}catch(s){return{data:null,error:s}}})}}var In=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Xe=In();const Ln=Xe.fetch,Qt=Xe.fetch.bind(Xe),$s=Xe.Headers,xn=Xe.Request,Dn=Xe.Response,ht=Object.freeze(Object.defineProperty({__proto__:null,Headers:$s,Request:xn,Response:Dn,default:Qt,fetch:Ln},Symbol.toStringTag,{value:"Module"}));class Un extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}class Nn{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Qt:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,l,a;let c=null,u=null,h=null,_=i.status,m=i.statusText;if(i.ok){if(this.method!=="HEAD"){const k=await i.text();k===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=k:u=JSON.parse(k))}const b=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),v=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");b&&v&&v.length>1&&(h=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,_=406,m="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const b=await i.text();try{c=JSON.parse(b),Array.isArray(c)&&i.status===404&&(u=[],c=null,_=200,m="OK")}catch{i.status===404&&b===""?(_=204,m="No Content"):c={message:b}}if(c&&this.isMaybeSingle&&(!((a=c==null?void 0:c.details)===null||a===void 0)&&a.includes("0 rows"))&&(c=null,_=200,m="OK"),c&&this.shouldThrowOnError)throw new Un(c)}return{error:c,data:u,count:h,status:_,statusText:m}});return this.shouldThrowOnError||(s=s.catch(i=>{var o,l,a;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(a=i==null?void 0:i.code)!==null&&a!==void 0?a:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}}class qn extends Nn{select(e){let t=!1;const r=(e??"*").split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:i=s}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){const i=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:i=!1,format:o="text"}={}){var l;const a=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${c}"; options=${a};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class He extends qn{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}}class Bn{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=t,this.schema=r,this.fetch=s}select(e,{head:t=!1,count:r}={}){const s=t?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new He({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const o=e.reduce((l,a)=>l.concat(Object.keys(a)),[]);if(o.length>0){const l=[...new Set(o)].map(a=>`"${a}"`);this.url.searchParams.set("columns",l.join(","))}}return new He({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:i=!0}={}){const o="POST",l=[`resolution=${r?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&l.push(this.headers.Prefer),s&&l.push(`count=${s}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const a=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(a.length>0){const c=[...new Set(a)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new He({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const r="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new He({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new He({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const Mn="1.15.2",Fn={"X-Client-Info":`postgrest-js/${Mn}`};class Zt{constructor(e,{headers:t={},schema:r,fetch:s}={}){this.url=e,this.headers=Object.assign(Object.assign({},Fn),t),this.schemaName=r,this.fetch=s}from(e){const t=new URL(`${this.url}/${e}`);return new Bn(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Zt(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:s=!1,count:i}={}){let o;const l=new URL(`${this.url}/rpc/${e}`);let a;r||s?(o=r?"HEAD":"GET",Object.entries(t).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{l.searchParams.append(u,h)})):(o="POST",a=t);const c=Object.assign({},this.headers);return i&&(c.Prefer=`count=${i}`),new He({method:o,url:l,headers:c,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}}const zn="2.9.5",Hn={"X-Client-Info":`realtime-js/${zn}`},Jn="1.0.0",Ss=1e4,Gn=1e3;var Ke;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Ke||(Ke={}));var ae;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(ae||(ae={}));var de;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(de||(de={}));var Ft;(function(n){n.websocket="websocket"})(Ft||(Ft={}));var Pe;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Pe||(Pe={}));class Es{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class Kn{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const s=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(e.slice(o,o+s));o=o+s;const a=r.decode(e.slice(o,o+i));o=o+i;const c=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:a,payload:c}}}class Lt{constructor(e,t,r={},s=Ss){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var kr;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(kr||(kr={}));class it{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=it.syncState(this.state,s,i,o),this.pendingDiffs.forEach(a=>{this.state=it.syncDiff(this.state,a,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=it.syncDiff(this.state,s,i,o),l())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const i=this.cloneDeep(e),o=this.transformState(t),l={},a={};return this.map(i,(c,u)=>{o[c]||(a[c]=u)}),this.map(o,(c,u)=>{const h=i[c];if(h){const _=u.map(v=>v.presence_ref),m=h.map(v=>v.presence_ref),g=u.filter(v=>m.indexOf(v.presence_ref)<0),b=h.filter(v=>_.indexOf(v.presence_ref)<0);g.length>0&&(l[c]=g),b.length>0&&(a[c]=b)}else l[c]=u}),this.syncDiff(i,{joins:l,leaves:a},r,s)}static syncDiff(e,t,r,s){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(l,a)=>{var c;const u=(c=e[l])!==null&&c!==void 0?c:[];if(e[l]=this.cloneDeep(a),u.length>0){const h=e[l].map(m=>m.presence_ref),_=u.filter(m=>h.indexOf(m.presence_ref)<0);e[l].unshift(..._)}r(l,u,a)}),this.map(o,(l,a)=>{let c=e[l];if(!c)return;const u=a.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[l]=c,s(l,c,a),c.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var F;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(F||(F={}));const $r=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,o)=>(i[o]=Vn(o,n,e,s),i),{})},Vn=(n,e,t,r)=>{const s=e.find(l=>l.name===n),i=s==null?void 0:s.type,o=t[n];return i&&!r.includes(i)?Ts(i,o):zt(o)},Ts=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return Qn(e,t)}switch(n){case F.bool:return Wn(e);case F.float4:case F.float8:case F.int2:case F.int4:case F.int8:case F.numeric:case F.oid:return Yn(e);case F.json:case F.jsonb:return Xn(e);case F.timestamp:return Zn(e);case F.abstime:case F.date:case F.daterange:case F.int4range:case F.int8range:case F.money:case F.reltime:case F.text:case F.time:case F.timestamptz:case F.timetz:case F.tsrange:case F.tstzrange:return zt(e);default:return zt(e)}},zt=n=>n,Wn=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},Yn=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},Xn=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},Qn=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let i;const o=n.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>Ts(e,l))}return n},Zn=n=>typeof n=="string"?n.replace(" ","T"):n;var Sr;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Sr||(Sr={}));var Er;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes"})(Er||(Er={}));var Tr;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(Tr||(Tr={}));class er{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=ae.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},t.config),this.timeout=this.socket.timeout,this.joinPush=new Lt(this,de.join,this.params,this.timeout),this.rejoinTimer=new Es(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ae.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ae.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=ae.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ae.errored,this.rejoinTimer.scheduleTimeout())}),this._on(de.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new it(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(e,t=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:o}}=this.params;this._onError(c=>e&&e("CHANNEL_ERROR",c)),this._onClose(()=>e&&e("CLOSED"));const l={},a={broadcast:i,presence:o,postgres_changes:(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(c=>c.filter))!==null&&s!==void 0?s:[]};this.socket.accessToken&&(l.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:a},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",({postgres_changes:c})=>{var u;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),c===void 0){e&&e("SUBSCRIBED");return}else{const h=this.bindings.postgres_changes,_=(u=h==null?void 0:h.length)!==null&&u!==void 0?u:0,m=[];for(let g=0;g<_;g++){const b=h[g],{filter:{event:v,schema:k,table:P,filter:T}}=b,S=c&&c[g];if(S&&S.event===v&&S.schema===k&&S.table===P&&S.filter===T)m.push(Object.assign(Object.assign({},b),{id:S.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,e&&e("SUBSCRIBED");return}}).receive("error",c=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,l={method:"POST",headers:{apikey:(r=this.socket.apiKey)!==null&&r!==void 0?r:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o}]})};try{return(await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=t.timeout)!==null&&s!==void 0?s:this.timeout)).ok?"ok":"error"}catch(a){return a.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,a;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((a=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||a===void 0)&&a.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ae.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(de.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const s=new Lt(this,de.leave,{},e);s.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}_broadcastEndpointURL(){let e=this.socket.endPoint;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(e,t,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),o}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Lt(this,e,t,r);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,i;const o=e.toLocaleLowerCase(),{close:l,error:a,leave:c,join:u}=de;if(r&&[l,a,c,u].indexOf(o)>=0&&r!==this._joinRef())return;let _=this._onMessage(o,t,r);if(t&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(m=>{var g,b,v;return((g=m.filter)===null||g===void 0?void 0:g.event)==="*"||((v=(b=m.filter)===null||b===void 0?void 0:b.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===o}).map(m=>m.callback(_,r)):(i=this.bindings[o])===null||i===void 0||i.filter(m=>{var g,b,v,k,P,T;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in m){const S=m.id,E=(g=m.filter)===null||g===void 0?void 0:g.event;return S&&((b=t.ids)===null||b===void 0?void 0:b.includes(S))&&(E==="*"||(E==null?void 0:E.toLocaleLowerCase())===((v=t.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const S=(P=(k=m==null?void 0:m.filter)===null||k===void 0?void 0:k.event)===null||P===void 0?void 0:P.toLocaleLowerCase();return S==="*"||S===((T=t==null?void 0:t.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===o}).map(m=>{if(typeof _=="object"&&"ids"in _){const g=_.data,{schema:b,table:v,commit_timestamp:k,type:P,errors:T}=g;_=Object.assign(Object.assign({},{schema:b,table:v,commit_timestamp:k,eventType:P,new:{},old:{},errors:T}),this._getPayloadRecords(g))}m.callback(_,r)})}_isClosed(){return this.state===ae.closed}_isJoined(){return this.state===ae.joined}_isJoining(){return this.state===ae.joining}_isLeaving(){return this.state===ae.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&er.isEqual(s.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(de.close,{},e)}_onError(e){this._on(de.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ae.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=$r(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=$r(e.columns,e.old_record)),t}}const ei=()=>{},ti=typeof WebSocket<"u";class ri{constructor(e,t){var r;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.headers=Hn,this.params={},this.timeout=Ss,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=ei,this.conn=null,this.sendBuffer=[],this.serializer=new Kn,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...l)=>Ye(()=>Promise.resolve().then(()=>ht),void 0).then(({default:a})=>a(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${e}/${Ft.websocket}`,t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const s=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;s&&(this.accessToken=s,this.apiKey=s),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,o)=>o(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Es(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(ti){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new si(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),Ye(()=>import("./browser-BImCA5dO.js").then(e=>e.b),[]).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Ke.connecting:return Pe.Connecting;case Ke.open:return Pe.Open;case Ke.closing:return Pe.Closing;default:return Pe.Closed}}isConnected(){return this.connectionState()===Pe.Open}channel(e,t={config:{}}){const r=new er(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){const{topic:t,event:r,payload:s,ref:i}=e,o=()=>{this.encode(e,l=>{var a;(a=this.conn)===null||a===void 0||a.send(l)})};this.log("push",`${t} ${r} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(e){this.accessToken=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(de.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Jn}))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:s,payload:i,ref:o}=t;(o&&o===this.pendingHeartbeatRef||s===(i==null?void 0:i.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${s} ${o&&"("+o+")"||""}`,i),this.channels.filter(l=>l._isMember(r)).forEach(l=>l._trigger(s,i,o)),this.stateChangeCallbacks.message.forEach(l=>l(t))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(de.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(Gn,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class si{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Ke.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class tr extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ne(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class ni extends tr{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class jr extends tr{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var ii=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function a(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(l,a)}c((r=r.apply(n,e||[])).next())})};const js=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ye(()=>Promise.resolve().then(()=>ht),void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},oi=()=>ii(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ye(()=>Promise.resolve().then(()=>ht),void 0)).Response:Response});var Ze=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function a(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(l,a)}c((r=r.apply(n,e||[])).next())})};const xt=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),ai=(n,e)=>Ze(void 0,void 0,void 0,function*(){const t=yield oi();n instanceof t?n.json().then(r=>{e(new ni(xt(r),n.status||500))}).catch(r=>{e(new jr(xt(r),r))}):e(new jr(xt(n),n))}),li=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};function jt(n,e,t,r,s,i){return Ze(this,void 0,void 0,function*(){return new Promise((o,l)=>{n(t,li(e,r,s,i)).then(a=>{if(!a.ok)throw a;return r!=null&&r.noResolveJson?a:a.json()}).then(a=>o(a)).catch(a=>ai(a,l))})})}function Ht(n,e,t,r){return Ze(this,void 0,void 0,function*(){return jt(n,"GET",e,t,r)})}function Se(n,e,t,r,s){return Ze(this,void 0,void 0,function*(){return jt(n,"POST",e,r,s,t)})}function ci(n,e,t,r,s){return Ze(this,void 0,void 0,function*(){return jt(n,"PUT",e,r,s,t)})}function Os(n,e,t,r,s){return Ze(this,void 0,void 0,function*(){return jt(n,"DELETE",e,r,s,t)})}var le=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function a(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(l,a)}c((r=r.apply(n,e||[])).next())})};const ui={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Or={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class hi{constructor(e,t={},r,s){this.url=e,this.headers=t,this.bucketId=r,this.fetch=js(s)}uploadOrUpdate(e,t,r,s){return le(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Or),s),l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl)):(i=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType);const a=this._removeEmptyFolders(t),c=this._getFinalPath(a),u=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:i,headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{})),h=yield u.json();return u.ok?{data:{path:a,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(i){if(ne(i))return{data:null,error:i};throw i}})}upload(e,t,r){return le(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return le(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let a;const c=Object.assign({upsert:Or.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",c.cacheControl),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.append("cacheControl",c.cacheControl)):(a=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield this.fetch(l.toString(),{method:"PUT",body:a,headers:u}),_=yield h.json();return h.ok?{data:{path:i,fullPath:_.Key},error:null}:{data:null,error:_}}catch(a){if(ne(a))return{data:null,error:a};throw a}})}createSignedUploadUrl(e){return le(this,void 0,void 0,function*(){try{let t=this._getFinalPath(e);const r=yield Se(this.fetch,`${this.url}/object/upload/sign/${t}`,{},{headers:this.headers}),s=new URL(this.url+r.url),i=s.searchParams.get("token");if(!i)throw new tr("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:i},error:null}}catch(t){if(ne(t))return{data:null,error:t};throw t}})}update(e,t,r){return le(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t){return le(this,void 0,void 0,function*(){try{return{data:yield Se(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers}),error:null}}catch(r){if(ne(r))return{data:null,error:r};throw r}})}copy(e,t){return le(this,void 0,void 0,function*(){try{return{data:{path:(yield Se(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers})).Key},error:null}}catch(r){if(ne(r))return{data:null,error:r};throw r}})}createSignedUrl(e,t,r){return le(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield Se(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(ne(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return le(this,void 0,void 0,function*(){try{const s=yield Se(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(ne(s))return{data:null,error:s};throw s}})}download(e,t){return le(this,void 0,void 0,function*(){const s=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield Ht(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(ne(l))return{data:null,error:l};throw l}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&s.push(i);const l=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});a!==""&&s.push(a);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${c}`)}}}remove(e){return le(this,void 0,void 0,function*(){try{return{data:yield Os(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(ne(t))return{data:null,error:t};throw t}})}list(e,t,r){return le(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},ui),t),{prefix:e||""});return{data:yield Se(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(ne(s))return{data:null,error:s};throw s}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const di="2.5.5",fi={"X-Client-Info":`storage-js/${di}`};var Be=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function a(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(l,a)}c((r=r.apply(n,e||[])).next())})};class _i{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},fi),t),this.fetch=js(r)}listBuckets(){return Be(this,void 0,void 0,function*(){try{return{data:yield Ht(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(ne(e))return{data:null,error:e};throw e}})}getBucket(e){return Be(this,void 0,void 0,function*(){try{return{data:yield Ht(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(ne(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Be(this,void 0,void 0,function*(){try{return{data:yield Se(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(ne(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return Be(this,void 0,void 0,function*(){try{return{data:yield ci(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(ne(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Be(this,void 0,void 0,function*(){try{return{data:yield Se(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(ne(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Be(this,void 0,void 0,function*(){try{return{data:yield Os(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(ne(t))return{data:null,error:t};throw t}})}}class pi extends _i{constructor(e,t={},r){super(e,t,r)}from(e){return new hi(this.url,this.headers,e,this.fetch)}}const mi="2.43.2";let st="";typeof Deno<"u"?st="deno":typeof document<"u"?st="web":typeof navigator<"u"&&navigator.product==="ReactNative"?st="react-native":st="node";const gi={"X-Client-Info":`supabase-js-${st}/${mi}`},bi={headers:gi},vi={schema:"public"},wi={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},yi={};var ki=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function a(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(l,a)}c((r=r.apply(n,e||[])).next())})};const $i=n=>{let e;return n?e=n:typeof fetch>"u"?e=Qt:e=fetch,(...t)=>e(...t)},Si=()=>typeof Headers>"u"?$s:Headers,Ei=(n,e,t)=>{const r=$i(t),s=Si();return(i,o)=>ki(void 0,void 0,void 0,function*(){var l;const a=(l=yield e())!==null&&l!==void 0?l:n;let c=new s(o==null?void 0:o.headers);return c.has("apikey")||c.set("apikey",n),c.has("Authorization")||c.set("Authorization",`Bearer ${a}`),r(i,Object.assign(Object.assign({},o),{headers:c}))})};function Ti(n){return n.replace(/\/$/,"")}function ji(n,e){const{db:t,auth:r,realtime:s,global:i}=n,{db:o,auth:l,realtime:a,global:c}=e;return{db:Object.assign(Object.assign({},o),t),auth:Object.assign(Object.assign({},l),r),realtime:Object.assign(Object.assign({},a),s),global:Object.assign(Object.assign({},c),i)}}const As="2.64.2",Oi="http://localhost:9999",Ai="supabase.auth.token",Ci={"X-Client-Info":`gotrue-js/${As}`},Ar=10,Jt="X-Supabase-Api-Version",Cs={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function Pi(n){return Math.round(Date.now()/1e3)+n}function Ri(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const he=()=>typeof document<"u",Oe={tested:!1,writable:!1},ot=()=>{if(!he())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Oe.tested)return Oe.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Oe.tested=!0,Oe.writable=!0}catch{Oe.tested=!0,Oe.writable=!1}return Oe.writable};function Dt(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}const Ps=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ye(()=>Promise.resolve().then(()=>ht),void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Ii=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Rs=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},ft=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Ut=async(n,e)=>{await n.removeItem(e)};function Li(n){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",r,s,i,o,l,a,c,u=0;for(n=n.replace("-","+").replace("_","/");u<n.length;)o=e.indexOf(n.charAt(u++)),l=e.indexOf(n.charAt(u++)),a=e.indexOf(n.charAt(u++)),c=e.indexOf(n.charAt(u++)),r=o<<2|l>>4,s=(l&15)<<4|a>>2,i=(a&3)<<6|c,t=t+String.fromCharCode(r),a!=64&&s!=0&&(t=t+String.fromCharCode(s)),c!=64&&i!=0&&(t=t+String.fromCharCode(i));return t}class Ot{constructor(){this.promise=new Ot.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Ot.promiseConstructor=Promise;function Cr(n){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=n.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=t[1];return JSON.parse(Li(r))}async function xi(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function Di(n,e){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await n(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){s(o);return}}})()})}function Ui(n){return("0"+n.toString(16)).substr(-2)}function Ni(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let i=0;i<56;i++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,Ui).join("")}async function qi(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}function Bi(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Mi(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await qi(n);return Bi(t)}async function Me(n,e,t=!1){const r=Ni();let s=r;t&&(s+="/PASSWORD_RECOVERY"),await Rs(n,`${e}-code-verifier`,s);const i=await Mi(r);return[i,r===i?"plain":"s256"]}const Fi=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function zi(n){const e=n.headers.get(Jt);if(!e||!e.match(Fi))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class rr extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function x(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class Hi extends rr{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function Ji(n){return x(n)&&n.name==="AuthApiError"}class Is extends rr{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class xe extends rr{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class Ae extends xe{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Nt extends xe{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class _t extends xe{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class pt extends xe{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Pr extends xe{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Gt extends xe{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function qt(n){return x(n)&&n.name==="AuthRetryableFetchError"}class Rr extends xe{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}var Gi=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};const Ce=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Ki=[502,503,504];async function Ir(n){var e;if(!Ii(n))throw new Gt(Ce(n),0);if(Ki.includes(n.status))throw new Gt(Ce(n),n.status);let t;try{t=await n.json()}catch(i){throw new Is(Ce(i),i)}let r;const s=zi(n);if(s&&s.getTime()>=Cs["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new Rr(Ce(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[])}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Rr(Ce(t),n.status,t.weak_password.reasons);throw new Hi(Ce(t),n.status||500,r)}const Vi=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function N(n,e,t,r){var s;const i=Object.assign({},r==null?void 0:r.headers);i[Jt]||(i[Jt]=Cs["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",a=await Wi(n,e,t+l,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(a):{data:Object.assign({},a),error:null}}async function Wi(n,e,t,r,s,i){const o=Vi(e,r,s,i);let l;try{l=await n(t,Object.assign({},o))}catch(a){throw console.error(a),new Gt(Ce(a),0)}if(l.ok||await Ir(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(a){await Ir(a)}}function ke(n){var e;let t=null;Zi(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=Pi(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function Lr(n){const e=ke(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Te(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function Yi(n){return{data:n,error:null}}function Xi(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i}=n,o=Gi(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i},a=Object.assign({},o);return{data:{properties:l,user:a},error:null}}function Qi(n){return n}function Zi(n){return n.access_token&&n.refresh_token&&n.expires_in}var eo=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};class to{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=Ps(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await N(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(x(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await N(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Te})}catch(r){if(x(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=eo(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await N(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:Xi,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(x(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await N(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Te})}catch(t){if(x(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,i,o,l,a;try{const c={nextPage:null,lastPage:0,total:0},u=await N(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Qi});if(u.error)throw u.error;const h=await u.json(),_=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,m=(a=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&a!==void 0?a:[];return m.length>0&&(m.forEach(g=>{const b=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(g.split(";")[1].split("=")[1]);c[`${v}Page`]=b}),c.total=parseInt(_)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(x(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await N(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Te})}catch(t){if(x(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await N(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Te})}catch(r){if(x(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){try{return await N(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Te})}catch(r){if(x(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await N(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(x(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await N(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(x(t))return{data:null,error:t};throw t}}}const ro={getItem:n=>ot()?globalThis.localStorage.getItem(n):null,setItem:(n,e)=>{ot()&&globalThis.localStorage.setItem(n,e)},removeItem:n=>{ot()&&globalThis.localStorage.removeItem(n)}};function xr(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function so(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Fe={debug:!!(globalThis&&ot()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ls extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class no extends Ls{}async function io(n,e,t){Fe.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Fe.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){Fe.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{Fe.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw Fe.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new no(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Fe.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}})}so();const oo={url:Oi,storageKey:Ai,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ci,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},rt=30*1e3,Dr=3;async function Ur(n,e,t){return await t()}class ut{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ut.nextInstanceID,ut.nextInstanceID+=1,this.instanceID>0&&he()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},oo),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new to({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Ps(s.fetch),this.lock=s.lock||Ur,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:he()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=io:this.lock=Ur,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:ot()?this.storage=ro:(this.memoryStorage={},this.storage=xr(this.memoryStorage)):(this.memoryStorage={},this.storage=xr(this.memoryStorage)),he()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${As}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=he()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:t,error:r}=await this._getSessionFromURL(e);if(r)return this._debug("#_initialize()","error detecting session from URL",r),(r==null?void 0:r.message)==="Identity is already linked"||(r==null?void 0:r.message)==="Identity is already linked to another user"?{error:r}:(await this._removeSession(),{error:r});const{session:s,redirectType:i}=t;return this._debug("#_initialize()","detected session in URL",s,"redirect type",i),await this._saveSession(s),setTimeout(async()=>{i==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return x(e)?{error:e}:{error:new Is("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{await this._removeSession();const i=await N(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:ke}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:c,session:a},error:null}}catch(i){if(x(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,r,s;try{await this._removeSession();let i;if("email"in e){const{email:u,password:h,options:_}=e;let m=null,g=null;this.flowType==="pkce"&&([m,g]=await Me(this.storage,this.storageKey)),i=await N(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:_==null?void 0:_.emailRedirectTo,body:{email:u,password:h,data:(t=_==null?void 0:_.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken},code_challenge:m,code_challenge_method:g},xform:ke})}else if("phone"in e){const{phone:u,password:h,options:_}=e;i=await N(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(r=_==null?void 0:_.data)!==null&&r!==void 0?r:{},channel:(s=_==null?void 0:_.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken}},xform:ke})}else throw new _t("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:c,session:a},error:null}}catch(i){if(x(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{await this._removeSession();let t;if("email"in e){const{email:i,password:o,options:l}=e;t=await N(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Lr})}else if("phone"in e){const{phone:i,password:o,options:l}=e;t=await N(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Lr})}else throw new _t("You must provide either an email or phone number and a password");const{data:r,error:s}=t;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Nt}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(x(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,s,i;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await ft(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(t??"").split("/"),{data:i,error:o}=await N(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:ke});return await Ut(this.storage,`${this.storageKey}-code-verifier`),o?{data:{user:null,session:null,redirectType:null},error:o}:!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Nt}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}async signInWithIdToken(e){await this._removeSession();try{const{options:t,provider:r,token:s,access_token:i,nonce:o}=e,l=await N(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:ke}),{data:a,error:c}=l;return c?{data:{user:null,session:null},error:c}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new Nt}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:c})}catch(t){if(x(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,s,i,o;try{if(await this._removeSession(),"email"in e){const{email:l,options:a}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Me(this.storage,this.storageKey));const{error:h}=await N(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=a==null?void 0:a.data)!==null&&t!==void 0?t:{},create_user:(r=a==null?void 0:a.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:a}=e,{data:c,error:u}=await N(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=a==null?void 0:a.data)!==null&&s!==void 0?s:{},create_user:(i=a==null?void 0:a.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},channel:(o=a==null?void 0:a.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new _t("You must provide either an email or phone number.")}catch(l){if(x(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var t,r;try{e.type!=="email_change"&&e.type!=="phone_change"&&await this._removeSession();let s,i;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await N(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:ke});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const a=o.session,c=o.user;return a!=null&&a.access_token&&(await this._saveSession(a),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:c,session:a},error:null}}catch(s){if(x(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,r,s;try{await this._removeSession();let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await Me(this.storage,this.storageKey)),await N(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Yi})}catch(i){if(x(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new Ae;const{error:s}=await N(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(x(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{e.type!="email_change"&&e.type!="phone_change"&&await this._removeSession();const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:i}=e,{error:o}=await N(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:s,options:i}=e,{data:o,error:l}=await N(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new _t("You must provide either an email or phone number and a type")}catch(t){if(x(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await ft(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){const o=this.suppressGetSessionWarning;e=new Proxy(e,{get(a,c,u){return!o&&c==="user"&&console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),Reflect.get(a,c,u)}})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await N(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Te}):await this._useSession(async t=>{var r,s,i;const{data:o,error:l}=t;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ae}:await N(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Te})})}catch(t){if(x(t))return{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new Ae;const o=s.session;let l=null,a=null;this.flowType==="pkce"&&e.email!=null&&([l,a]=await Me(this.storage,this.storageKey));const{data:c,error:u}=await N(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:a}),jwt:o.access_token,xform:Te});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(x(r))return{data:{user:null},error:r};throw r}}_decodeJWT(e){return Cr(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ae;const t=Date.now()/1e3;let r=t,s=!0,i=null;const o=Cr(e.access_token);if(o.exp&&(r=o.exp,s=r<=t),s){const{session:l,error:a}=await this._callRefreshToken(e.refresh_token);if(a)return{data:{user:null,session:null},error:a};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:a}=await this._getUser(e.access_token);if(a)throw a;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(x(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Ae;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(x(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e){try{if(!he())throw new pt("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new pt("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new Pr("Not a valid PKCE flow url.");const t=Dt(window.location.href);if(e){if(!t.code)throw new Pr("No code detected.");const{data:P,error:T}=await this._exchangeCodeForSession(t.code);if(T)throw T;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:P.session,redirectType:null},error:null}}if(t.error||t.error_description||t.error_code)throw new pt(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:l,expires_at:a,token_type:c}=t;if(!i||!l||!o||!c)throw new pt("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let _=u+h;a&&(_=parseInt(a));const m=_-u;m*1e3<=rt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${h}s`);const g=_-h;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,_,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",g,_,u);const{data:b,error:v}=await this._getUser(i);if(v)throw v;const k={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:_,refresh_token:o,token_type:c,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:k,redirectType:t.type},error:null}}catch(t){if(x(t))return{data:{session:null,redirectType:null},error:t};throw t}}_isImplicitGrantFlow(){const e=Dt(window.location.href);return!!(he()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=Dt(window.location.href),t=await ft(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{error:i};const o=(r=s.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(Ji(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Ut(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const t=Ri(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:i},error:o}=t;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await Me(this.storage,this.storageKey,!0));try{return await N(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(x(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(x(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:s}=await this._useSession(async i=>{var o,l,a,c,u;const{data:h,error:_}=i;if(_)throw _;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:!0});return await N(this.fetch,"GET",m,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return he()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(x(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:o}=t;if(o)throw o;return await N(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(x(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await Di(async s=>(s>0&&await xi(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await N(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ke})),(s,i)=>{const o=200*Math.pow(2,s);return i&&qt(i)&&Date.now()+o-r<rt})}catch(r){if(this._debug(t,"error",r),x(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),he()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await ft(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),r!==null&&await this._removeSession();return}const s=Math.round(Date.now()/1e3),i=((e=r.expires_at)!==null&&e!==void 0?e:1/0)<s+Ar;if(this._debug(t,`session has${i?"":" not"} expired with margin of ${Ar}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:o}=await this._callRefreshToken(r.refresh_token);o&&(console.error(o),qt(o)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(t,"error",r),console.error(r);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new Ae;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Ot;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Ae;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(s,"error",i),x(i)){const o={session:null,error:i};return qt(i)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(a){i.push(a)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Rs(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Ut(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&he()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),rt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/rt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${rt}ms, refresh threshold is ${Dr} ticks`),s<=Dr&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Ls)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!he()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await Me(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await N(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(x(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:o}=t;if(o)return{data:null,error:o};const{data:l,error:a}=await N(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return a?{data:null,error:a}:(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(x(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{data:null,error:i};const{data:o,error:l}=await N(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(t){if(x(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await N(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(x(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],s=r.filter(i=>i.factor_type==="totp"&&i.status==="verified");return{data:{all:r,totp:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const o=this._decodeJWT(s.access_token);let l=null;o.aal&&(l=o.aal);let a=l;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(a="aal2");const u=o.amr||[];return{data:{currentLevel:l,nextLevel:a,currentAuthenticationMethods:u},error:null}}))}}ut.nextInstanceID=0;const ao=ut;class lo extends ao{constructor(e){super(e)}}var co=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function a(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(l,a)}c((r=r.apply(n,e||[])).next())})};class uo{constructor(e,t,r){var s,i,o,l,a,c,u,h;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const _=Ti(e);this.realtimeUrl=`${_}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${_}/auth/v1`,this.storageUrl=`${_}/storage/v1`,this.functionsUrl=`${_}/functions/v1`;const m=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,g={db:vi,realtime:yi,auth:Object.assign(Object.assign({},wi),{storageKey:m}),global:bi},b=ji(r??{},g);this.storageKey=(i=(s=b.auth)===null||s===void 0?void 0:s.storageKey)!==null&&i!==void 0?i:"",this.headers=(l=(o=b.global)===null||o===void 0?void 0:o.headers)!==null&&l!==void 0?l:{},this.auth=this._initSupabaseAuthClient((a=b.auth)!==null&&a!==void 0?a:{},this.headers,(c=b.global)===null||c===void 0?void 0:c.fetch),this.fetch=Ei(t,this._getAccessToken.bind(this),(u=b.global)===null||u===void 0?void 0:u.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},b.realtime)),this.rest=new Zt(`${_}/rest/v1`,{headers:this.headers,schema:(h=b.db)===null||h===void 0?void 0:h.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new Rn(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new pi(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return co(this,void 0,void 0,function*(){const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,storageKey:i,flowType:o,debug:l},a,c){var u;const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new lo({url:this.authUrl,headers:Object.assign(Object.assign({},h),a),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,flowType:o,debug:l,fetch:c,hasCustomAuthorizationHeader:(u="Authorization"in this.headers)!==null&&u!==void 0?u:!1})}_initRealtimeClient(e){return new ri(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.realtime.setAuth(r??null),this.changedAccessToken=r):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const ho=(n,e,t)=>new uo(n,e,t),ve=ho("https://oatzrwezibkcabfwxppo.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9hdHpyd2V6aWJrY2FiZnd4cHBvIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTcxMzYwOTE3MSwiZXhwIjoyMDI5MTg1MTcxfQ.u2HUJZ-hGi8Jk97FWI-hiQ3NpyMMM7V6hHQaL_Gvx1s");function De(n,{delay:e=0,duration:t=400,easing:r=ns}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:r,css:i=>`opacity: ${i*s}`}}function fo(n){let e;return{c(){e=p("div"),e.innerHTML='<div class="spinner-grow text-primary m-5" role="status"></div>',d(e,"class","d-flex justify-content-center")},m(t,r){C(t,e,r)},p:A,i:A,o:A,d(t){t&&O(e)}}}class je extends V{constructor(e){super(),K(this,e,null,fo,J,{})}}function _o(n){let e,t,r,s,i,o,l,a,c;return{c(){e=p("div"),t=p("img"),s=$(),i=p("div"),o=p("h6"),l=p("a"),a=G(n[0]),d(t,"class","object-fit-contain rounded my-2"),d(t,"height","150"),ce(t.src,r="./default-profile.jpg")||d(t,"src",r),d(t,"alt","author"),d(l,"class","stretched-link svelte-1rzxrzv"),d(l,"href",c="./#/author/"+n[1]),d(o,"class","card-title text-center"),d(i,"class","card-body p-1"),d(e,"class","card col-md-2 col-4 border-1 svelte-1rzxrzv")},m(u,h){C(u,e,h),f(e,t),f(e,s),f(e,i),f(i,o),f(o,l),f(l,a)},p(u,[h]){h&1&&ee(a,u[0]),h&2&&c!==(c="./#/author/"+u[1])&&d(l,"href",c)},i:A,o:A,d(u){u&&O(e)}}}function po(n,e,t){let{name:r}=e,{id:s}=e;return n.$$set=i=>{"name"in i&&t(0,r=i.name),"id"in i&&t(1,s=i.id)},[r,s]}class xs extends V{constructor(e){super(),K(this,e,po,_o,J,{name:0,id:1})}}function mo(n){let e,t,r,s,i,o,l,a,c;return{c(){e=p("div"),t=p("img"),s=$(),i=p("div"),o=p("h6"),l=p("a"),a=G(n[0]),d(t,"class","object-fit-contain rounded my-2"),d(t,"height","150"),ce(t.src,r="./default-profile.jpg")||d(t,"src",r),d(t,"alt","publisher"),d(l,"class","stretched-link svelte-1rzxrzv"),d(l,"href",c="./#/publisher/"+n[1]),d(o,"class","card-title text-center"),d(i,"class","card-body p-1"),d(e,"class","card col-md-2 col-4 border-1 svelte-1rzxrzv")},m(u,h){C(u,e,h),f(e,t),f(e,s),f(e,i),f(i,o),f(o,l),f(l,a)},p(u,[h]){h&1&&ee(a,u[0]),h&2&&c!==(c="./#/publisher/"+u[1])&&d(l,"href",c)},i:A,o:A,d(u){u&&O(e)}}}function go(n,e,t){let{name:r}=e,{id:s}=e;return n.$$set=i=>{"name"in i&&t(0,r=i.name),"id"in i&&t(1,s=i.id)},[r,s]}class Ds extends V{constructor(e){super(),K(this,e,go,mo,J,{name:0,id:1})}}function bo(n){let e,t,r,s,i,o,l,a,c,u;return{c(){e=p("div"),t=p("div"),r=p("h2"),r.textContent="Error",s=$(),i=p("p"),o=G(n[0]),l=G(": "),a=G(n[1]),c=$(),u=p("a"),u.textContent="Reload",d(u,"href","/#/"),d(u,"class","fw-bold"),d(t,"class","text-center"),d(e,"class","d-flex align-items-center justify-content-center my-3")},m(h,_){C(h,e,_),f(e,t),f(t,r),f(t,s),f(t,i),f(i,o),f(i,l),f(i,a),f(t,c),f(t,u)},p(h,[_]){_&1&&ee(o,h[0]),_&2&&ee(a,h[1])},i:A,o:A,d(h){h&&O(e)}}}function vo(n,e,t){let{code:r="err"}=e,{message:s}=e;return n.$$set=i=>{"code"in i&&t(0,r=i.code),"message"in i&&t(1,s=i.message)},[r,s]}let sr=class extends V{constructor(e){super(),K(this,e,vo,bo,J,{code:0,message:1})}};function Nr(n,e,t){const r=n.slice();return r[9]=e[t][0],r[10]=e[t][1],r}function qr(n,e,t){const r=n.slice();return r[9]=e[t][0],r[13]=e[t][1],r}function Br(n,e,t){const r=n.slice();return r[9]=e[t][0],r[16]=e[t][1],r}function wo(n){let e,t;return e=new je({}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p:A,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function yo(n){let e,t;return e=new sr({props:{message:n[3]}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&8&&(i.message=r[3]),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function ko(n){let e,t,r=te(Object.entries(n[0])),s=[];for(let o=0;o<r.length;o+=1)s[o]=Mr(Br(n,r,o));const i=o=>y(s[o],1,1,()=>{s[o]=null});return{c(){e=p("div");for(let o=0;o<s.length;o+=1)s[o].c();d(e,"class","row justify-content-around")},m(o,l){C(o,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(o,l){if(l&1){r=te(Object.entries(o[0]));let a;for(a=0;a<r.length;a+=1){const c=Br(o,r,a);s[a]?(s[a].p(c,l),w(s[a],1)):(s[a]=Mr(c),s[a].c(),w(s[a],1),s[a].m(e,null))}for(W(),a=r.length;a<s.length;a+=1)i(a);Y()}},i(o){if(!t){for(let l=0;l<r.length;l+=1)w(s[l]);t=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)y(s[l]);t=!1},d(o){o&&O(e),ye(s,o)}}}function Mr(n){let e,t;return e=new Tt({props:{title:n[16].title,id:n[16].id,author:n[16].author}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&1&&(i.title=r[16].title),s&1&&(i.id=r[16].id),s&1&&(i.author=r[16].author),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function $o(n){let e,t,r,s;const i=[ko,yo,wo],o=[];function l(a,c){return a[0]?0:a[3]?1:2}return e=l(n),t=o[e]=i[e](n),{c(){t.c(),r=pe()},m(a,c){o[e].m(a,c),C(a,r,c),s=!0},p(a,c){let u=e;e=l(a),e===u?o[e].p(a,c):(W(),y(o[u],1,1,()=>{o[u]=null}),Y(),t=o[e],t?t.p(a,c):(t=o[e]=i[e](a),t.c()),w(t,1),t.m(r.parentNode,r))},i(a){s||(w(t),s=!0)},o(a){y(t),s=!1},d(a){a&&O(r),o[e].d(a)}}}function So(n){let e,t;return e=new je({}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p:A,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function Eo(n){let e,t;return e=new sr({props:{message:n[4]}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&16&&(i.message=r[4]),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function To(n){let e,t,r=te(Object.entries(n[1])),s=[];for(let o=0;o<r.length;o+=1)s[o]=Fr(qr(n,r,o));const i=o=>y(s[o],1,1,()=>{s[o]=null});return{c(){e=p("div");for(let o=0;o<s.length;o+=1)s[o].c();d(e,"class","row justify-content-around")},m(o,l){C(o,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(o,l){if(l&2){r=te(Object.entries(o[1]));let a;for(a=0;a<r.length;a+=1){const c=qr(o,r,a);s[a]?(s[a].p(c,l),w(s[a],1)):(s[a]=Fr(c),s[a].c(),w(s[a],1),s[a].m(e,null))}for(W(),a=r.length;a<s.length;a+=1)i(a);Y()}},i(o){if(!t){for(let l=0;l<r.length;l+=1)w(s[l]);t=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)y(s[l]);t=!1},d(o){o&&O(e),ye(s,o)}}}function Fr(n){let e,t;return e=new xs({props:{id:n[13].id,name:n[13].name}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&2&&(i.id=r[13].id),s&2&&(i.name=r[13].name),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function jo(n){let e,t,r,s;const i=[To,Eo,So],o=[];function l(a,c){return a[1]?0:a[4]?1:2}return e=l(n),t=o[e]=i[e](n),{c(){t.c(),r=pe()},m(a,c){o[e].m(a,c),C(a,r,c),s=!0},p(a,c){let u=e;e=l(a),e===u?o[e].p(a,c):(W(),y(o[u],1,1,()=>{o[u]=null}),Y(),t=o[e],t?t.p(a,c):(t=o[e]=i[e](a),t.c()),w(t,1),t.m(r.parentNode,r))},i(a){s||(w(t),s=!0)},o(a){y(t),s=!1},d(a){a&&O(r),o[e].d(a)}}}function Oo(n){let e,t;return e=new je({}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p:A,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function Ao(n){let e,t;return e=new sr({props:{message:n[5]}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&32&&(i.message=r[5]),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function Co(n){let e,t,r=te(Object.entries(n[2])),s=[];for(let o=0;o<r.length;o+=1)s[o]=zr(Nr(n,r,o));const i=o=>y(s[o],1,1,()=>{s[o]=null});return{c(){e=p("div");for(let o=0;o<s.length;o+=1)s[o].c();d(e,"class","row justify-content-around")},m(o,l){C(o,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(o,l){if(l&4){r=te(Object.entries(o[2]));let a;for(a=0;a<r.length;a+=1){const c=Nr(o,r,a);s[a]?(s[a].p(c,l),w(s[a],1)):(s[a]=zr(c),s[a].c(),w(s[a],1),s[a].m(e,null))}for(W(),a=r.length;a<s.length;a+=1)i(a);Y()}},i(o){if(!t){for(let l=0;l<r.length;l+=1)w(s[l]);t=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)y(s[l]);t=!1},d(o){o&&O(e),ye(s,o)}}}function zr(n){let e,t;return e=new Ds({props:{id:n[10].id,name:n[10].name}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&4&&(i.id=r[10].id),s&4&&(i.name=r[10].name),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function Po(n){let e,t,r,s;const i=[Co,Ao,Oo],o=[];function l(a,c){return a[2]?0:a[5]?1:2}return e=l(n),t=o[e]=i[e](n),{c(){t.c(),r=pe()},m(a,c){o[e].m(a,c),C(a,r,c),s=!0},p(a,c){let u=e;e=l(a),e===u?o[e].p(a,c):(W(),y(o[u],1,1,()=>{o[u]=null}),Y(),t=o[e],t?t.p(a,c):(t=o[e]=i[e](a),t.c()),w(t,1),t.m(r.parentNode,r))},i(a){s||(w(t),s=!0)},o(a){y(t),s=!1},d(a){a&&O(r),o[e].d(a)}}}function Ro(n){let e,t,r,s,i,o,l,a,c,u;return t=new wn({}),s=new Ie({props:{title:"Books",icon:"journal",link:"search/",$$slots:{default:[$o]},$$scope:{ctx:n}}}),o=new Ie({props:{title:"Authors",icon:"person",link:"search/author",$$slots:{default:[jo]},$$scope:{ctx:n}}}),a=new Ie({props:{title:"Publishers",icon:"building",link:"search/publisher",$$slots:{default:[Po]},$$scope:{ctx:n}}}),{c(){e=p("main"),L(t.$$.fragment),r=$(),L(s.$$.fragment),i=$(),L(o.$$.fragment),l=$(),L(a.$$.fragment),d(e,"class","container mb-5")},m(h,_){C(h,e,_),R(t,e,null),f(e,r),R(s,e,null),f(e,i),R(o,e,null),f(e,l),R(a,e,null),u=!0},p(h,[_]){const m={};_&524297&&(m.$$scope={dirty:_,ctx:h}),s.$set(m);const g={};_&524306&&(g.$$scope={dirty:_,ctx:h}),o.$set(g);const b={};_&524324&&(b.$$scope={dirty:_,ctx:h}),a.$set(b)},i(h){u||(w(t.$$.fragment,h),w(s.$$.fragment,h),w(o.$$.fragment,h),w(a.$$.fragment,h),h&&(c||_e(()=>{c=Le(e,De,{duration:500}),c.start()})),u=!0)},o(h){y(t.$$.fragment,h),y(s.$$.fragment,h),y(o.$$.fragment,h),y(a.$$.fragment,h),u=!1},d(h){h&&O(e),I(t),I(s),I(o),I(a)}}}function Io(n,e,t){let r,s,i,o,l,a;async function c(){const{data:_,error:m}=await ve.rpc("get_books");t(0,r=_),t(3,o=m?m.message:"")}async function u(){const{data:_,error:m}=await ve.rpc("get_authors");t(1,s=_),t(4,l=m?m.message:"")}async function h(){const{data:_,error:m}=await ve.rpc("get_publishers");t(2,i=_),t(5,a=m||"")}return c(),u(),h(),[r,s,i,o,l,a]}class Lo extends V{constructor(e){super(),K(this,e,Io,Ro,J,{})}}function xo(n){let e,t,r,s,i,o,l,a;return{c(){e=p("div"),t=p("button"),t.innerHTML='<i class="bi bi-arrow-left-circle"></i>',r=$(),s=p("div"),i=p("h4"),o=G(n[0]),d(t,"class","btn"),Qe(t,"font-size","1.5em"),d(i,"class","my-auto"),d(e,"class","d-flex border-bottom border-1 my-3 align-items-center")},m(c,u){C(c,e,u),f(e,t),f(e,r),f(e,s),f(s,i),f(i,o),l||(a=fe(t,"click",n[1]),l=!0)},p(c,[u]){u&1&&ee(o,c[0])},i:A,o:A,d(c){c&&O(e),l=!1,a()}}}function Do(n,e,t){let{text:r}=e;const s=()=>_n();return n.$$set=i=>{"text"in i&&t(0,r=i.text)},[r,s]}class et extends V{constructor(e){super(),K(this,e,Do,xo,J,{text:0})}}function Hr(n,e,t){const r=n.slice();return r[6]=e[t][0],r[7]=e[t][1],r}function Uo(n){let e,t;return e=new je({}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p:A,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function No(n){let e,t,r,s,i,o,l,a=n[1].title+"",c,u,h,_=n[1].description+"",m,g,b,v,k,P,T=n[1].author.name+"",S,E,j,D,U,z,q,M=n[1].publisher.name+"",oe,X,me,ie,ge,ue,H,Q=n[1].category.name+"",be;return{c(){e=p("div"),t=p("div"),r=p("img"),i=$(),o=p("div"),l=p("h1"),c=G(a),u=$(),h=p("p"),m=G(_),g=$(),b=p("p"),v=p("b"),v.textContent="Author:",k=$(),P=p("a"),S=G(T),j=$(),D=p("p"),U=p("b"),U.textContent="Publisher:",z=$(),q=p("a"),oe=G(M),me=$(),ie=p("p"),ge=p("b"),ge.textContent="Category:",ue=$(),H=p("a"),be=G(Q),d(r,"id","img-cover"),d(r,"class","border p-3"),ce(r.src,s="./"+n[2]+".jpg")||d(r,"src",s),d(r,"alt","book cover"),d(r,"height","300"),d(r,"width","300"),Qe(r,"object-fit","contain"),d(t,"id","book-cover"),d(t,"class","d-flex justify-content-center my-1"),d(l,"id","book-title"),d(l,"class","mb-2 pb-2"),d(h,"id","book-description"),d(P,"href",E="./#/author/"+n[1].author.id),d(q,"href",X="./#/publisher/"+n[1].publisher.id),d(H,"href","/"),d(o,"id","details-container"),d(o,"class","container"),d(e,"class","d-md-flex d-block")},m(re,se){C(re,e,se),f(e,t),f(t,r),f(e,i),f(e,o),f(o,l),f(l,c),f(o,u),f(o,h),f(h,m),f(o,g),f(o,b),f(b,v),f(b,k),f(b,P),f(P,S),f(o,j),f(o,D),f(D,U),f(D,z),f(D,q),f(q,oe),f(o,me),f(o,ie),f(ie,ge),f(ie,ue),f(ie,H),f(H,be)},p(re,se){se&2&&a!==(a=re[1].title+"")&&ee(c,a),se&2&&_!==(_=re[1].description+"")&&ee(m,_),se&2&&T!==(T=re[1].author.name+"")&&ee(S,T),se&2&&E!==(E="./#/author/"+re[1].author.id)&&d(P,"href",E),se&2&&M!==(M=re[1].publisher.name+"")&&ee(oe,M),se&2&&X!==(X="./#/publisher/"+re[1].publisher.id)&&d(q,"href",X),se&2&&Q!==(Q=re[1].category.name+"")&&ee(be,Q)},i:A,o:A,d(re){re&&O(e)}}}function Jr(n){let e,t;return e=new Ie({props:{title:"Status",icon:"journal",$$slots:{default:[qo]},$$scope:{ctx:n}}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&1024&&(i.$$scope={dirty:s,ctx:r}),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function Gr(n){let e,t,r,s,i,o,l=n[7].status+"",a,c;return{c(){e=p("tr"),t=p("td"),t.textContent=`${n[7].barcode}`,r=$(),s=p("td"),s.textContent=`${n[7].status!="Available"?"Francis James E. Salles":"--"}`,i=$(),o=p("td"),a=G(l),c=$(),d(o,"class",n[7].status=="Available"?"text-bg-success":n[7].status=="Reserved"?"text-bg-secondary":"text-bg-danger")},m(u,h){C(u,e,h),f(e,t),f(e,r),f(e,s),f(e,i),f(e,o),f(o,a),f(e,c)},p:A,d(u){u&&O(e)}}}function qo(n){let e,t,r,s,i,o,l=te(Object.entries(n[3])),a=[];for(let c=0;c<l.length;c+=1)a[c]=Gr(Hr(n,l,c));return{c(){e=p("table"),t=p("thead"),t.innerHTML='<tr><th class="py-3 col-3">Barcode</th> <th class="py-3 col-5">Student</th> <th class="py-3 col-2">Status</th></tr>',r=$(),s=p("tbody");for(let c=0;c<a.length;c+=1)a[c].c();i=$(),o=p("div"),o.innerHTML='<label for="copy" class="form=control col-auto">Add Copy:</label> <div class="col-7"><input type="text" class="form-control" placeholder="Barcode Number"/></div> <button class="btn btn-primary col-auto">Add</button>',d(e,"class","table table-bordered table-striped text-center align-middle"),d(o,"class","row justify-content-center align-items-center")},m(c,u){C(c,e,u),f(e,t),f(e,r),f(e,s);for(let h=0;h<a.length;h+=1)a[h]&&a[h].m(s,null);C(c,i,u),C(c,o,u)},p(c,u){if(u&8){l=te(Object.entries(c[3]));let h;for(h=0;h<l.length;h+=1){const _=Hr(c,l,h);a[h]?a[h].p(_,u):(a[h]=Gr(_),a[h].c(),a[h].m(s,null))}for(;h<a.length;h+=1)a[h].d(1);a.length=l.length}},d(c){c&&(O(e),O(i),O(o)),ye(a,c)}}}function Bo(n){let e,t,r,s,i,o,l,a,c,u,h;r=new et({props:{text:"Book Details"}});const _=[No,Uo],m=[];function g(v,k){return v[1]?0:1}i=g(n),o=m[i]=_[i](n);let b=n[0]=="staff"&&Jr(n);return{c(){e=p("main"),t=p("section"),L(r.$$.fragment),s=$(),o.c(),l=$(),b&&b.c(),a=$(),c=p("div"),d(c,"class","my-5"),d(e,"class","container")},m(v,k){C(v,e,k),f(e,t),R(r,t,null),f(t,s),m[i].m(t,null),f(e,l),b&&b.m(e,null),f(e,a),f(e,c),h=!0},p(v,[k]){let P=i;i=g(v),i===P?m[i].p(v,k):(W(),y(m[P],1,1,()=>{m[P]=null}),Y(),o=m[i],o?o.p(v,k):(o=m[i]=_[i](v),o.c()),w(o,1),o.m(t,null)),v[0]=="staff"?b?(b.p(v,k),k&1&&w(b,1)):(b=Jr(v),b.c(),w(b,1),b.m(e,a)):b&&(W(),y(b,1,1,()=>{b=null}),Y())},i(v){h||(w(r.$$.fragment,v),w(o),w(b),v&&(u||_e(()=>{u=Le(e,De,{duration:500}),u.start()})),h=!0)},o(v){y(r.$$.fragment,v),y(o),y(b),h=!1},d(v){v&&O(e),I(r),m[i].d(),b&&b.d()}}}function Mo(n,e,t){let r;We.subscribe(c=>t(0,r=c));let{params:s}=e,i=s.bookID,o;async function l(){const{data:c,error:u}=await ve.from("books").select("title, description, author(id, name), publisher(id, name), category(name)").eq("id",i);console.log(c),t(1,o=c[0])}ct(l);let a={0:{barcode:"13251235173",status:"Available"},1:{barcode:"128736197689",status:"Reserved"},2:{barcode:"351313525135",status:"Borrowed"}};return n.$$set=c=>{"params"in c&&t(4,s=c.params)},[r,o,i,a,s]}class Us extends V{constructor(e){super(),K(this,e,Mo,Bo,J,{params:4})}}function Fo(n){let e,t,r,s,i,o;const l=n[3].default,a=as(l,n,n[2],null);return{c(){e=p("div"),t=p("label"),r=G(n[0]),s=$(),i=p("div"),a&&a.c(),d(t,"class","col-sm-4 col-md-3 col-form-label"),d(t,"for",n[1]),d(i,"class","col-sm-8 col-md-9"),d(e,"class","mb-4 row")},m(c,u){C(c,e,u),f(e,t),f(t,r),f(e,s),f(e,i),a&&a.m(i,null),o=!0},p(c,[u]){(!o||u&1)&&ee(r,c[0]),(!o||u&2)&&d(t,"for",c[1]),a&&a.p&&(!o||u&4)&&us(a,l,c,c[2],o?cs(l,c[2],u,null):hs(c[2]),null)},i(c){o||(w(a,c),o=!0)},o(c){y(a,c),o=!1},d(c){c&&O(e),a&&a.d(c)}}}function zo(n,e,t){let{$$slots:r={},$$scope:s}=e,{label:i}=e,{id:o}=e;return n.$$set=l=>{"label"in l&&t(0,i=l.label),"id"in l&&t(1,o=l.id),"$$scope"in l&&t(2,s=l.$$scope)},[i,o,s,r]}class $e extends V{constructor(e){super(),K(this,e,zo,Fo,J,{label:0,id:1})}}function Ho(n){let e;return{c(){e=p("input"),d(e,"class","form-control"),d(e,"type","text"),d(e,"id","book-name")},m(t,r){C(t,e,r)},p:A,d(t){t&&O(e)}}}function Jo(n){let e;return{c(){e=p("textarea"),d(e,"class","form-control"),d(e,"id","book-description"),d(e,"rows","4")},m(t,r){C(t,e,r)},p:A,d(t){t&&O(e)}}}function Go(n){let e,t,r;return{c(){e=p("input"),d(e,"class","form-control"),d(e,"type","file"),d(e,"id","book-cover"),d(e,"accept","image/*")},m(s,i){C(s,e,i),n[5](e),t||(r=fe(e,"change",n[4]),t=!0)},p:A,d(s){s&&O(e),n[5](null),t=!1,r()}}}function Ko(n){let e;return{c(){e=p("input"),d(e,"class","form-control"),d(e,"type","text"),d(e,"id","book-category")},m(t,r){C(t,e,r)},p:A,d(t){t&&O(e)}}}function Vo(n){let e;return{c(){e=p("input"),d(e,"list","authors"),d(e,"class","form-control"),d(e,"type","text"),d(e,"id","book-author")},m(t,r){C(t,e,r)},p:A,d(t){t&&O(e)}}}function Wo(n){let e;return{c(){e=p("input"),d(e,"list","publishers"),d(e,"class","form-control"),d(e,"type","text"),d(e,"id","book-publisher")},m(t,r){C(t,e,r)},p:A,d(t){t&&O(e)}}}function Yo(n){let e;return{c(){e=p("input"),d(e,"class","form-control"),d(e,"type","text"),d(e,"id","book-isbn")},m(t,r){C(t,e,r)},p:A,d(t){t&&O(e)}}}function Xo(n){let e,t,r,s,i,o,l,a,c,u,h,_,m,g,b,v,k,P,T,S,E,j,D,U,z,q,M,oe,X,me,ie,ge,ue,H,Q,be,re,se,At,Ue,Ct,nr;return t=new et({props:{text:"Add Book"}}),o=new $e({props:{label:"Book Title:",id:"book-name",$$slots:{default:[Ho]},$$scope:{ctx:n}}}),a=new $e({props:{label:"Book Description:",id:"book-description",$$slots:{default:[Jo]},$$scope:{ctx:n}}}),u=new $e({props:{label:"Book Cover:",id:"book-cover",$$slots:{default:[Go]},$$scope:{ctx:n}}}),D=new $e({props:{label:"Category:",id:"book-category",$$slots:{default:[Ko]},$$scope:{ctx:n}}}),z=new $e({props:{label:"Author: ",id:"book-author",$$slots:{default:[Vo]},$$scope:{ctx:n}}}),M=new $e({props:{label:"Publisher: ",id:"book-publisher",$$slots:{default:[Wo]},$$scope:{ctx:n}}}),X=new $e({props:{label:"Category: ",id:"book-category",$$slots:{default:[Yo]},$$scope:{ctx:n}}}),{c(){e=p("section"),L(t.$$.fragment),r=$(),s=p("div"),i=p("div"),L(o.$$.fragment),l=$(),L(a.$$.fragment),c=$(),L(u.$$.fragment),h=$(),_=p("div"),m=p("label"),m.textContent="Preview:",g=$(),b=p("div"),v=p("img"),P=$(),T=p("button"),T.textContent="Remove",E=$(),j=p("div"),L(D.$$.fragment),U=$(),L(z.$$.fragment),q=$(),L(M.$$.fragment),oe=$(),L(X.$$.fragment),me=$(),ie=p("div"),ie.innerHTML='<button class="btn btn-success" disabled="" id="add"><i class="bi bi-plus-circle"></i> Add Book</button> <a href="./#/"><button class="btn btn-danger" id="cancel"><i class="bi bi-x-circle"></i> Cancel</button></a>',ge=$(),ue=p("datalist"),H=p("option"),H.innerHTML="",Q=p("option"),Q.innerHTML="",be=$(),re=p("datalist"),se=p("option"),se.innerHTML="",d(m,"for","cover-preview"),d(m,"class","col-sm-4 col-md-3 col-form-label align-self-center"),ce(v.src,k=n[3])||d(v,"src",k),d(v,"alt","Preview"),d(v,"id","cover-preview"),d(v,"height","150"),d(T,"class","btn btn-sm btn-danger"),d(b,"class","col-sm-8 col-md-9"),d(b,"id","preview-div"),d(_,"class",S="my-3 row "+n[2]),d(i,"class","col-sm-12 col-lg-6"),d(j,"class","col-sm-12 col-lg-6"),d(s,"class","row justify-content-center"),d(ie,"class","my-3"),H.__value="Jemma Development Group",Ee(H,H.__value),Q.__value="Richard Osman",Ee(Q,Q.__value),d(ue,"id","authors"),se.__value="Jemma Inc.",Ee(se,se.__value),d(re,"id","publishers"),d(e,"class","my-1 container")},m(B,Z){C(B,e,Z),R(t,e,null),f(e,r),f(e,s),f(s,i),R(o,i,null),f(i,l),R(a,i,null),f(i,c),R(u,i,null),f(i,h),f(i,_),f(_,m),f(_,g),f(_,b),f(b,v),f(b,P),f(b,T),f(s,E),f(s,j),R(D,j,null),f(j,U),R(z,j,null),f(j,q),R(M,j,null),f(j,oe),R(X,j,null),f(e,me),f(e,ie),f(e,ge),f(e,ue),f(ue,H),f(ue,Q),f(e,be),f(e,re),f(re,se),Ue=!0,Ct||(nr=fe(T,"click",n[6]),Ct=!0)},p(B,[Z]){const ir={};Z&128&&(ir.$$scope={dirty:Z,ctx:B}),o.$set(ir);const or={};Z&128&&(or.$$scope={dirty:Z,ctx:B}),a.$set(or);const ar={};Z&131&&(ar.$$scope={dirty:Z,ctx:B}),u.$set(ar),(!Ue||Z&8&&!ce(v.src,k=B[3]))&&d(v,"src",k),(!Ue||Z&4&&S!==(S="my-3 row "+B[2]))&&d(_,"class",S);const lr={};Z&128&&(lr.$$scope={dirty:Z,ctx:B}),D.$set(lr);const cr={};Z&128&&(cr.$$scope={dirty:Z,ctx:B}),z.$set(cr);const ur={};Z&128&&(ur.$$scope={dirty:Z,ctx:B}),M.$set(ur);const hr={};Z&128&&(hr.$$scope={dirty:Z,ctx:B}),X.$set(hr)},i(B){Ue||(w(t.$$.fragment,B),w(o.$$.fragment,B),w(a.$$.fragment,B),w(u.$$.fragment,B),w(D.$$.fragment,B),w(z.$$.fragment,B),w(M.$$.fragment,B),w(X.$$.fragment,B),B&&(At||_e(()=>{At=Le(e,De,{duration:500}),At.start()})),Ue=!0)},o(B){y(t.$$.fragment,B),y(o.$$.fragment,B),y(a.$$.fragment,B),y(u.$$.fragment,B),y(D.$$.fragment,B),y(z.$$.fragment,B),y(M.$$.fragment,B),y(X.$$.fragment,B),Ue=!1},d(B){B&&O(e),I(t),I(o),I(a),I(u),I(D),I(z),I(M),I(X),Ct=!1,nr()}}}function Qo(n,e,t){let r,s,i="d-none",o;function l(){r=this.files,t(0,r)}function a(u){yt[u?"unshift":"push"](()=>{s=u,t(1,s)})}const c=()=>{t(1,s.value="",s),t(0,r="")};return n.$$.update=()=>{if(n.$$.dirty&1)if(r&&r[0]){console.log(r),t(2,i="");const u=URL.createObjectURL(r[0]);t(3,o=u)}else console.log(r),t(2,i="d-none")},[r,s,i,o,l,a,c]}class Zo extends V{constructor(e){super(),K(this,e,Qo,Xo,J,{})}}function Kr(n,e,t){const r=n.slice();return r[5]=e[t][0],r[6]=e[t][1],r}function ea(n){let e,t;return e=new je({}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p:A,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function ta(n){let e,t,r=n[0].name+"",s,i,o,l,a;return{c(){e=p("div"),t=p("h1"),s=G(r),i=$(),o=p("p"),o.textContent=`Lorem ipsum dolor sit amet pariatur est libero! Facilis ipsum est\r
            voluptas animi aliquam dolorem sunt, iure consequuntur dignissimos\r
            doloremque! Neque velit quas, illum, facere aliquam sed\r
            exercitationem at voluptatem incidunt beatae voluptate deserunt.`,l=$(),a=p("p"),a.innerHTML='<b>Website:</b> <a href="https://github.com/salles4/">salles4.github.io</a>',d(t,"class","mb-2 pb-2"),d(o,"class",""),d(e,"class","container")},m(c,u){C(c,e,u),f(e,t),f(t,s),f(e,i),f(e,o),f(e,l),f(e,a)},p(c,u){u&1&&r!==(r=c[0].name+"")&&ee(s,r)},i:A,o:A,d(c){c&&O(e)}}}function ra(n){let e,t;return e=new je({}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p:A,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function sa(n){let e,t,r=te(Object.entries(n[1])),s=[];for(let o=0;o<r.length;o+=1)s[o]=Vr(Kr(n,r,o));const i=o=>y(s[o],1,1,()=>{s[o]=null});return{c(){e=p("div");for(let o=0;o<s.length;o+=1)s[o].c();d(e,"class","row")},m(o,l){C(o,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(o,l){if(l&2){r=te(Object.entries(o[1]));let a;for(a=0;a<r.length;a+=1){const c=Kr(o,r,a);s[a]?(s[a].p(c,l),w(s[a],1)):(s[a]=Vr(c),s[a].c(),w(s[a],1),s[a].m(e,null))}for(W(),a=r.length;a<s.length;a+=1)i(a);Y()}},i(o){if(!t){for(let l=0;l<r.length;l+=1)w(s[l]);t=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)y(s[l]);t=!1},d(o){o&&O(e),ye(s,o)}}}function Vr(n){let e,t;return e=new Tt({props:{title:n[6].title,id:n[6].id,author:n[6].author.name}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&2&&(i.title=r[6].title),s&2&&(i.id=r[6].id),s&2&&(i.author=r[6].author.name),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function na(n){let e,t,r,s;const i=[sa,ra],o=[];function l(a,c){return a[1]?0:1}return e=l(n),t=o[e]=i[e](n),{c(){t.c(),r=pe()},m(a,c){o[e].m(a,c),C(a,r,c),s=!0},p(a,c){let u=e;e=l(a),e===u?o[e].p(a,c):(W(),y(o[u],1,1,()=>{o[u]=null}),Y(),t=o[e],t?t.p(a,c):(t=o[e]=i[e](a),t.c()),w(t,1),t.m(r.parentNode,r))},i(a){s||(w(t),s=!0)},o(a){y(t),s=!1},d(a){a&&O(r),o[e].d(a)}}}function ia(n){let e,t,r,s,i,o,l,a,c,u,h,_,m,g,b;r=new et({props:{text:"Author Details"}});const v=[ta,ea],k=[];function P(T,S){return T[0]?0:1}return u=P(n),h=k[u]=v[u](n),m=new Ie({props:{title:"Books",icon:"journal",$$slots:{default:[na]},$$scope:{ctx:n}}}),{c(){e=p("main"),t=p("section"),L(r.$$.fragment),s=$(),i=p("div"),o=p("div"),l=p("img"),c=$(),h.c(),_=$(),L(m.$$.fragment),d(l,"class","border p-3"),ce(l.src,a=oa)||d(l,"src",a),d(l,"alt","author"),d(l,"height","300"),d(l,"width","300"),Qe(l,"object-fit","contain"),d(o,"class","d-flex justify-content-center my-1"),d(i,"class","d-md-flex d-block"),d(e,"class","container")},m(T,S){C(T,e,S),f(e,t),R(r,t,null),f(t,s),f(t,i),f(i,o),f(o,l),f(i,c),k[u].m(i,null),f(e,_),R(m,e,null),b=!0},p(T,[S]){let E=u;u=P(T),u===E?k[u].p(T,S):(W(),y(k[E],1,1,()=>{k[E]=null}),Y(),h=k[u],h?h.p(T,S):(h=k[u]=v[u](T),h.c()),w(h,1),h.m(i,null));const j={};S&514&&(j.$$scope={dirty:S,ctx:T}),m.$set(j)},i(T){b||(w(r.$$.fragment,T),w(h),w(m.$$.fragment,T),T&&(g||_e(()=>{g=Le(e,De,{duration:500}),g.start()})),b=!0)},o(T){y(r.$$.fragment,T),y(h),y(m.$$.fragment,T),b=!1},d(T){T&&O(e),I(r),k[u].d(),I(m)}}}let oa="./default-profile.jpg";function aa(n,e,t){let{params:r}=e,s=r.authorID,i,o;async function l(){const{data:a,error:c}=await ve.from("author").select().eq("id",s);console.log(a),t(0,i=a[0]);const{data:u,error:h}=await ve.from("books").select("id, title, author(name)").eq("publisher_id",s);console.log(u),t(1,o=u)}return ct(l),n.$$set=a=>{"params"in a&&t(2,r=a.params)},[i,o,r]}class Ns extends V{constructor(e){super(),K(this,e,aa,ia,J,{params:2})}}function Wr(n,e,t){const r=n.slice();return r[5]=e[t][0],r[6]=e[t][1],r}function Yr(n){let e,t,r=n[0].name+"",s,i,o,l,a;return{c(){e=p("div"),t=p("h1"),s=G(r),i=$(),o=p("p"),o.textContent=`Lorem ipsum dolor sit amet pariatur est libero! Facilis ipsum est\r
          voluptas animi aliquam dolorem sunt, iure consequuntur dignissimos\r
          doloremque! Neque velit quas, illum, facere aliquam sed exercitationem\r
          at voluptatem incidunt beatae voluptate deserunt.`,l=$(),a=p("p"),a.innerHTML='<b>Website:</b> <a href="https://github.com/salles4/" id="publisher-website">salles4.github.io</a>',d(t,"id","publisher-name"),d(t,"class","mb-2 pb-2"),d(o,"id","publisher-bio"),d(o,"class",""),d(e,"id","details-container"),d(e,"class","container")},m(c,u){C(c,e,u),f(e,t),f(t,s),f(e,i),f(e,o),f(e,l),f(e,a)},p(c,u){u&1&&r!==(r=c[0].name+"")&&ee(s,r)},d(c){c&&O(e)}}}function la(n){let e,t;return e=new je({}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p:A,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function ca(n){let e,t,r=te(Object.entries(n[1])),s=[];for(let o=0;o<r.length;o+=1)s[o]=Xr(Wr(n,r,o));const i=o=>y(s[o],1,1,()=>{s[o]=null});return{c(){e=p("div");for(let o=0;o<s.length;o+=1)s[o].c();d(e,"class","row")},m(o,l){C(o,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(o,l){if(l&2){r=te(Object.entries(o[1]));let a;for(a=0;a<r.length;a+=1){const c=Wr(o,r,a);s[a]?(s[a].p(c,l),w(s[a],1)):(s[a]=Xr(c),s[a].c(),w(s[a],1),s[a].m(e,null))}for(W(),a=r.length;a<s.length;a+=1)i(a);Y()}},i(o){if(!t){for(let l=0;l<r.length;l+=1)w(s[l]);t=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)y(s[l]);t=!1},d(o){o&&O(e),ye(s,o)}}}function Xr(n){let e,t;return e=new Tt({props:{title:n[6].title,id:n[6].id,author:n[6].author.name}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&2&&(i.title=r[6].title),s&2&&(i.id=r[6].id),s&2&&(i.author=r[6].author.name),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function ua(n){let e,t,r,s,i,o,l,a,c,u,h,_,m,g,b,v;t=new et({props:{text:"Publisher Details"}});let k=n[0]&&Yr(n);_=new Ie({props:{title:"Books",icon:"journal"}});const P=[ca,la],T=[];function S(E,j){return E[1]?0:1}return g=S(n),b=T[g]=P[g](n),{c(){e=p("section"),L(t.$$.fragment),r=$(),s=p("div"),i=p("div"),o=p("img"),a=$(),k&&k.c(),u=$(),h=p("section"),L(_.$$.fragment),m=$(),b.c(),d(o,"id","img-cover"),d(o,"class","border p-3"),ce(o.src,l=ha)||d(o,"src",l),d(o,"alt","publisher"),d(o,"height","300"),d(o,"width","300"),Qe(o,"object-fit","contain"),d(i,"id","publisher-cover"),d(i,"class","d-flex justify-content-center my-1"),d(s,"class","d-md-flex d-block"),d(e,"class","container"),d(h,"class","container")},m(E,j){C(E,e,j),R(t,e,null),f(e,r),f(e,s),f(s,i),f(i,o),f(s,a),k&&k.m(s,null),C(E,u,j),C(E,h,j),R(_,h,null),f(h,m),T[g].m(h,null),v=!0},p(E,[j]){E[0]?k?k.p(E,j):(k=Yr(E),k.c(),k.m(s,null)):k&&(k.d(1),k=null);let D=g;g=S(E),g===D?T[g].p(E,j):(W(),y(T[D],1,1,()=>{T[D]=null}),Y(),b=T[g],b?b.p(E,j):(b=T[g]=P[g](E),b.c()),w(b,1),b.m(h,null))},i(E){v||(w(t.$$.fragment,E),E&&(c||_e(()=>{c=Le(e,De,{duration:500}),c.start()})),w(_.$$.fragment,E),w(b),v=!0)},o(E){y(t.$$.fragment,E),y(_.$$.fragment,E),y(b),v=!1},d(E){E&&(O(e),O(u),O(h)),I(t),k&&k.d(),I(_),T[g].d()}}}let ha="./default-profile.jpg";function da(n,e,t){let{params:r}=e,s=r.publisherID,i,o;async function l(){const{data:a,error:c}=await ve.from("publisher").select().eq("id",s);console.log(a),t(0,i=a[0]);const{data:u,error:h}=await ve.from("books").select("id, title, author(name)").eq("publisher_id",s);console.log(u),t(1,o=u)}return ct(l),n.$$set=a=>{"params"in a&&t(2,r=a.params)},[i,o,r]}class qs extends V{constructor(e){super(),K(this,e,da,ua,J,{params:2})}}function fa(n){let e,t,r,s,i,o,l,a,c,u;return{c(){e=p("div"),t=p("div"),r=p("i"),i=$(),o=p("div"),l=p("h5"),a=p("a"),c=G(n[0]),d(r,"class",s="bi bi-"+n[2]),d(t,"class","d-flex justify-content-center"),Qe(t,"font-size","4em"),d(a,"class","stretched-link svelte-1vxezln"),d(a,"href",u="./#/"+n[1]),d(l,"class","card-title text-center my-3"),d(o,"class","card-body p-1"),d(e,"class","card col-md-3 col-6 border-1 py-4 svelte-1vxezln")},m(h,_){C(h,e,_),f(e,t),f(t,r),f(e,i),f(e,o),f(o,l),f(l,a),f(a,c)},p(h,[_]){_&4&&s!==(s="bi bi-"+h[2])&&d(r,"class",s),_&1&&ee(c,h[0]),_&2&&u!==(u="./#/"+h[1])&&d(a,"href",u)},i:A,o:A,d(h){h&&O(e)}}}function _a(n,e,t){let{name:r}=e,{link:s}=e,{icon:i=""}=e;return n.$$set=o=>{"name"in o&&t(0,r=o.name),"link"in o&&t(1,s=o.link),"icon"in o&&t(2,i=o.icon)},[r,s,i]}class mt extends V{constructor(e){super(),K(this,e,_a,fa,J,{name:0,link:1,icon:2})}}function pa(n){let e,t,r,s,i,o,l,a,c,u,h,_,m;return t=new Ie({props:{title:"Welcome!",icon:"wrench-adjustable"}}),i=new mt({props:{name:"Borrow",link:"borrow",icon:"journal-arrow-up"}}),l=new mt({props:{name:"Return",link:"return",icon:"journal-arrow-down"}}),c=new mt({props:{name:"Add Book",link:"add-book",icon:"journal-plus"}}),h=new mt({props:{name:"Manage",link:"manage",icon:"journal-album"}}),{c(){e=p("main"),L(t.$$.fragment),r=$(),s=p("div"),L(i.$$.fragment),o=$(),L(l.$$.fragment),a=$(),L(c.$$.fragment),u=$(),L(h.$$.fragment),d(s,"class","row"),d(e,"class","container")},m(g,b){C(g,e,b),R(t,e,null),f(e,r),f(e,s),R(i,s,null),f(s,o),R(l,s,null),f(s,a),R(c,s,null),f(s,u),R(h,s,null),m=!0},p:A,i(g){m||(w(t.$$.fragment,g),w(i.$$.fragment,g),w(l.$$.fragment,g),w(c.$$.fragment,g),w(h.$$.fragment,g),g&&(_||_e(()=>{_=Le(e,De,{duration:500}),_.start()})),m=!0)},o(g){y(t.$$.fragment,g),y(i.$$.fragment,g),y(l.$$.fragment,g),y(c.$$.fragment,g),y(h.$$.fragment,g),m=!1},d(g){g&&O(e),I(t),I(i),I(l),I(c),I(h)}}}class ma extends V{constructor(e){super(),K(this,e,null,pa,J,{})}}function Qr(n,e,t){const r=n.slice();return r[13]=e[t][0],r[14]=e[t][1],r}function Zr(n,e,t){const r=n.slice();return r[13]=e[t][0],r[14]=e[t][1],r}function es(n,e,t){const r=n.slice();return r[13]=e[t][0],r[14]=e[t][1],r}function ga(n){let e,t;return e=new je({}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p:A,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function ba(n){let e;return{c(){e=p("div"),e.innerHTML='<div class="text-center"><h1><i class="bi bi-patch-question"></i></h1> <h4>No Results</h4></div>',d(e,"class","d-flex justify-content-center")},m(t,r){C(t,e,r)},p:A,i:A,o:A,d(t){t&&O(e)}}}function va(n){let e,t,r=te(Object.entries(n[2].publisher)),s=[];for(let o=0;o<r.length;o+=1)s[o]=ts(Qr(n,r,o));const i=o=>y(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=pe()},m(o,l){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(o,l);C(o,e,l),t=!0},p(o,l){if(l&4){r=te(Object.entries(o[2].publisher));let a;for(a=0;a<r.length;a+=1){const c=Qr(o,r,a);s[a]?(s[a].p(c,l),w(s[a],1)):(s[a]=ts(c),s[a].c(),w(s[a],1),s[a].m(e.parentNode,e))}for(W(),a=r.length;a<s.length;a+=1)i(a);Y()}},i(o){if(!t){for(let l=0;l<r.length;l+=1)w(s[l]);t=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)y(s[l]);t=!1},d(o){o&&O(e),ye(s,o)}}}function wa(n){let e,t,r=te(Object.entries(n[2].author)),s=[];for(let o=0;o<r.length;o+=1)s[o]=rs(Zr(n,r,o));const i=o=>y(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=pe()},m(o,l){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(o,l);C(o,e,l),t=!0},p(o,l){if(l&4){r=te(Object.entries(o[2].author));let a;for(a=0;a<r.length;a+=1){const c=Zr(o,r,a);s[a]?(s[a].p(c,l),w(s[a],1)):(s[a]=rs(c),s[a].c(),w(s[a],1),s[a].m(e.parentNode,e))}for(W(),a=r.length;a<s.length;a+=1)i(a);Y()}},i(o){if(!t){for(let l=0;l<r.length;l+=1)w(s[l]);t=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)y(s[l]);t=!1},d(o){o&&O(e),ye(s,o)}}}function ya(n){let e,t,r=te(Object.entries(n[2].books)),s=[];for(let o=0;o<r.length;o+=1)s[o]=ss(es(n,r,o));const i=o=>y(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=pe()},m(o,l){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(o,l);C(o,e,l),t=!0},p(o,l){if(l&4){r=te(Object.entries(o[2].books));let a;for(a=0;a<r.length;a+=1){const c=es(o,r,a);s[a]?(s[a].p(c,l),w(s[a],1)):(s[a]=ss(c),s[a].c(),w(s[a],1),s[a].m(e.parentNode,e))}for(W(),a=r.length;a<s.length;a+=1)i(a);Y()}},i(o){if(!t){for(let l=0;l<r.length;l+=1)w(s[l]);t=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)y(s[l]);t=!1},d(o){o&&O(e),ye(s,o)}}}function ts(n){let e,t;return e=new Ds({props:{id:n[14].id,name:n[14].name}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&4&&(i.id=r[14].id),s&4&&(i.name=r[14].name),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function rs(n){let e,t;return e=new xs({props:{id:n[14].id,name:n[14].name}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&4&&(i.id=r[14].id),s&4&&(i.name=r[14].name),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function ss(n){let e,t;return e=new Tt({props:{title:n[14].title,id:n[14].id,author:n[14].author.name}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&4&&(i.title=r[14].title),s&4&&(i.id=r[14].id),s&4&&(i.author=r[14].author.name),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function ka(n){let e,t,r,s,i,o,l,a,c,u,h,_,m,g,b,v,k,P,T,S,E,j;t=new et({props:{text:"Library Holdings"}});const D=[ya,wa,va,ba,ga],U=[];function z(q,M){return q[2].books.length>0?0:q[2].author.length>0?1:q[2].publisher.length>0?2:q[0]?4:3}return k=z(n),P=U[k]=D[k](n),{c(){e=p("main"),L(t.$$.fragment),r=$(),s=p("div"),i=p("div"),o=p("select"),l=p("option"),l.textContent="Books",a=p("option"),a.textContent="Author",c=p("option"),c.textContent="Publisher",u=$(),h=p("div"),_=p("input"),m=$(),g=p("button"),g.innerHTML='<i class="bi bi-search"></i>',b=$(),v=p("div"),P.c(),l.selected=!0,l.__value="books",Ee(l,l.__value),a.__value="author",Ee(a,a.__value),c.__value="publisher",Ee(c,c.__value),d(o,"name","searchtype"),d(o,"class","form-select"),d(i,"class","col-auto col-md-2 p-0 pe-md-4"),d(_,"class","form-control form-control-lg"),d(_,"type","search"),d(_,"placeholder","Search"),d(_,"name","Search"),d(h,"class","col-6 col-md-6 p-0"),d(g,"class","btn btn-lg btn-success col-auto col-md-1"),d(g,"type","submit"),d(s,"class","row justify-content-center align-items-center my-4 mx-auto col-12"),d(v,"class","row"),d(e,"class","container")},m(q,M){C(q,e,M),R(t,e,null),f(e,r),f(e,s),f(s,i),f(i,o),f(o,l),f(o,a),f(o,c),n[5](o),f(s,u),f(s,h),f(h,_),Ee(_,n[1]),f(s,m),f(s,g),f(e,b),f(e,v),U[k].m(v,null),S=!0,E||(j=[fe(o,"change",n[4]),fe(_,"input",n[6]),fe(_,"keyup",n[7]),fe(g,"click",n[4])],E=!0)},p(q,[M]){M&2&&_.value!==q[1]&&Ee(_,q[1]);let oe=k;k=z(q),k===oe?U[k].p(q,M):(W(),y(U[oe],1,1,()=>{U[oe]=null}),Y(),P=U[k],P?P.p(q,M):(P=U[k]=D[k](q),P.c()),w(P,1),P.m(v,null))},i(q){S||(w(t.$$.fragment,q),w(P),q&&(T||_e(()=>{T=Le(e,De,{duration:500}),T.start()})),S=!0)},o(q){y(t.$$.fragment,q),y(P),S=!1},d(q){q&&O(e),I(t),n[5](null),U[k].d(),E=!1,we(j)}}}function $a(n,e,t){let r;zs(n,fn,v=>t(9,r=v));let s=!0;function i(){switch(r){case"/search/author":t(3,h.value="author",h);break;case"/search/publisher":t(3,h.value="publisher",h);break;default:t(3,h.value="books",h)}}const o={books:"id, title, author(name)",author:"id, name",publisher:"id, name"},l={books:"title",author:"name",publisher:"name"};let a="books",c="",u={books:[],author:[],publisher:[]},h;async function _(){t(0,s=!0),a=h.value,console.log(a);const{data:v,error:k}=await ve.from(a).select(o[a]).ilike(l[a],`%${c}%`);k&&console.log(k),t(2,u.books=[],u),t(2,u.author=[],u),t(2,u.publisher=[],u),t(2,u[a]=v,u),t(2,u),t(0,s=!1),console.log(s,u)}ct(i),ct(_);function m(v){yt[v?"unshift":"push"](()=>{h=v,t(3,h)})}function g(){c=this.value,t(1,c)}return[s,c,u,h,_,m,g,v=>v.key==="Enter"&&_()]}class Ve extends V{constructor(e){super(),K(this,e,$a,ka,J,{})}}function Sa(n){let e,t,r,s,i,o;return{c(){e=p("div"),t=p("button"),t.textContent="Client",r=$(),s=p("button"),s.textContent="Staff",d(t,"class","m-2 btn btn-primary btn-lg"),d(s,"class","m-2 btn btn-danger btn-lg"),d(e,"class","d-flex justify-content-center align-items-center"),Qe(e,"height","90vh")},m(l,a){C(l,e,a),f(e,t),f(e,r),f(e,s),i||(o=[fe(t,"click",n[0]),fe(s,"click",n[1])],i=!0)},p:A,i:A,o:A,d(l){l&&O(e),i=!1,we(o)}}}function Ea(n){return document.querySelector("body").setAttribute("data-bs-theme","dark"),[()=>{We.set("client"),localStorage.setItem("accType","client")},()=>{We.set("staff"),localStorage.setItem("accType","staff")}]}class Ta extends V{constructor(e){super(),K(this,e,Ea,Sa,J,{})}}function ja(n){let e;return{c(){e=p("input"),d(e,"class","form-control"),d(e,"type","text"),d(e,"id","book-name")},m(t,r){C(t,e,r)},p:A,d(t){t&&O(e)}}}function Oa(n){let e,t,r,s,i,o,l;return t=new et({props:{text:"Borrow Book"}}),o=new $e({props:{label:"Student ID:",id:"book-name",$$slots:{default:[ja]},$$scope:{ctx:n}}}),{c(){e=p("main"),L(t.$$.fragment),r=$(),s=p("div"),i=p("div"),L(o.$$.fragment),d(i,"class","col-sm-12 col-lg-6"),d(s,"class","row justify-content-center"),d(e,"class","container")},m(a,c){C(a,e,c),R(t,e,null),f(e,r),f(e,s),f(s,i),R(o,i,null),l=!0},p(a,[c]){const u={};c&1&&(u.$$scope={dirty:c,ctx:a}),o.$set(u)},i(a){l||(w(t.$$.fragment,a),w(o.$$.fragment,a),l=!0)},o(a){y(t.$$.fragment,a),y(o.$$.fragment,a),l=!1},d(a){a&&O(e),I(t),I(o)}}}class Aa extends V{constructor(e){super(),K(this,e,null,Oa,J,{})}}function Ca(n){let e,t;return e=new Yt({props:{routes:{"*":Ta}}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function Pa(n){let e,t,r,s;return e=new ks({}),r=new Yt({props:{routes:{"/":ma,"/book/:bookID":Us,"/author/:authorID":Ns,"/publisher/:publisherID":qs,"/search":Ve,"/search/author":Ve,"/search/publisher":Ve,"/add-book":Zo,"/borrow":Aa}}}),{c(){L(e.$$.fragment),t=$(),L(r.$$.fragment)},m(i,o){R(e,i,o),C(i,t,o),R(r,i,o),s=!0},i(i){s||(w(e.$$.fragment,i),w(r.$$.fragment,i),s=!0)},o(i){y(e.$$.fragment,i),y(r.$$.fragment,i),s=!1},d(i){i&&O(t),I(e,i),I(r,i)}}}function Ra(n){let e,t,r,s;return e=new ks({}),r=new Yt({props:{routes:{"/":Lo,"/book/:bookID":Us,"/author/:authorID":Ns,"/publisher/:publisherID":qs,"/search":Ve,"/search/author":Ve,"/search/publisher":Ve}}}),{c(){L(e.$$.fragment),t=$(),L(r.$$.fragment)},m(i,o){R(e,i,o),C(i,t,o),R(r,i,o),s=!0},i(i){s||(w(e.$$.fragment,i),w(r.$$.fragment,i),s=!0)},o(i){y(e.$$.fragment,i),y(r.$$.fragment,i),s=!1},d(i){i&&O(t),I(e,i),I(r,i)}}}function Ia(n){let e,t,r,s;const i=[Ra,Pa,Ca],o=[];function l(a,c){return a[0]=="client"?0:a[0]=="staff"?1:2}return e=l(n),t=o[e]=i[e](n),{c(){t.c(),r=pe()},m(a,c){o[e].m(a,c),C(a,r,c),s=!0},p(a,[c]){let u=e;e=l(a),e!==u&&(W(),y(o[u],1,1,()=>{o[u]=null}),Y(),t=o[e],t||(t=o[e]=i[e](a),t.c()),w(t,1),t.m(r.parentNode,r))},i(a){s||(w(t),s=!0)},o(a){y(t),s=!1},d(a){a&&O(r),o[e].d(a)}}}function La(n,e,t){let r;return We.subscribe(s=>{t(0,r=s)}),[r]}class xa extends V{constructor(e){super(),K(this,e,La,Ia,J,{})}}new xa({target:document.getElementById("app")});
