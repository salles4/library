var ur=Object.defineProperty;var hr=(n,e,t)=>e in n?ur(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var kt=(n,e,t)=>(hr(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();function j(){}const Is=n=>n;function Ze(n,e){for(const t in e)n[t]=e[t];return n}function xs(n){return n()}function Yt(){return Object.create(null)}function Be(n){n.forEach(xs)}function gt(n){return typeof n=="function"}function H(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let ot;function ae(n,e){return n===e?!0:(ot||(ot=document.createElement("a")),ot.href=e,n===ot.href)}function dr(n){return Object.keys(n).length===0}function fr(n,...e){if(n==null){for(const s of e)s(void 0);return j}const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Ls(n,e,t,s){if(n){const r=Ds(n,e,t,s);return n[0](r)}}function Ds(n,e,t,s){return n[1]&&s?Ze(t.ctx.slice(),n[1](s(e))):t.ctx}function Us(n,e,t,s){if(n[2]&&s){const r=n[2](s(t));if(e.dirty===void 0)return r;if(typeof r=="object"){const i=[],o=Math.max(e.dirty.length,r.length);for(let l=0;l<o;l+=1)i[l]=e.dirty[l]|r[l];return i}return e.dirty|r}return e.dirty}function Ns(n,e,t,s,r,i){if(r){const o=Ds(e,t,s,i);n.p(o,r)}}function qs(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let s=0;s<t;s++)e[s]=-1;return e}return-1}const Ms=typeof window<"u";let pr=Ms?()=>window.performance.now():()=>Date.now(),qt=Ms?n=>requestAnimationFrame(n):j;const Ue=new Set;function Fs(n){Ue.forEach(e=>{e.c(n)||(Ue.delete(e),e.f())}),Ue.size!==0&&qt(Fs)}function _r(n){let e;return Ue.size===0&&qt(Fs),{promise:new Promise(t=>{Ue.add(e={c:n,f:t})}),abort(){Ue.delete(e)}}}function f(n,e){n.appendChild(e)}function Bs(n){if(!n)return document;const e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function gr(n){const e=g("style");return e.textContent="/* empty */",mr(Bs(n),e),e.sheet}function mr(n,e){return f(n.head||n,e),e.sheet}function C(n,e,t){n.insertBefore(e,t||null)}function A(n){n.parentNode&&n.parentNode.removeChild(n)}function st(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function g(n){return document.createElement(n)}function B(n){return document.createTextNode(n)}function T(){return B(" ")}function pe(){return B("")}function zs(n,e,t,s){return n.addEventListener(e,t,s),()=>n.removeEventListener(e,t,s)}function d(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function br(n){return Array.from(n.childNodes)}function V(n,e){e=""+e,n.data!==e&&(n.data=e)}function $t(n,e){n.value=e??""}function mt(n,e,t,s){t==null?n.style.removeProperty(e):n.style.setProperty(e,t,"")}function Hs(n,e,{bubbles:t=!1,cancelable:s=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:s})}function ht(n,e){return new n(e)}const dt=new Map;let ft=0;function vr(n){let e=5381,t=n.length;for(;t--;)e=(e<<5)-e^n.charCodeAt(t);return e>>>0}function wr(n,e){const t={stylesheet:gr(e),rules:{}};return dt.set(n,t),t}function yr(n,e,t,s,r,i,o,l=0){const a=16.666/s;let c=`{
`;for(let v=0;v<=1;v+=a){const E=e+(t-e)*i(v);c+=v*100+`%{${o(E,1-E)}}
`}const u=c+`100% {${o(t,1-t)}}
}`,h=`__svelte_${vr(u)}_${l}`,p=Bs(n),{stylesheet:_,rules:m}=dt.get(p)||wr(p,n);m[h]||(m[h]=!0,_.insertRule(`@keyframes ${h} ${u}`,_.cssRules.length));const b=n.style.animation||"";return n.style.animation=`${b?`${b}, `:""}${h} ${s}ms linear ${r}ms 1 both`,ft+=1,h}function Xt(n,e){const t=(n.style.animation||"").split(", "),s=t.filter(e?i=>i.indexOf(e)<0:i=>i.indexOf("__svelte")===-1),r=t.length-s.length;r&&(n.style.animation=s.join(", "),ft-=r,ft||kr())}function kr(){qt(()=>{ft||(dt.forEach(n=>{const{ownerNode:e}=n.stylesheet;e&&A(e)}),dt.clear())})}let et;function We(n){et=n}function bt(){if(!et)throw new Error("Function called outside component initialization");return et}function Mt(n){bt().$$.on_mount.push(n)}function $r(n){bt().$$.after_update.push(n)}function Sr(n){bt().$$.on_destroy.push(n)}function Er(){const n=bt();return(e,t,{cancelable:s=!1}={})=>{const r=n.$$.callbacks[e];if(r){const i=Hs(e,t,{cancelable:s});return r.slice().forEach(o=>{o.call(n,i)}),!i.defaultPrevented}return!0}}function Qt(n,e){const t=n.$$.callbacks[e.type];t&&t.slice().forEach(s=>s.call(this,e))}const Le=[],Zt=[];let Ne=[];const es=[],Js=Promise.resolve();let Rt=!1;function Gs(){Rt||(Rt=!0,Js.then(Vs))}function Ks(){return Gs(),Js}function ce(n){Ne.push(n)}const St=new Set;let Pe=0;function Vs(){if(Pe!==0)return;const n=et;do{try{for(;Pe<Le.length;){const e=Le[Pe];Pe++,We(e),Tr(e.$$)}}catch(e){throw Le.length=0,Pe=0,e}for(We(null),Le.length=0,Pe=0;Zt.length;)Zt.pop()();for(let e=0;e<Ne.length;e+=1){const t=Ne[e];St.has(t)||(St.add(t),t())}Ne.length=0}while(Le.length);for(;es.length;)es.pop()();Rt=!1,St.clear(),We(n)}function Tr(n){if(n.fragment!==null){n.update(),Be(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(ce)}}function Or(n){const e=[],t=[];Ne.forEach(s=>n.indexOf(s)===-1?e.push(s):t.push(s)),t.forEach(s=>s()),Ne=e}let Ge;function jr(){return Ge||(Ge=Promise.resolve(),Ge.then(()=>{Ge=null})),Ge}function ts(n,e,t){n.dispatchEvent(Hs(`intro${t}`))}const ut=new Set;let Te;function W(){Te={r:0,c:[],p:Te}}function Y(){Te.r||Be(Te.c),Te=Te.p}function k(n,e){n&&n.i&&(ut.delete(n),n.i(e))}function $(n,e,t,s){if(n&&n.o){if(ut.has(n))return;ut.add(n),Te.c.push(()=>{ut.delete(n),s&&(t&&n.d(1),s())}),n.o(e)}else s&&s()}const Ar={duration:0};function rt(n,e,t){const s={direction:"in"};let r=e(n,t,s),i=!1,o,l,a=0;function c(){o&&Xt(n,o)}function u(){const{delay:p=0,duration:_=300,easing:m=Is,tick:b=j,css:v}=r||Ar;v&&(o=yr(n,0,1,_,p,m,v,a++)),b(0,1);const E=pr()+p,P=E+_;l&&l.abort(),i=!0,ce(()=>ts(n,!0,"start")),l=_r(S=>{if(i){if(S>=P)return b(1,0),ts(n,!0,"end"),c(),i=!1;if(S>=E){const w=m((S-E)/_);b(w,1-w)}}return i})}let h=!1;return{start(){h||(h=!0,Xt(n),gt(r)?(r=r(s),jr().then(u)):u())},invalidate(){h=!1},end(){i&&(c(),i=!1)}}}function le(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function pt(n,e){const t={},s={},r={$$scope:1};let i=n.length;for(;i--;){const o=n[i],l=e[i];if(l){for(const a in o)a in l||(s[a]=1);for(const a in l)r[a]||(t[a]=l[a],r[a]=1);n[i]=l}else for(const a in o)r[a]=1}for(const o in s)o in t||(t[o]=void 0);return t}function _t(n){return typeof n=="object"&&n!==null?n:{}}function x(n){n&&n.c()}function R(n,e,t){const{fragment:s,after_update:r}=n.$$;s&&s.m(e,t),ce(()=>{const i=n.$$.on_mount.map(xs).filter(gt);n.$$.on_destroy?n.$$.on_destroy.push(...i):Be(i),n.$$.on_mount=[]}),r.forEach(ce)}function I(n,e){const t=n.$$;t.fragment!==null&&(Or(t.after_update),Be(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Pr(n,e){n.$$.dirty[0]===-1&&(Le.push(n),Gs(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function J(n,e,t,s,r,i,o=null,l=[-1]){const a=et;We(n);const c=n.$$={fragment:null,ctx:[],props:i,update:j,not_equal:r,bound:Yt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:Yt(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};o&&o(c.root);let u=!1;if(c.ctx=t?t(n,e.props||{},(h,p,..._)=>{const m=_.length?_[0]:p;return c.ctx&&r(c.ctx[h],c.ctx[h]=m)&&(!c.skip_bound&&c.bound[h]&&c.bound[h](m),u&&Pr(n,h)),p}):[],c.update(),u=!0,Be(c.before_update),c.fragment=s?s(c.ctx):!1,e.target){if(e.hydrate){const h=br(e.target);c.fragment&&c.fragment.l(h),h.forEach(A)}else c.fragment&&c.fragment.c();e.intro&&k(n.$$.fragment),R(n,e.target,e.anchor),Vs()}We(a)}class G{constructor(){kt(this,"$$");kt(this,"$$set")}$destroy(){I(this,1),this.$destroy=j}$on(e,t){if(!gt(t))return j;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(t),()=>{const r=s.indexOf(t);r!==-1&&s.splice(r,1)}}$set(e){this.$$set&&!dr(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Cr="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Cr);const Ce=[];function Ws(n,e){return{subscribe:Ys(n,e).subscribe}}function Ys(n,e=j){let t;const s=new Set;function r(l){if(H(n,l)&&(n=l,t)){const a=!Ce.length;for(const c of s)c[1](),Ce.push(c,n);if(a){for(let c=0;c<Ce.length;c+=2)Ce[c][0](Ce[c+1]);Ce.length=0}}}function i(l){r(l(n))}function o(l,a=j){const c=[l,a];return s.add(c),s.size===1&&(t=e(r,i)||j),l(n),()=>{s.delete(c),s.size===0&&t&&(t(),t=null)}}return{set:r,update:i,subscribe:o}}function Xs(n,e,t){const s=!Array.isArray(n),r=s?[n]:n;if(!r.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const i=e.length<2;return Ws(t,(o,l)=>{let a=!1;const c=[];let u=0,h=j;const p=()=>{if(u)return;h();const m=e(s?c[0]:c,o,l);i?o(m):h=gt(m)?m:j},_=r.map((m,b)=>fr(m,v=>{c[b]=v,u&=~(1<<b),a&&p()},()=>{u|=1<<b}));return a=!0,p(),function(){Be(_),h(),a=!1}})}function Rr(n,e){if(n instanceof RegExp)return{keys:!1,pattern:n};var t,s,r,i,o=[],l="",a=n.split("/");for(a[0]||a.shift();r=a.shift();)t=r[0],t==="*"?(o.push("wild"),l+="/(.*)"):t===":"?(s=r.indexOf("?",1),i=r.indexOf(".",1),o.push(r.substring(1,~s?s:~i?i:r.length)),l+=~s&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(l+=(~s?"?":"")+"\\"+r.substring(i))):l+="/"+r;return{keys:o,pattern:new RegExp("^"+l+"/?$","i")}}function Ir(n){let e,t,s;const r=[n[2]];var i=n[0];function o(l,a){let c={};for(let u=0;u<r.length;u+=1)c=Ze(c,r[u]);return a!==void 0&&a&4&&(c=Ze(c,pt(r,[_t(l[2])]))),{props:c}}return i&&(e=ht(i,o(n)),e.$on("routeEvent",n[7])),{c(){e&&x(e.$$.fragment),t=pe()},m(l,a){e&&R(e,l,a),C(l,t,a),s=!0},p(l,a){if(a&1&&i!==(i=l[0])){if(e){W();const c=e;$(c.$$.fragment,1,0,()=>{I(c,1)}),Y()}i?(e=ht(i,o(l,a)),e.$on("routeEvent",l[7]),x(e.$$.fragment),k(e.$$.fragment,1),R(e,t.parentNode,t)):e=null}else if(i){const c=a&4?pt(r,[_t(l[2])]):{};e.$set(c)}},i(l){s||(e&&k(e.$$.fragment,l),s=!0)},o(l){e&&$(e.$$.fragment,l),s=!1},d(l){l&&A(t),e&&I(e,l)}}}function xr(n){let e,t,s;const r=[{params:n[1]},n[2]];var i=n[0];function o(l,a){let c={};for(let u=0;u<r.length;u+=1)c=Ze(c,r[u]);return a!==void 0&&a&6&&(c=Ze(c,pt(r,[a&2&&{params:l[1]},a&4&&_t(l[2])]))),{props:c}}return i&&(e=ht(i,o(n)),e.$on("routeEvent",n[6])),{c(){e&&x(e.$$.fragment),t=pe()},m(l,a){e&&R(e,l,a),C(l,t,a),s=!0},p(l,a){if(a&1&&i!==(i=l[0])){if(e){W();const c=e;$(c.$$.fragment,1,0,()=>{I(c,1)}),Y()}i?(e=ht(i,o(l,a)),e.$on("routeEvent",l[6]),x(e.$$.fragment),k(e.$$.fragment,1),R(e,t.parentNode,t)):e=null}else if(i){const c=a&6?pt(r,[a&2&&{params:l[1]},a&4&&_t(l[2])]):{};e.$set(c)}},i(l){s||(e&&k(e.$$.fragment,l),s=!0)},o(l){e&&$(e.$$.fragment,l),s=!1},d(l){l&&A(t),e&&I(e,l)}}}function Lr(n){let e,t,s,r;const i=[xr,Ir],o=[];function l(a,c){return a[1]?0:1}return e=l(n),t=o[e]=i[e](n),{c(){t.c(),s=pe()},m(a,c){o[e].m(a,c),C(a,s,c),r=!0},p(a,[c]){let u=e;e=l(a),e===u?o[e].p(a,c):(W(),$(o[u],1,1,()=>{o[u]=null}),Y(),t=o[e],t?t.p(a,c):(t=o[e]=i[e](a),t.c()),k(t,1),t.m(s.parentNode,s))},i(a){r||(k(t),r=!0)},o(a){$(t),r=!1},d(a){a&&A(s),o[e].d(a)}}}function ss(){const n=window.location.href.indexOf("#/");let e=n>-1?window.location.href.substr(n+1):"/";const t=e.indexOf("?");let s="";return t>-1&&(s=e.substr(t+1),e=e.substr(0,t)),{location:e,querystring:s}}const Ft=Ws(null,function(e){e(ss());const t=()=>{e(ss())};return window.addEventListener("hashchange",t,!1),function(){window.removeEventListener("hashchange",t,!1)}});Xs(Ft,n=>n.location);Xs(Ft,n=>n.querystring);const rs=Ys(void 0);async function Dr(){await Ks(),window.history.back()}function Ur(n){n?window.scrollTo(n.__svelte_spa_router_scrollX,n.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function Nr(n,e,t){let{routes:s={}}=e,{prefix:r=""}=e,{restoreScrollState:i=!1}=e;class o{constructor(y,O){if(!O||typeof O!="function"&&(typeof O!="object"||O._sveltesparouter!==!0))throw Error("Invalid component object");if(!y||typeof y=="string"&&(y.length<1||y.charAt(0)!="/"&&y.charAt(0)!="*")||typeof y=="object"&&!(y instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:q,keys:N}=Rr(y);this.path=y,typeof O=="object"&&O._sveltesparouter===!0?(this.component=O.component,this.conditions=O.conditions||[],this.userData=O.userData,this.props=O.props||{}):(this.component=()=>Promise.resolve(O),this.conditions=[],this.props={}),this._pattern=q,this._keys=N}match(y){if(r){if(typeof r=="string")if(y.startsWith(r))y=y.substr(r.length)||"/";else return null;else if(r instanceof RegExp){const z=y.match(r);if(z&&z[0])y=y.substr(z[0].length)||"/";else return null}}const O=this._pattern.exec(y);if(O===null)return null;if(this._keys===!1)return O;const q={};let N=0;for(;N<this._keys.length;){try{q[this._keys[N]]=decodeURIComponent(O[N+1]||"")||null}catch{q[this._keys[N]]=null}N++}return q}async checkConditions(y){for(let O=0;O<this.conditions.length;O++)if(!await this.conditions[O](y))return!1;return!0}}const l=[];s instanceof Map?s.forEach((w,y)=>{l.push(new o(y,w))}):Object.keys(s).forEach(w=>{l.push(new o(w,s[w]))});let a=null,c=null,u={};const h=Er();async function p(w,y){await Ks(),h(w,y)}let _=null,m=null;i&&(m=w=>{w.state&&(w.state.__svelte_spa_router_scrollY||w.state.__svelte_spa_router_scrollX)?_=w.state:_=null},window.addEventListener("popstate",m),$r(()=>{Ur(_)}));let b=null,v=null;const E=Ft.subscribe(async w=>{b=w;let y=0;for(;y<l.length;){const O=l[y].match(w.location);if(!O){y++;continue}const q={route:l[y].path,location:w.location,querystring:w.querystring,userData:l[y].userData,params:O&&typeof O=="object"&&Object.keys(O).length?O:null};if(!await l[y].checkConditions(q)){t(0,a=null),v=null,p("conditionsFailed",q);return}p("routeLoading",Object.assign({},q));const N=l[y].component;if(v!=N){N.loading?(t(0,a=N.loading),v=N,t(1,c=N.loadingParams),t(2,u={}),p("routeLoaded",Object.assign({},q,{component:a,name:a.name,params:c}))):(t(0,a=null),v=null);const z=await N();if(w!=b)return;t(0,a=z&&z.default||z),v=N}O&&typeof O=="object"&&Object.keys(O).length?t(1,c=O):t(1,c=null),t(2,u=l[y].props),p("routeLoaded",Object.assign({},q,{component:a,name:a.name,params:c})).then(()=>{rs.set(c)});return}t(0,a=null),v=null,rs.set(void 0)});Sr(()=>{E(),m&&window.removeEventListener("popstate",m)});function P(w){Qt.call(this,n,w)}function S(w){Qt.call(this,n,w)}return n.$$set=w=>{"routes"in w&&t(3,s=w.routes),"prefix"in w&&t(4,r=w.prefix),"restoreScrollState"in w&&t(5,i=w.restoreScrollState)},n.$$.update=()=>{n.$$.dirty&32&&(history.scrollRestoration=i?"manual":"auto")},[a,c,u,s,r,i,P,S]}class qr extends G{constructor(e){super(),J(this,e,Nr,Lr,H,{routes:3,prefix:4,restoreScrollState:5})}}function Mr(n){let e,t,s,r,i,o,l,a,c,u,h,p,_,m,b,v,E,P,S,w,y,O,q;return{c(){e=g("nav"),t=g("div"),s=g("a"),s.innerHTML=`<i class="bi bi-book"></i> 
      Library System
      <small class="fs-6 text-white-50 ms-2 d-sm-inline d-none">CTADVDBL Project</small>`,r=T(),i=g("button"),i.innerHTML='<span class="navbar-toggler-icon"></span>',o=T(),l=g("div"),a=g("div"),c=g("a"),c.textContent="All Books",u=T(),h=g("a"),h.textContent="Authors",p=T(),_=g("a"),_.textContent="Publishers",m=T(),b=g("a"),b.textContent="Add book",v=T(),E=g("li"),E.innerHTML='<a class="nav-link dropdown-toggle svelte-oup04o" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-person-fill"></i> Salles</a> <ul class="dropdown-menu"><li><a class="dropdown-item disabled svelte-oup04o" href="#">Profile</a></li> <li><a class="dropdown-item disabled svelte-oup04o" href="#">Settings</a></li> <li><hr class="dropdown-divider"/></li> <li><a class="dropdown-item text-danger disabled svelte-oup04o" href="#">Log Out</a></li></ul>',P=T(),S=g("button"),w=g("span"),d(s,"class","navbar-brand m-0 svelte-oup04o"),d(s,"href","./#/"),d(i,"class","navbar-toggler"),d(i,"type","button"),d(i,"data-bs-toggle","collapse"),d(i,"data-bs-target","#navbarContent"),d(c,"class","nav-link disabled svelte-oup04o"),d(c,"href","#"),d(h,"class","nav-link disabled svelte-oup04o"),d(h,"href","#"),d(_,"class","nav-link disabled svelte-oup04o"),d(_,"href","#"),d(b,"class","nav-link svelte-oup04o"),d(b,"href","./#/add-book"),d(E,"class","nav-item dropdown"),d(w,"class",y="bi bi-"+n[0]+" svelte-oup04o"),d(S,"title","Switch theme"),d(S,"class","px-1 border-0 bg-transparent nav-link svelte-oup04o"),d(a,"class","navbar-nav ms-auto svelte-oup04o"),d(l,"class","collapse navbar-collapse"),d(l,"id","navbarContent"),d(t,"class","container px-4 fw-semibold"),d(e,"class","navbar navbar-expand-lg bg-primary bg-gradient shadow")},m(N,z){C(N,e,z),f(e,t),f(t,s),f(t,r),f(t,i),f(t,o),f(t,l),f(l,a),f(a,c),f(a,u),f(a,h),f(a,p),f(a,_),f(a,m),f(a,b),f(a,v),f(a,E),f(a,P),f(a,S),f(S,w),O||(q=zs(S,"click",n[1]),O=!0)},p(N,[z]){z&1&&y!==(y="bi bi-"+N[0]+" svelte-oup04o")&&d(w,"class",y)},i:j,o:j,d(N){N&&A(e),O=!1,q()}}}function Fr(n,e,t){let s,r=localStorage.getItem("theme")||"light";function i(){t(2,r=r=="light"?"dark":"light"),localStorage.setItem("theme",r)}return n.$$.update=()=>{n.$$.dirty&4&&document.querySelector("body").setAttribute("data-bs-theme",r),n.$$.dirty&4&&t(0,s=r=="dark"?"moon-stars-fill":"brightness-high-fill")},[s,i,r]}class Br extends G{constructor(e){super(),J(this,e,Fr,Mr,H,{})}}function zr(n){let e,t,s,r,i,o,l,a,c,u,h,p,_,m,b,v,E,P;return{c(){e=g("section"),t=g("div"),s=g("div"),r=g("div"),i=g("img"),l=T(),a=g("div"),c=g("img"),h=T(),p=g("div"),_=g("img"),b=T(),v=g("button"),v.innerHTML='<span class="carousel-control-prev-icon"></span>',E=T(),P=g("button"),P.innerHTML='<span class="carousel-control-next-icon"></span>',ae(i.src,o=Et)||d(i,"src",o),d(i,"class","d-block w-100"),d(i,"alt","..."),d(r,"class","carousel-item active"),ae(c.src,u=Et)||d(c,"src",u),d(c,"class","d-block w-100"),d(c,"alt","..."),d(a,"class","carousel-item"),ae(_.src,m=Et)||d(_,"src",m),d(_,"class","d-block w-100"),d(_,"alt","..."),d(p,"class","carousel-item"),d(s,"class","carousel-inner"),d(v,"class","carousel-control-prev"),d(v,"type","button"),d(v,"data-bs-target","#homeAdCarousel"),d(v,"data-bs-slide","prev"),d(P,"class","carousel-control-next"),d(P,"type","button"),d(P,"data-bs-target","#homeAdCarousel"),d(P,"data-bs-slide","next"),d(t,"id","homeAdCarousel"),d(t,"class","carousel slide"),d(t,"data-bs-ride","carousel"),d(t,"data-bs-interval","8000")},m(S,w){C(S,e,w),f(e,t),f(t,s),f(s,r),f(r,i),f(s,l),f(s,a),f(a,c),f(s,h),f(s,p),f(p,_),f(t,b),f(t,v),f(t,E),f(t,P)},p:j,i:j,o:j,d(S){S&&A(e)}}}let Et="./cover.jpg";class Hr extends G{constructor(e){super(),J(this,e,null,zr,H,{})}}function Jr(n){let e,t,s,r,i,o,l,a,c,u,h,p,_,m;return{c(){e=g("div"),t=g("img"),r=T(),i=g("div"),o=g("h5"),l=g("a"),a=B(n[1]),u=T(),h=g("small"),p=g("i"),_=T(),m=B(n[2]),ae(t.src,s="./"+n[0]+".jpg")||d(t,"src",s),d(t,"alt","book cover"),d(t,"class","svelte-1a99e4f"),d(l,"class","stretched-link svelte-1a99e4f"),d(l,"href",c="./#/book/"+n[0]),d(o,"class","card-title"),d(p,"class","bi bi-person"),d(h,"class","card-text"),d(i,"class","card-body"),d(e,"class","card col-md-3 col-6 svelte-1a99e4f")},m(b,v){C(b,e,v),f(e,t),f(e,r),f(e,i),f(i,o),f(o,l),f(l,a),f(i,u),f(i,h),f(h,p),f(h,_),f(h,m)},p(b,[v]){v&1&&!ae(t.src,s="./"+b[0]+".jpg")&&d(t,"src",s),v&2&&V(a,b[1]),v&1&&c!==(c="./#/book/"+b[0])&&d(l,"href",c),v&4&&V(m,b[2])},i:j,o:j,d(b){b&&A(e)}}}function Gr(n,e,t){let{id:s=0}=e,{title:r}=e,{author:i}=e;return n.$$set=o=>{"id"in o&&t(0,s=o.id),"title"in o&&t(1,r=o.title),"author"in o&&t(2,i=o.author)},[s,r,i]}class Bt extends G{constructor(e){super(),J(this,e,Gr,Jr,H,{id:0,title:1,author:2})}}function ns(n){let e;return{c(){e=g("div"),e.innerHTML='<button class="btn btn-outline-primary btn-sm">See All <i class="bi bi-arrow-right"></i></button>',d(e,"class","align-middle align-self-center")},m(t,s){C(t,e,s)},d(t){t&&A(e)}}}function Kr(n){let e,t,s,r,i,o,l,a,c,u,h=n[2]!==""&&ns();const p=n[4].default,_=Ls(p,n,n[3],null);return{c(){e=g("section"),t=g("div"),s=g("h4"),r=g("i"),o=T(),l=B(n[0]),a=T(),h&&h.c(),c=T(),_&&_.c(),d(r,"class",i="bi bi-"+n[1]),d(s,"class","my-3"),d(t,"class","border-bottom border-2 d-flex justify-content-between mb-2")},m(m,b){C(m,e,b),f(e,t),f(t,s),f(s,r),f(s,o),f(s,l),f(t,a),h&&h.m(t,null),f(e,c),_&&_.m(e,null),u=!0},p(m,[b]){(!u||b&2&&i!==(i="bi bi-"+m[1]))&&d(r,"class",i),(!u||b&1)&&V(l,m[0]),m[2]!==""?h||(h=ns(),h.c(),h.m(t,null)):h&&(h.d(1),h=null),_&&_.p&&(!u||b&8)&&Ns(_,p,m,m[3],u?Us(p,m[3],b,null):qs(m[3]),null)},i(m){u||(k(_,m),u=!0)},o(m){$(_,m),u=!1},d(m){m&&A(e),h&&h.d(),_&&_.d(m)}}}function Vr(n,e,t){let{$$slots:s={},$$scope:r}=e,{title:i}=e,{icon:o}=e,{link:l=""}=e;return n.$$set=a=>{"title"in a&&t(0,i=a.title),"icon"in a&&t(1,o=a.icon),"link"in a&&t(2,l=a.link),"$$scope"in a&&t(3,r=a.$$scope)},[i,o,l,r,s]}class Ye extends G{constructor(e){super(),J(this,e,Vr,Kr,H,{title:0,icon:1,link:2})}}const Wr="modulepreload",Yr=function(n){return"/library-proj/"+n},is={},Me=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));r=Promise.all(t.map(l=>{if(l=Yr(l),l in is)return;is[l]=!0;const a=l.endsWith(".css"),c=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":Wr,a||(u.as="script",u.crossOrigin=""),u.href=l,o&&u.setAttribute("nonce",o),document.head.appendChild(u),a)return new Promise((h,p)=>{u.addEventListener("load",h),u.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}return r.then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},Xr=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Me(()=>Promise.resolve().then(()=>nt),void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class zt extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class Qr extends zt{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Zr extends zt{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class en extends zt{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var It;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(It||(It={}));var tn=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{c(s.next(u))}catch(h){o(h)}}function a(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):r(u.value).then(l,a)}c((s=s.apply(n,e||[])).next())})};class sn{constructor(e,{headers:t={},customFetch:s,region:r=It.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=Xr(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return tn(this,void 0,void 0,function*(){try{const{headers:r,method:i,body:o}=t;let l={},{region:a}=t;a||(a=this.region),a&&a!=="any"&&(l["x-region"]=a);let c;o&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",c=o):typeof o=="string"?(l["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(l["Content-Type"]="application/json",c=JSON.stringify(o)));const u=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),r),body:c}).catch(m=>{throw new Qr(m)}),h=u.headers.get("x-relay-error");if(h&&h==="true")throw new Zr(u);if(!u.ok)throw new en(u);let p=((s=u.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),_;return p==="application/json"?_=yield u.json():p==="application/octet-stream"?_=yield u.blob():p==="text/event-stream"?_=u:p==="multipart/form-data"?_=yield u.formData():_=yield u.text(),{data:_,error:null}}catch(r){return{data:null,error:r}}})}}var rn=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Fe=rn();const nn=Fe.fetch,Ht=Fe.fetch.bind(Fe),Qs=Fe.Headers,on=Fe.Request,an=Fe.Response,nt=Object.freeze(Object.defineProperty({__proto__:null,Headers:Qs,Request:on,Response:an,default:Ht,fetch:nn},Symbol.toStringTag,{value:"Module"}));class ln extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}class cn{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Ht:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const s=this.fetch;let r=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,l,a;let c=null,u=null,h=null,p=i.status,_=i.statusText;if(i.ok){if(this.method!=="HEAD"){const E=await i.text();E===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=E:u=JSON.parse(E))}const b=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),v=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");b&&v&&v.length>1&&(h=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,p=406,_="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const b=await i.text();try{c=JSON.parse(b),Array.isArray(c)&&i.status===404&&(u=[],c=null,p=200,_="OK")}catch{i.status===404&&b===""?(p=204,_="No Content"):c={message:b}}if(c&&this.isMaybeSingle&&(!((a=c==null?void 0:c.details)===null||a===void 0)&&a.includes("0 rows"))&&(c=null,p=200,_="OK"),c&&this.shouldThrowOnError)throw new ln(c)}return{error:c,data:u,count:h,status:p,statusText:_}});return this.shouldThrowOnError||(r=r.catch(i=>{var o,l,a;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(a=i==null?void 0:i.code)!==null&&a!==void 0?a:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}}class un extends cn{select(e){let t=!1;const s=(e??"*").split("").map(r=>/\s/.test(r)&&!t?"":(r==='"'&&(t=!t),r)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:r,referencedTable:i=r}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const r=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:r=s}={}){const i=typeof r>"u"?"offset":`${r}.offset`,o=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:r=!1,wal:i=!1,format:o="text"}={}){var l;const a=[e?"analyze":null,t?"verbose":null,s?"settings":null,r?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${c}"; options=${a};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class De extends un{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(r=>typeof r=="string"&&new RegExp("[,()]").test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:r}={}){let i="";r==="plain"?i="pl":r==="phrase"?i="ph":r==="websearch"&&(i="w");const o=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${i}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,s])=>{this.url.searchParams.append(t,`eq.${s}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const r=s?`${s}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}}class hn{constructor(e,{headers:t={},schema:s,fetch:r}){this.url=e,this.headers=t,this.schema=s,this.fetch=r}select(e,{head:t=!1,count:s}={}){const r=t?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),s&&(this.headers.Prefer=`count=${s}`),new De({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:s=!0}={}){const r="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),s||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const o=e.reduce((l,a)=>l.concat(Object.keys(a)),[]);if(o.length>0){const l=[...new Set(o)].map(a=>`"${a}"`);this.url.searchParams.set("columns",l.join(","))}}return new De({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:r,defaultToNull:i=!0}={}){const o="POST",l=[`resolution=${s?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&l.push(this.headers.Prefer),r&&l.push(`count=${r}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const a=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(a.length>0){const c=[...new Set(a)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new De({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const s="PATCH",r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),this.headers.Prefer=r.join(","),new De({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",s=[];return e&&s.push(`count=${e}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new De({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const dn="1.15.2",fn={"X-Client-Info":`postgrest-js/${dn}`};class Jt{constructor(e,{headers:t={},schema:s,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},fn),t),this.schemaName=s,this.fetch=r}from(e){const t=new URL(`${this.url}/${e}`);return new hn(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Jt(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:r=!1,count:i}={}){let o;const l=new URL(`${this.url}/rpc/${e}`);let a;s||r?(o=s?"HEAD":"GET",Object.entries(t).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{l.searchParams.append(u,h)})):(o="POST",a=t);const c=Object.assign({},this.headers);return i&&(c.Prefer=`count=${i}`),new De({method:o,url:l,headers:c,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}}const pn="2.9.5",_n={"X-Client-Info":`realtime-js/${pn}`},gn="1.0.0",Zs=1e4,mn=1e3;var qe;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(qe||(qe={}));var Q;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Q||(Q={}));var ie;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(ie||(ie={}));var xt;(function(n){n.websocket="websocket"})(xt||(xt={}));var Ee;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Ee||(Ee={}));class er{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class bn{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const r=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const l=s.decode(e.slice(o,o+r));o=o+r;const a=s.decode(e.slice(o,o+i));o=o+i;const c=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:a,payload:c}}}class Tt{constructor(e,t,s={},r=Zs){this.channel=e,this.event=t,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var os;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(os||(os={}));class Xe{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},r=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Xe.syncState(this.state,r,i,o),this.pendingDiffs.forEach(a=>{this.state=Xe.syncDiff(this.state,a,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},r=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=Xe.syncDiff(this.state,r,i,o),l())}),this.onJoin((r,i,o)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:i,newPresences:o})}),this.onLeave((r,i,o)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,r){const i=this.cloneDeep(e),o=this.transformState(t),l={},a={};return this.map(i,(c,u)=>{o[c]||(a[c]=u)}),this.map(o,(c,u)=>{const h=i[c];if(h){const p=u.map(v=>v.presence_ref),_=h.map(v=>v.presence_ref),m=u.filter(v=>_.indexOf(v.presence_ref)<0),b=h.filter(v=>p.indexOf(v.presence_ref)<0);m.length>0&&(l[c]=m),b.length>0&&(a[c]=b)}else l[c]=u}),this.syncDiff(i,{joins:l,leaves:a},s,r)}static syncDiff(e,t,s,r){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(i,(l,a)=>{var c;const u=(c=e[l])!==null&&c!==void 0?c:[];if(e[l]=this.cloneDeep(a),u.length>0){const h=e[l].map(_=>_.presence_ref),p=u.filter(_=>h.indexOf(_.presence_ref)<0);e[l].unshift(...p)}s(l,u,a)}),this.map(o,(l,a)=>{let c=e[l];if(!c)return;const u=a.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[l]=c,r(l,c,a),c.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const r=e[s];return"metas"in r?t[s]=r.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[s]=r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var M;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(M||(M={}));const as=(n,e,t={})=>{var s;const r=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,o)=>(i[o]=vn(o,n,e,r),i),{})},vn=(n,e,t,s)=>{const r=e.find(l=>l.name===n),i=r==null?void 0:r.type,o=t[n];return i&&!s.includes(i)?tr(i,o):Lt(o)},tr=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return $n(e,t)}switch(n){case M.bool:return wn(e);case M.float4:case M.float8:case M.int2:case M.int4:case M.int8:case M.numeric:case M.oid:return yn(e);case M.json:case M.jsonb:return kn(e);case M.timestamp:return Sn(e);case M.abstime:case M.date:case M.daterange:case M.int4range:case M.int8range:case M.money:case M.reltime:case M.text:case M.time:case M.timestamptz:case M.timetz:case M.tsrange:case M.tstzrange:return Lt(e);default:return Lt(e)}},Lt=n=>n,wn=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},yn=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},kn=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},$n=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,s=n[t];if(n[0]==="{"&&s==="}"){let i;const o=n.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>tr(e,l))}return n},Sn=n=>typeof n=="string"?n.replace(" ","T"):n;var ls;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(ls||(ls={}));var cs;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes"})(cs||(cs={}));var us;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(us||(us={}));class Gt{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=Q.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},t.config),this.timeout=this.socket.timeout,this.joinPush=new Tt(this,ie.join,this.params,this.timeout),this.rejoinTimer=new er(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Q.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Q.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=Q.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Q.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ie.reply,{},(r,i)=>{this._trigger(this._replyEventName(i),r)}),this.presence=new Xe(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(e,t=this.timeout){var s,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:o}}=this.params;this._onError(c=>e&&e("CHANNEL_ERROR",c)),this._onClose(()=>e&&e("CLOSED"));const l={},a={broadcast:i,presence:o,postgres_changes:(r=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(c=>c.filter))!==null&&r!==void 0?r:[]};this.socket.accessToken&&(l.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:a},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",({postgres_changes:c})=>{var u;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),c===void 0){e&&e("SUBSCRIBED");return}else{const h=this.bindings.postgres_changes,p=(u=h==null?void 0:h.length)!==null&&u!==void 0?u:0,_=[];for(let m=0;m<p;m++){const b=h[m],{filter:{event:v,schema:E,table:P,filter:S}}=b,w=c&&c[m];if(w&&w.event===v&&w.schema===E&&w.table===P&&w.filter===S)_.push(Object.assign(Object.assign({},b),{id:w.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=_,e&&e("SUBSCRIBED");return}}).receive("error",c=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,r;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,l={method:"POST",headers:{apikey:(s=this.socket.apiKey)!==null&&s!==void 0?s:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o}]})};try{return(await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=t.timeout)!==null&&r!==void 0?r:this.timeout)).ok?"ok":"error"}catch(a){return a.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,a;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((a=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||a===void 0)&&a.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Q.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ie.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(s=>{const r=new Tt(this,ie.leave,{},e);r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})})}_broadcastEndpointURL(){let e=this.socket.endPoint;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(e,t,s){const r=new AbortController,i=setTimeout(()=>r.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(i),o}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Tt(this,e,t,s);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var r,i;const o=e.toLocaleLowerCase(),{close:l,error:a,leave:c,join:u}=ie;if(s&&[l,a,c,u].indexOf(o)>=0&&s!==this._joinRef())return;let p=this._onMessage(o,t,s);if(t&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(_=>{var m,b,v;return((m=_.filter)===null||m===void 0?void 0:m.event)==="*"||((v=(b=_.filter)===null||b===void 0?void 0:b.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===o}).map(_=>_.callback(p,s)):(i=this.bindings[o])===null||i===void 0||i.filter(_=>{var m,b,v,E,P,S;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in _){const w=_.id,y=(m=_.filter)===null||m===void 0?void 0:m.event;return w&&((b=t.ids)===null||b===void 0?void 0:b.includes(w))&&(y==="*"||(y==null?void 0:y.toLocaleLowerCase())===((v=t.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const w=(P=(E=_==null?void 0:_.filter)===null||E===void 0?void 0:E.event)===null||P===void 0?void 0:P.toLocaleLowerCase();return w==="*"||w===((S=t==null?void 0:t.event)===null||S===void 0?void 0:S.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===o}).map(_=>{if(typeof p=="object"&&"ids"in p){const m=p.data,{schema:b,table:v,commit_timestamp:E,type:P,errors:S}=m;p=Object.assign(Object.assign({},{schema:b,table:v,commit_timestamp:E,eventType:P,new:{},old:{},errors:S}),this._getPayloadRecords(m))}_.callback(p,s)})}_isClosed(){return this.state===Q.closed}_isJoined(){return this.state===Q.joined}_isJoining(){return this.state===Q.joining}_isLeaving(){return this.state===Q.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const r=e.toLocaleLowerCase(),i={type:r,filter:t,callback:s};return this.bindings[r]?this.bindings[r].push(i):this.bindings[r]=[i],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(r=>{var i;return!(((i=r.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&Gt.isEqual(r.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ie.close,{},e)}_onError(e){this._on(ie.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Q.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=as(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=as(e.columns,e.old_record)),t}}const En=()=>{},Tn=typeof WebSocket<"u";class On{constructor(e,t){var s;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.headers=_n,this.params={},this.timeout=Zs,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=En,this.conn=null,this.sendBuffer=[],this.serializer=new bn,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...l)=>Me(()=>Promise.resolve().then(()=>nt),void 0).then(({default:a})=>a(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${e}/${xt.websocket}`,t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const r=(s=t==null?void 0:t.params)===null||s===void 0?void 0:s.apikey;r&&(this.accessToken=r,this.apiKey=r),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,o)=>o(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new er(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(Tn){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new jn(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),Me(()=>import("./browser-BImCA5dO.js").then(e=>e.b),[]).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case qe.connecting:return Ee.Connecting;case qe.open:return Ee.Open;case qe.closing:return Ee.Closing;default:return Ee.Closed}}isConnected(){return this.connectionState()===Ee.Open}channel(e,t={config:{}}){const s=new Gt(`realtime:${e}`,t,this);return this.channels.push(s),s}push(e){const{topic:t,event:s,payload:r,ref:i}=e,o=()=>{this.encode(e,l=>{var a;(a=this.conn)===null||a===void 0||a.send(l)})};this.log("push",`${t} ${s} (${i})`,r),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(e){this.accessToken=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(ie.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:gn}))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:s,event:r,payload:i,ref:o}=t;(o&&o===this.pendingHeartbeatRef||r===(i==null?void 0:i.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${s} ${r} ${o&&"("+o+")"||""}`,i),this.channels.filter(l=>l._isMember(s)).forEach(l=>l._trigger(r,i,o)),this.stateChangeCallbacks.message.forEach(l=>l(t))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(ie.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return`${e}${s}${r}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(mn,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class jn{constructor(e,t,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=qe.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class Kt extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function K(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class An extends Kt{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class hs extends Kt{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Pn=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{c(s.next(u))}catch(h){o(h)}}function a(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):r(u.value).then(l,a)}c((s=s.apply(n,e||[])).next())})};const sr=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Me(()=>Promise.resolve().then(()=>nt),void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},Cn=()=>Pn(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Me(()=>Promise.resolve().then(()=>nt),void 0)).Response:Response});var ze=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{c(s.next(u))}catch(h){o(h)}}function a(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):r(u.value).then(l,a)}c((s=s.apply(n,e||[])).next())})};const Ot=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Rn=(n,e)=>ze(void 0,void 0,void 0,function*(){const t=yield Cn();n instanceof t?n.json().then(s=>{e(new An(Ot(s),n.status||500))}).catch(s=>{e(new hs(Ot(s),s))}):e(new hs(Ot(n),n))}),In=(n,e,t,s)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(s),Object.assign(Object.assign({},r),t))};function vt(n,e,t,s,r,i){return ze(this,void 0,void 0,function*(){return new Promise((o,l)=>{n(t,In(e,s,r,i)).then(a=>{if(!a.ok)throw a;return s!=null&&s.noResolveJson?a:a.json()}).then(a=>o(a)).catch(a=>Rn(a,l))})})}function Dt(n,e,t,s){return ze(this,void 0,void 0,function*(){return vt(n,"GET",e,t,s)})}function he(n,e,t,s,r){return ze(this,void 0,void 0,function*(){return vt(n,"POST",e,s,r,t)})}function xn(n,e,t,s,r){return ze(this,void 0,void 0,function*(){return vt(n,"PUT",e,s,r,t)})}function rr(n,e,t,s,r){return ze(this,void 0,void 0,function*(){return vt(n,"DELETE",e,s,r,t)})}var te=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{c(s.next(u))}catch(h){o(h)}}function a(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):r(u.value).then(l,a)}c((s=s.apply(n,e||[])).next())})};const Ln={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ds={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Dn{constructor(e,t={},s,r){this.url=e,this.headers=t,this.bucketId=s,this.fetch=sr(r)}uploadOrUpdate(e,t,s,r){return te(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},ds),r),l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",o.cacheControl)):(i=s,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType);const a=this._removeEmptyFolders(t),c=this._getFinalPath(a),u=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:i,headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{})),h=yield u.json();return u.ok?{data:{path:a,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(i){if(K(i))return{data:null,error:i};throw i}})}upload(e,t,s){return te(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,r){return te(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let a;const c=Object.assign({upsert:ds.upsert},r),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&s instanceof Blob?(a=new FormData,a.append("cacheControl",c.cacheControl),a.append("",s)):typeof FormData<"u"&&s instanceof FormData?(a=s,a.append("cacheControl",c.cacheControl)):(a=s,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield this.fetch(l.toString(),{method:"PUT",body:a,headers:u}),p=yield h.json();return h.ok?{data:{path:i,fullPath:p.Key},error:null}:{data:null,error:p}}catch(a){if(K(a))return{data:null,error:a};throw a}})}createSignedUploadUrl(e){return te(this,void 0,void 0,function*(){try{let t=this._getFinalPath(e);const s=yield he(this.fetch,`${this.url}/object/upload/sign/${t}`,{},{headers:this.headers}),r=new URL(this.url+s.url),i=r.searchParams.get("token");if(!i)throw new Kt("No token returned by API");return{data:{signedUrl:r.toString(),path:e,token:i},error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}})}update(e,t,s){return te(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t){return te(this,void 0,void 0,function*(){try{return{data:yield he(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers}),error:null}}catch(s){if(K(s))return{data:null,error:s};throw s}})}copy(e,t){return te(this,void 0,void 0,function*(){try{return{data:{path:(yield he(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers})).Key},error:null}}catch(s){if(K(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,s){return te(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),i=yield he(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(r){if(K(r))return{data:null,error:r};throw r}})}createSignedUrls(e,t,s){return te(this,void 0,void 0,function*(){try{const r=yield he(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:r.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(r){if(K(r))return{data:null,error:r};throw r}})}download(e,t){return te(this,void 0,void 0,function*(){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield Dt(this.fetch,`${this.url}/${r}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(K(l))return{data:null,error:l};throw l}})}getPublicUrl(e,t){const s=this._getFinalPath(e),r=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&r.push(i);const l=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});a!==""&&r.push(a);let c=r.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${s}${c}`)}}}remove(e){return te(this,void 0,void 0,function*(){try{return{data:yield rr(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}})}list(e,t,s){return te(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},Ln),t),{prefix:e||""});return{data:yield he(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(r){if(K(r))return{data:null,error:r};throw r}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Un="2.5.5",Nn={"X-Client-Info":`storage-js/${Un}`};var Re=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{c(s.next(u))}catch(h){o(h)}}function a(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):r(u.value).then(l,a)}c((s=s.apply(n,e||[])).next())})};class qn{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},Nn),t),this.fetch=sr(s)}listBuckets(){return Re(this,void 0,void 0,function*(){try{return{data:yield Dt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(K(e))return{data:null,error:e};throw e}})}getBucket(e){return Re(this,void 0,void 0,function*(){try{return{data:yield Dt(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Re(this,void 0,void 0,function*(){try{return{data:yield he(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(K(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return Re(this,void 0,void 0,function*(){try{return{data:yield xn(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(K(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Re(this,void 0,void 0,function*(){try{return{data:yield he(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Re(this,void 0,void 0,function*(){try{return{data:yield rr(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}})}}class Mn extends qn{constructor(e,t={},s){super(e,t,s)}from(e){return new Dn(this.url,this.headers,e,this.fetch)}}const Fn="2.43.2";let Ve="";typeof Deno<"u"?Ve="deno":typeof document<"u"?Ve="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ve="react-native":Ve="node";const Bn={"X-Client-Info":`supabase-js-${Ve}/${Fn}`},zn={headers:Bn},Hn={schema:"public"},Jn={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Gn={};var Kn=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{c(s.next(u))}catch(h){o(h)}}function a(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):r(u.value).then(l,a)}c((s=s.apply(n,e||[])).next())})};const Vn=n=>{let e;return n?e=n:typeof fetch>"u"?e=Ht:e=fetch,(...t)=>e(...t)},Wn=()=>typeof Headers>"u"?Qs:Headers,Yn=(n,e,t)=>{const s=Vn(t),r=Wn();return(i,o)=>Kn(void 0,void 0,void 0,function*(){var l;const a=(l=yield e())!==null&&l!==void 0?l:n;let c=new r(o==null?void 0:o.headers);return c.has("apikey")||c.set("apikey",n),c.has("Authorization")||c.set("Authorization",`Bearer ${a}`),s(i,Object.assign(Object.assign({},o),{headers:c}))})};function Xn(n){return n.replace(/\/$/,"")}function Qn(n,e){const{db:t,auth:s,realtime:r,global:i}=n,{db:o,auth:l,realtime:a,global:c}=e;return{db:Object.assign(Object.assign({},o),t),auth:Object.assign(Object.assign({},l),s),realtime:Object.assign(Object.assign({},a),r),global:Object.assign(Object.assign({},c),i)}}const nr="2.64.2",Zn="http://localhost:9999",ei="supabase.auth.token",ti={"X-Client-Info":`gotrue-js/${nr}`},fs=10,Ut="X-Supabase-Api-Version",ir={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function si(n){return Math.round(Date.now()/1e3)+n}function ri(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const ne=()=>typeof document<"u",ye={tested:!1,writable:!1},Qe=()=>{if(!ne())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ye.tested)return ye.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),ye.tested=!0,ye.writable=!0}catch{ye.tested=!0,ye.writable=!1}return ye.writable};function jt(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((r,i)=>{e[i]=r})}catch{}return t.searchParams.forEach((s,r)=>{e[r]=s}),e}const or=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Me(()=>Promise.resolve().then(()=>nt),void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},ni=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",ar=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},at=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},At=async(n,e)=>{await n.removeItem(e)};function ii(n){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",s,r,i,o,l,a,c,u=0;for(n=n.replace("-","+").replace("_","/");u<n.length;)o=e.indexOf(n.charAt(u++)),l=e.indexOf(n.charAt(u++)),a=e.indexOf(n.charAt(u++)),c=e.indexOf(n.charAt(u++)),s=o<<2|l>>4,r=(l&15)<<4|a>>2,i=(a&3)<<6|c,t=t+String.fromCharCode(s),a!=64&&r!=0&&(t=t+String.fromCharCode(r)),c!=64&&i!=0&&(t=t+String.fromCharCode(i));return t}class wt{constructor(){this.promise=new wt.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}wt.promiseConstructor=Promise;function ps(n){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=n.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const s=t[1];return JSON.parse(ii(s))}async function oi(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function ai(n,e){return new Promise((s,r)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await n(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){r(o);return}}})()})}function li(n){return("0"+n.toString(16)).substr(-2)}function ci(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let r="";for(let i=0;i<56;i++)r+=t.charAt(Math.floor(Math.random()*s));return r}return crypto.getRandomValues(e),Array.from(e,li).join("")}async function ui(n){const t=new TextEncoder().encode(n),s=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(s);return Array.from(r).map(i=>String.fromCharCode(i)).join("")}function hi(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function di(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await ui(n);return hi(t)}async function Ie(n,e,t=!1){const s=ci();let r=s;t&&(r+="/PASSWORD_RECOVERY"),await ar(n,`${e}-code-verifier`,r);const i=await di(s);return[i,s===i?"plain":"s256"]}const fi=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function pi(n){const e=n.headers.get(Ut);if(!e||!e.match(fi))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class Vt extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function L(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class _i extends Vt{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function gi(n){return L(n)&&n.name==="AuthApiError"}class lr extends Vt{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Oe extends Vt{constructor(e,t,s,r){super(e,s,r),this.name=t,this.status=s}}class ke extends Oe{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Pt extends Oe{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class lt extends Oe{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ct extends Oe{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class _s extends Oe{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Nt extends Oe{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Ct(n){return L(n)&&n.name==="AuthRetryableFetchError"}class gs extends Oe{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}var mi=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t};const Se=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),bi=[502,503,504];async function ms(n){var e;if(!ni(n))throw new Nt(Se(n),0);if(bi.includes(n.status))throw new Nt(Se(n),n.status);let t;try{t=await n.json()}catch(i){throw new lr(Se(i),i)}let s;const r=pi(n);if(r&&r.getTime()>=ir["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new gs(Se(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[])}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new gs(Se(t),n.status,t.weak_password.reasons);throw new _i(Se(t),n.status||500,s)}const vi=(n,e,t,s)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(s),Object.assign(Object.assign({},r),t))};async function U(n,e,t,s){var r;const i=Object.assign({},s==null?void 0:s.headers);i[Ut]||(i[Ut]=ir["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(r=s==null?void 0:s.query)!==null&&r!==void 0?r:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",a=await wi(n,e,t+l,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(a):{data:Object.assign({},a),error:null}}async function wi(n,e,t,s,r,i){const o=vi(e,s,r,i);let l;try{l=await n(t,Object.assign({},o))}catch(a){throw console.error(a),new Nt(Se(a),0)}if(l.ok||await ms(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(a){await ms(a)}}function ue(n){var e;let t=null;Si(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=si(n.expires_in)));const s=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:s},error:null}}function bs(n){const e=ue(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=n.weak_password),e}function de(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function yi(n){return{data:n,error:null}}function ki(n){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:r,verification_type:i}=n,o=mi(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:s,redirect_to:r,verification_type:i},a=Object.assign({},o);return{data:{properties:l,user:a},error:null}}function $i(n){return n}function Si(n){return n.access_token&&n.refresh_token&&n.expires_in}var Ei=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t};class Ti{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=or(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await U(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(L(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await U(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:de})}catch(s){if(L(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=Ei(e,["options"]),r=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(r.new_email=s==null?void 0:s.newEmail,delete r.newEmail),await U(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:ki,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(L(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await U(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:de})}catch(t){if(L(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,r,i,o,l,a;try{const c={nextPage:null,lastPage:0,total:0},u=await U(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:$i});if(u.error)throw u.error;const h=await u.json(),p=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,_=(a=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&a!==void 0?a:[];return _.length>0&&(_.forEach(m=>{const b=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(m.split(";")[1].split("=")[1]);c[`${v}Page`]=b}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(L(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await U(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:de})}catch(t){if(L(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await U(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:de})}catch(s){if(L(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){try{return await U(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:de})}catch(s){if(L(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){try{const{data:t,error:s}=await U(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:t,error:s}}catch(t){if(L(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await U(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(L(t))return{data:null,error:t};throw t}}}const Oi={getItem:n=>Qe()?globalThis.localStorage.getItem(n):null,setItem:(n,e)=>{Qe()&&globalThis.localStorage.setItem(n,e)},removeItem:n=>{Qe()&&globalThis.localStorage.removeItem(n)}};function vs(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function ji(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const xe={debug:!!(globalThis&&Qe()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class cr extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Ai extends cr{}async function Pi(n,e,t){xe.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),xe.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async r=>{if(r){xe.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,r.name);try{return await t()}finally{xe.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,r.name)}}else{if(e===0)throw xe.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Ai(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(xe.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}})}ji();const Ci={url:Zn,storageKey:ei,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ti,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},Ke=30*1e3,ws=3;async function ys(n,e,t){return await t()}class tt{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=tt.nextInstanceID,tt.nextInstanceID+=1,this.instanceID>0&&ne()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},Ci),e);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new Ti({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=or(r.fetch),this.lock=r.lock||ys,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:ne()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Pi:this.lock=ys,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:Qe()?this.storage=Oi:(this.memoryStorage={},this.storage=vs(this.memoryStorage)):(this.memoryStorage={},this.storage=vs(this.memoryStorage)),ne()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${nr}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=ne()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:t,error:s}=await this._getSessionFromURL(e);if(s)return this._debug("#_initialize()","error detecting session from URL",s),(s==null?void 0:s.message)==="Identity is already linked"||(s==null?void 0:s.message)==="Identity is already linked to another user"?{error:s}:(await this._removeSession(),{error:s});const{session:r,redirectType:i}=t;return this._debug("#_initialize()","detected session in URL",r,"redirect type",i),await this._saveSession(r),setTimeout(async()=>{i==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",r):await this._notifyAllSubscribers("SIGNED_IN",r)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return L(e)?{error:e}:{error:new lr("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,r;try{await this._removeSession();const i=await U(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:ue}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:c,session:a},error:null}}catch(i){if(L(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,s,r;try{await this._removeSession();let i;if("email"in e){const{email:u,password:h,options:p}=e;let _=null,m=null;this.flowType==="pkce"&&([_,m]=await Ie(this.storage,this.storageKey)),i=await U(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:u,password:h,data:(t=p==null?void 0:p.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:_,code_challenge_method:m},xform:ue})}else if("phone"in e){const{phone:u,password:h,options:p}=e;i=await U(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=p==null?void 0:p.data)!==null&&s!==void 0?s:{},channel:(r=p==null?void 0:p.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:ue})}else throw new lt("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:c,session:a},error:null}}catch(i){if(L(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{await this._removeSession();let t;if("email"in e){const{email:i,password:o,options:l}=e;t=await U(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:bs})}else if("phone"in e){const{phone:i,password:o,options:l}=e;t=await U(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:bs})}else throw new lt("You must provide either an email or phone number and a password");const{data:s,error:r}=t;return r?{data:{user:null,session:null},error:r}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Pt}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r})}catch(t){if(L(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,r,i;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await at(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(t??"").split("/"),{data:i,error:o}=await U(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:ue});return await At(this.storage,`${this.storageKey}-code-verifier`),o?{data:{user:null,session:null,redirectType:null},error:o}:!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Pt}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:r??null}),error:o})}async signInWithIdToken(e){await this._removeSession();try{const{options:t,provider:s,token:r,access_token:i,nonce:o}=e,l=await U(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:ue}),{data:a,error:c}=l;return c?{data:{user:null,session:null},error:c}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new Pt}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:c})}catch(t){if(L(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,r,i,o;try{if(await this._removeSession(),"email"in e){const{email:l,options:a}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Ie(this.storage,this.storageKey));const{error:h}=await U(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=a==null?void 0:a.data)!==null&&t!==void 0?t:{},create_user:(s=a==null?void 0:a.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:a}=e,{data:c,error:u}=await U(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(r=a==null?void 0:a.data)!==null&&r!==void 0?r:{},create_user:(i=a==null?void 0:a.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},channel:(o=a==null?void 0:a.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new lt("You must provide either an email or phone number.")}catch(l){if(L(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var t,s;try{e.type!=="email_change"&&e.type!=="phone_change"&&await this._removeSession();let r,i;"options"in e&&(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:l}=await U(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:r,xform:ue});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const a=o.session,c=o.user;return a!=null&&a.access_token&&(await this._saveSession(a),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:c,session:a},error:null}}catch(r){if(L(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,s,r;try{await this._removeSession();let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await Ie(this.storage,this.storageKey)),await U(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:yi})}catch(i){if(L(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new ke;const{error:r}=await U(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(L(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{e.type!="email_change"&&e.type!="phone_change"&&await this._removeSession();const t=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:i}=e,{error:o}=await U(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:s,type:r,options:i}=e,{data:o,error:l}=await U(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new lt("You must provide either an email or phone number and a type")}catch(t){if(L(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await at(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){const o=this.suppressGetSessionWarning;e=new Proxy(e,{get(a,c,u){return!o&&c==="user"&&console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),Reflect.get(a,c,u)}})}return{data:{session:e},error:null}}const{session:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await U(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:de}):await this._useSession(async t=>{var s,r,i;const{data:o,error:l}=t;if(l)throw l;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ke}:await U(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0,xform:de})})}catch(t){if(L(t))return{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:r,error:i}=s;if(i)throw i;if(!r.session)throw new ke;const o=r.session;let l=null,a=null;this.flowType==="pkce"&&e.email!=null&&([l,a]=await Ie(this.storage,this.storageKey));const{data:c,error:u}=await U(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:a}),jwt:o.access_token,xform:de});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(s){if(L(s))return{data:{user:null},error:s};throw s}}_decodeJWT(e){return ps(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ke;const t=Date.now()/1e3;let s=t,r=!0,i=null;const o=ps(e.access_token);if(o.exp&&(s=o.exp,r=s<=t),r){const{session:l,error:a}=await this._callRefreshToken(e.refresh_token);if(a)return{data:{user:null,session:null},error:a};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:a}=await this._getUser(e.access_token);if(a)throw a;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(L(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new ke;const{session:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(L(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e){try{if(!ne())throw new ct("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new ct("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new _s("Not a valid PKCE flow url.");const t=jt(window.location.href);if(e){if(!t.code)throw new _s("No code detected.");const{data:P,error:S}=await this._exchangeCodeForSession(t.code);if(S)throw S;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:P.session,redirectType:null},error:null}}if(t.error||t.error_description||t.error_code)throw new ct(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});const{provider_token:s,provider_refresh_token:r,access_token:i,refresh_token:o,expires_in:l,expires_at:a,token_type:c}=t;if(!i||!l||!o||!c)throw new ct("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let p=u+h;a&&(p=parseInt(a));const _=p-u;_*1e3<=Ke&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${h}s`);const m=p-h;u-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,p,u):u-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",m,p,u);const{data:b,error:v}=await this._getUser(i);if(v)throw v;const E={provider_token:s,provider_refresh_token:r,access_token:i,expires_in:h,expires_at:p,refresh_token:o,token_type:c,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:E,redirectType:t.type},error:null}}catch(t){if(L(t))return{data:{session:null,redirectType:null},error:t};throw t}}_isImplicitGrantFlow(){const e=jt(window.location.href);return!!(ne()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=jt(window.location.href),t=await at(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:r,error:i}=t;if(i)return{error:i};const o=(s=r.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(gi(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await At(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const t=ri(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,r;try{const{data:{session:i},error:o}=t;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let s=null,r=null;this.flowType==="pkce"&&([s,r]=await Ie(this.storage,this.storageKey,!0));try{return await U(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(L(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(L(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:r}=await this._useSession(async i=>{var o,l,a,c,u;const{data:h,error:p}=i;if(p)throw p;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:!0});return await U(this.fetch,"GET",_,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(r)throw r;return ne()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(L(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,r;const{data:i,error:o}=t;if(o)throw o;return await U(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0})})}catch(t){if(L(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await ai(async r=>(r>0&&await oi(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await U(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ue})),(r,i)=>{const o=200*Math.pow(2,r);return i&&Ct(i)&&Date.now()+o-s<Ke})}catch(s){if(this._debug(t,"error",s),L(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),ne()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await at(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s)){this._debug(t,"session is not valid"),s!==null&&await this._removeSession();return}const r=Math.round(Date.now()/1e3),i=((e=s.expires_at)!==null&&e!==void 0?e:1/0)<r+fs;if(this._debug(t,`session has${i?"":" not"} expired with margin of ${fs}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),Ct(o)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(t,"error",s),console.error(s);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new ke;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new wt;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new ke;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(r,"error",i),L(i)){const o={session:null,error:i};return Ct(i)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(a){i.push(a)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await ar(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await At(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ne()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ke);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((s.expires_at*1e3-e)/Ke);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${Ke}ms, refresh threshold is ${ws} ticks`),r<=ws&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof cr)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ne()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const r=[`provider=${encodeURIComponent(t)}`];if(s!=null&&s.redirectTo&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,o]=await Ie(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});r.push(l.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);r.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:r,error:i}=t;return i?{data:null,error:i}:await U(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(L(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,r;const{data:i,error:o}=t;if(o)return{data:null,error:o};const{data:l,error:a}=await U(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return a?{data:null,error:a}:(!((r=l==null?void 0:l.totp)===null||r===void 0)&&r.qr_code&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(L(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:i}=t;if(i)return{data:null,error:i};const{data:o,error:l}=await U(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(t){if(L(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:i}=t;return i?{data:null,error:i}:await U(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(L(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(e==null?void 0:e.factors)||[],r=s.filter(i=>i.factor_type==="totp"&&i.status==="verified");return{data:{all:s,totp:r},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:r},error:i}=e;if(i)return{data:null,error:i};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const o=this._decodeJWT(r.access_token);let l=null;o.aal&&(l=o.aal);let a=l;((s=(t=r.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(a="aal2");const u=o.amr||[];return{data:{currentLevel:l,nextLevel:a,currentAuthenticationMethods:u},error:null}}))}}tt.nextInstanceID=0;const Ri=tt;class Ii extends Ri{constructor(e){super(e)}}var xi=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{c(s.next(u))}catch(h){o(h)}}function a(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):r(u.value).then(l,a)}c((s=s.apply(n,e||[])).next())})};class Li{constructor(e,t,s){var r,i,o,l,a,c,u,h;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const p=Xn(e);this.realtimeUrl=`${p}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${p}/auth/v1`,this.storageUrl=`${p}/storage/v1`,this.functionsUrl=`${p}/functions/v1`;const _=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,m={db:Hn,realtime:Gn,auth:Object.assign(Object.assign({},Jn),{storageKey:_}),global:zn},b=Qn(s??{},m);this.storageKey=(i=(r=b.auth)===null||r===void 0?void 0:r.storageKey)!==null&&i!==void 0?i:"",this.headers=(l=(o=b.global)===null||o===void 0?void 0:o.headers)!==null&&l!==void 0?l:{},this.auth=this._initSupabaseAuthClient((a=b.auth)!==null&&a!==void 0?a:{},this.headers,(c=b.global)===null||c===void 0?void 0:c.fetch),this.fetch=Yn(t,this._getAccessToken.bind(this),(u=b.global)===null||u===void 0?void 0:u.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},b.realtime)),this.rest=new Jt(`${p}/rest/v1`,{headers:this.headers,schema:(h=b.db)===null||h===void 0?void 0:h.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new sn(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Mn(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return xi(this,void 0,void 0,function*(){const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,storageKey:i,flowType:o,debug:l},a,c){var u;const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Ii({url:this.authUrl,headers:Object.assign(Object.assign({},h),a),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,flowType:o,debug:l,fetch:c,hasCustomAuthorizationHeader:(u="Authorization"in this.headers)!==null&&u!==void 0?u:!1})}_initRealtimeClient(e){return new On(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?(this.realtime.setAuth(s??null),this.changedAccessToken=s):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Di=(n,e,t)=>new Li(n,e,t),fe=Di("https://oatzrwezibkcabfwxppo.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9hdHpyd2V6aWJrY2FiZnd4cHBvIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTcxMzYwOTE3MSwiZXhwIjoyMDI5MTg1MTcxfQ.u2HUJZ-hGi8Jk97FWI-hiQ3NpyMMM7V6hHQaL_Gvx1s");function it(n,{delay:e=0,duration:t=400,easing:s=Is}={}){const r=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:s,css:i=>`opacity: ${i*r}`}}function Ui(n){let e;return{c(){e=g("div"),e.innerHTML='<div class="spinner-grow text-primary m-5" role="status"></div>',d(e,"class","d-flex justify-content-center")},m(t,s){C(t,e,s)},p:j,i:j,o:j,d(t){t&&A(e)}}}class je extends G{constructor(e){super(),J(this,e,null,Ui,H,{})}}function Ni(n){let e,t,s,r,i,o,l,a,c;return{c(){e=g("div"),t=g("img"),r=T(),i=g("div"),o=g("h6"),l=g("a"),a=B(n[0]),d(t,"class","object-fit-contain rounded my-2"),d(t,"height","150"),ae(t.src,s="./default-profile.jpg")||d(t,"src",s),d(t,"alt","author"),d(l,"class","stretched-link svelte-1rzxrzv"),d(l,"href",c="./#/author/"+n[1]),d(o,"class","card-title text-center"),d(i,"class","card-body p-1"),d(e,"class","card col-md-2 col-4 border-1 svelte-1rzxrzv")},m(u,h){C(u,e,h),f(e,t),f(e,r),f(e,i),f(i,o),f(o,l),f(l,a)},p(u,[h]){h&1&&V(a,u[0]),h&2&&c!==(c="./#/author/"+u[1])&&d(l,"href",c)},i:j,o:j,d(u){u&&A(e)}}}function qi(n,e,t){let{name:s}=e,{id:r}=e;return n.$$set=i=>{"name"in i&&t(0,s=i.name),"id"in i&&t(1,r=i.id)},[s,r]}class Mi extends G{constructor(e){super(),J(this,e,qi,Ni,H,{name:0,id:1})}}function Fi(n){let e,t,s,r,i,o,l,a,c;return{c(){e=g("div"),t=g("img"),r=T(),i=g("div"),o=g("h6"),l=g("a"),a=B(n[0]),d(t,"class","object-fit-contain rounded my-2"),d(t,"height","150"),ae(t.src,s="./default-profile.jpg")||d(t,"src",s),d(t,"alt","publisher"),d(l,"class","stretched-link svelte-1rzxrzv"),d(l,"href",c="./#/publisher/"+n[1]),d(o,"class","card-title text-center"),d(i,"class","card-body p-1"),d(e,"class","card col-md-2 col-4 border-1 mb-5 svelte-1rzxrzv")},m(u,h){C(u,e,h),f(e,t),f(e,r),f(e,i),f(i,o),f(o,l),f(l,a)},p(u,[h]){h&1&&V(a,u[0]),h&2&&c!==(c="./#/publisher/"+u[1])&&d(l,"href",c)},i:j,o:j,d(u){u&&A(e)}}}function Bi(n,e,t){let{name:s}=e,{id:r}=e;return n.$$set=i=>{"name"in i&&t(0,s=i.name),"id"in i&&t(1,r=i.id)},[s,r]}class zi extends G{constructor(e){super(),J(this,e,Bi,Fi,H,{name:0,id:1})}}function Hi(n){let e,t,s,r,i,o,l,a,c,u;return{c(){e=g("div"),t=g("div"),s=g("h2"),s.textContent="Error",r=T(),i=g("p"),o=B(n[0]),l=B(": "),a=B(n[1]),c=T(),u=g("a"),u.textContent="Reload",d(u,"href","/#/"),d(u,"class","fw-bold"),d(t,"class","text-center"),d(e,"class","d-flex align-items-center justify-content-center my-3")},m(h,p){C(h,e,p),f(e,t),f(t,s),f(t,r),f(t,i),f(i,o),f(i,l),f(i,a),f(t,c),f(t,u)},p(h,[p]){p&1&&V(o,h[0]),p&2&&V(a,h[1])},i:j,o:j,d(h){h&&A(e)}}}function Ji(n,e,t){let{code:s="err"}=e,{message:r}=e;return n.$$set=i=>{"code"in i&&t(0,s=i.code),"message"in i&&t(1,r=i.message)},[s,r]}let Wt=class extends G{constructor(e){super(),J(this,e,Ji,Hi,H,{code:0,message:1})}};function ks(n,e,t){const s=n.slice();return s[9]=e[t][0],s[10]=e[t][1],s}function $s(n,e,t){const s=n.slice();return s[9]=e[t][0],s[13]=e[t][1],s}function Ss(n,e,t){const s=n.slice();return s[9]=e[t][0],s[16]=e[t][1],s}function Gi(n){let e,t;return e=new je({}),{c(){x(e.$$.fragment)},m(s,r){R(e,s,r),t=!0},p:j,i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){I(e,s)}}}function Ki(n){let e,t;return e=new Wt({props:{message:n[3]}}),{c(){x(e.$$.fragment)},m(s,r){R(e,s,r),t=!0},p(s,r){const i={};r&8&&(i.message=s[3]),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){I(e,s)}}}function Vi(n){let e,t,s=le(Object.entries(n[0])),r=[];for(let o=0;o<s.length;o+=1)r[o]=Es(Ss(n,s,o));const i=o=>$(r[o],1,1,()=>{r[o]=null});return{c(){e=g("div");for(let o=0;o<r.length;o+=1)r[o].c();d(e,"class","row")},m(o,l){C(o,e,l);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(e,null);t=!0},p(o,l){if(l&1){s=le(Object.entries(o[0]));let a;for(a=0;a<s.length;a+=1){const c=Ss(o,s,a);r[a]?(r[a].p(c,l),k(r[a],1)):(r[a]=Es(c),r[a].c(),k(r[a],1),r[a].m(e,null))}for(W(),a=s.length;a<r.length;a+=1)i(a);Y()}},i(o){if(!t){for(let l=0;l<s.length;l+=1)k(r[l]);t=!0}},o(o){r=r.filter(Boolean);for(let l=0;l<r.length;l+=1)$(r[l]);t=!1},d(o){o&&A(e),st(r,o)}}}function Es(n){let e,t;return e=new Bt({props:{title:n[16].title,id:n[16].id,author:n[16].author}}),{c(){x(e.$$.fragment)},m(s,r){R(e,s,r),t=!0},p(s,r){const i={};r&1&&(i.title=s[16].title),r&1&&(i.id=s[16].id),r&1&&(i.author=s[16].author),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){I(e,s)}}}function Wi(n){let e,t,s,r;const i=[Vi,Ki,Gi],o=[];function l(a,c){return a[0]?0:a[3]?1:2}return e=l(n),t=o[e]=i[e](n),{c(){t.c(),s=pe()},m(a,c){o[e].m(a,c),C(a,s,c),r=!0},p(a,c){let u=e;e=l(a),e===u?o[e].p(a,c):(W(),$(o[u],1,1,()=>{o[u]=null}),Y(),t=o[e],t?t.p(a,c):(t=o[e]=i[e](a),t.c()),k(t,1),t.m(s.parentNode,s))},i(a){r||(k(t),r=!0)},o(a){$(t),r=!1},d(a){a&&A(s),o[e].d(a)}}}function Yi(n){let e,t;return e=new je({}),{c(){x(e.$$.fragment)},m(s,r){R(e,s,r),t=!0},p:j,i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){I(e,s)}}}function Xi(n){let e,t;return e=new Wt({props:{message:n[4]}}),{c(){x(e.$$.fragment)},m(s,r){R(e,s,r),t=!0},p(s,r){const i={};r&16&&(i.message=s[4]),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){I(e,s)}}}function Qi(n){let e,t,s=le(Object.entries(n[1])),r=[];for(let o=0;o<s.length;o+=1)r[o]=Ts($s(n,s,o));const i=o=>$(r[o],1,1,()=>{r[o]=null});return{c(){e=g("div");for(let o=0;o<r.length;o+=1)r[o].c();d(e,"class","row")},m(o,l){C(o,e,l);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(e,null);t=!0},p(o,l){if(l&2){s=le(Object.entries(o[1]));let a;for(a=0;a<s.length;a+=1){const c=$s(o,s,a);r[a]?(r[a].p(c,l),k(r[a],1)):(r[a]=Ts(c),r[a].c(),k(r[a],1),r[a].m(e,null))}for(W(),a=s.length;a<r.length;a+=1)i(a);Y()}},i(o){if(!t){for(let l=0;l<s.length;l+=1)k(r[l]);t=!0}},o(o){r=r.filter(Boolean);for(let l=0;l<r.length;l+=1)$(r[l]);t=!1},d(o){o&&A(e),st(r,o)}}}function Ts(n){let e,t;return e=new Mi({props:{id:n[13].id,name:n[13].name}}),{c(){x(e.$$.fragment)},m(s,r){R(e,s,r),t=!0},p(s,r){const i={};r&2&&(i.id=s[13].id),r&2&&(i.name=s[13].name),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){I(e,s)}}}function Zi(n){let e,t,s,r;const i=[Qi,Xi,Yi],o=[];function l(a,c){return a[1]?0:a[4]?1:2}return e=l(n),t=o[e]=i[e](n),{c(){t.c(),s=pe()},m(a,c){o[e].m(a,c),C(a,s,c),r=!0},p(a,c){let u=e;e=l(a),e===u?o[e].p(a,c):(W(),$(o[u],1,1,()=>{o[u]=null}),Y(),t=o[e],t?t.p(a,c):(t=o[e]=i[e](a),t.c()),k(t,1),t.m(s.parentNode,s))},i(a){r||(k(t),r=!0)},o(a){$(t),r=!1},d(a){a&&A(s),o[e].d(a)}}}function eo(n){let e,t;return e=new je({}),{c(){x(e.$$.fragment)},m(s,r){R(e,s,r),t=!0},p:j,i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){I(e,s)}}}function to(n){let e,t;return e=new Wt({props:{message:n[5]}}),{c(){x(e.$$.fragment)},m(s,r){R(e,s,r),t=!0},p(s,r){const i={};r&32&&(i.message=s[5]),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){I(e,s)}}}function so(n){let e,t,s=le(Object.entries(n[2])),r=[];for(let o=0;o<s.length;o+=1)r[o]=Os(ks(n,s,o));const i=o=>$(r[o],1,1,()=>{r[o]=null});return{c(){e=g("div");for(let o=0;o<r.length;o+=1)r[o].c();d(e,"class","row")},m(o,l){C(o,e,l);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(e,null);t=!0},p(o,l){if(l&4){s=le(Object.entries(o[2]));let a;for(a=0;a<s.length;a+=1){const c=ks(o,s,a);r[a]?(r[a].p(c,l),k(r[a],1)):(r[a]=Os(c),r[a].c(),k(r[a],1),r[a].m(e,null))}for(W(),a=s.length;a<r.length;a+=1)i(a);Y()}},i(o){if(!t){for(let l=0;l<s.length;l+=1)k(r[l]);t=!0}},o(o){r=r.filter(Boolean);for(let l=0;l<r.length;l+=1)$(r[l]);t=!1},d(o){o&&A(e),st(r,o)}}}function Os(n){let e,t;return e=new zi({props:{id:n[10].id,name:n[10].name}}),{c(){x(e.$$.fragment)},m(s,r){R(e,s,r),t=!0},p(s,r){const i={};r&4&&(i.id=s[10].id),r&4&&(i.name=s[10].name),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){I(e,s)}}}function ro(n){let e,t,s,r;const i=[so,to,eo],o=[];function l(a,c){return a[2]?0:a[5]?1:2}return e=l(n),t=o[e]=i[e](n),{c(){t.c(),s=pe()},m(a,c){o[e].m(a,c),C(a,s,c),r=!0},p(a,c){let u=e;e=l(a),e===u?o[e].p(a,c):(W(),$(o[u],1,1,()=>{o[u]=null}),Y(),t=o[e],t?t.p(a,c):(t=o[e]=i[e](a),t.c()),k(t,1),t.m(s.parentNode,s))},i(a){r||(k(t),r=!0)},o(a){$(t),r=!1},d(a){a&&A(s),o[e].d(a)}}}function no(n){let e,t,s,r,i,o,l,a,c,u;return t=new Hr({}),r=new Ye({props:{title:"Books",icon:"journal",link:"#",$$slots:{default:[Wi]},$$scope:{ctx:n}}}),o=new Ye({props:{title:"Authors",icon:"person",link:"#",$$slots:{default:[Zi]},$$scope:{ctx:n}}}),a=new Ye({props:{title:"Publishers",icon:"building",link:"#",$$slots:{default:[ro]},$$scope:{ctx:n}}}),{c(){e=g("main"),x(t.$$.fragment),s=T(),x(r.$$.fragment),i=T(),x(o.$$.fragment),l=T(),x(a.$$.fragment),d(e,"class","container")},m(h,p){C(h,e,p),R(t,e,null),f(e,s),R(r,e,null),f(e,i),R(o,e,null),f(e,l),R(a,e,null),u=!0},p(h,[p]){const _={};p&524297&&(_.$$scope={dirty:p,ctx:h}),r.$set(_);const m={};p&524306&&(m.$$scope={dirty:p,ctx:h}),o.$set(m);const b={};p&524324&&(b.$$scope={dirty:p,ctx:h}),a.$set(b)},i(h){u||(k(t.$$.fragment,h),k(r.$$.fragment,h),k(o.$$.fragment,h),k(a.$$.fragment,h),h&&(c||ce(()=>{c=rt(e,it,{duration:500}),c.start()})),u=!0)},o(h){$(t.$$.fragment,h),$(r.$$.fragment,h),$(o.$$.fragment,h),$(a.$$.fragment,h),u=!1},d(h){h&&A(e),I(t),I(r),I(o),I(a)}}}function io(n,e,t){let s,r,i,o,l,a;async function c(){const{data:p,error:_}=await fe.rpc("get_books");t(0,s=p),t(3,o=_?_.message:"")}async function u(){const{data:p,error:_}=await fe.rpc("get_authors");t(1,r=p),t(4,l=_?_.message:"")}async function h(){const{data:p,error:_}=await fe.from("publisher").select("id, name").neq("id",0);t(2,i=p),t(5,a=_||"")}return c(),u(),h(),[s,r,i,o,l,a]}class oo extends G{constructor(e){super(),J(this,e,io,no,H,{})}}function ao(n){let e,t,s,r,i,o,l,a;return{c(){e=g("div"),t=g("button"),t.innerHTML='<i class="bi bi-arrow-left-circle"></i>',s=T(),r=g("div"),i=g("h4"),o=B(n[0]),d(t,"class","btn"),mt(t,"font-size","1.5em"),d(i,"class","my-auto"),d(e,"class","d-flex border-bottom border-1 my-3 align-items-center")},m(c,u){C(c,e,u),f(e,t),f(e,s),f(e,r),f(r,i),f(i,o),l||(a=zs(t,"click",n[1]),l=!0)},p(c,[u]){u&1&&V(o,c[0])},i:j,o:j,d(c){c&&A(e),l=!1,a()}}}function lo(n,e,t){let{text:s}=e;const r=()=>Dr();return n.$$set=i=>{"text"in i&&t(0,s=i.text)},[s,r]}class yt extends G{constructor(e){super(),J(this,e,lo,ao,H,{text:0})}}function co(n){let e,t;return e=new je({}),{c(){x(e.$$.fragment)},m(s,r){R(e,s,r),t=!0},p:j,i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){I(e,s)}}}function uo(n){let e,t,s,r,i,o,l,a=n[0].title+"",c,u,h,p=n[0].description+"",_,m,b,v,E,P,S=n[0].author.name+"",w,y,O,q,N,z,se,re=n[0].publisher.name+"",oe,_e,ge,Z,me,be,D,F=n[0].category.name+"",Ae,He,ve,Je,we;return{c(){e=g("div"),t=g("div"),s=g("img"),i=T(),o=g("div"),l=g("h1"),c=B(a),u=T(),h=g("p"),_=B(p),m=T(),b=g("p"),v=g("b"),v.textContent="Author:",E=T(),P=g("a"),w=B(S),O=T(),q=g("p"),N=g("b"),N.textContent="Publisher:",z=T(),se=g("a"),oe=B(re),ge=T(),Z=g("p"),me=g("b"),me.textContent="Category:",be=T(),D=g("a"),Ae=B(F),He=T(),ve=g("button"),ve.textContent="Borrow",Je=T(),we=g("button"),we.textContent="Reserve",d(s,"id","img-cover"),d(s,"class","border p-3"),ae(s.src,r="./"+n[1]+".jpg")||d(s,"src",r),d(s,"alt","book cover"),d(s,"height","300"),d(s,"width","300"),mt(s,"object-fit","contain"),d(t,"id","book-cover"),d(t,"class","d-flex justify-content-center my-1"),d(l,"id","book-title"),d(l,"class","mb-2 pb-2"),d(h,"id","book-description"),d(P,"href",y="./#/author/"+n[0].author.id),d(se,"href",_e="./#/publisher/"+n[0].publisher.id),d(D,"href","/"),d(ve,"class","btn btn-primary"),d(we,"class","btn btn-primary"),d(o,"id","details-container"),d(o,"class","container"),d(e,"class","d-md-flex d-block")},m(X,ee){C(X,e,ee),f(e,t),f(t,s),f(e,i),f(e,o),f(o,l),f(l,c),f(o,u),f(o,h),f(h,_),f(o,m),f(o,b),f(b,v),f(b,E),f(b,P),f(P,w),f(o,O),f(o,q),f(q,N),f(q,z),f(q,se),f(se,oe),f(o,ge),f(o,Z),f(Z,me),f(Z,be),f(Z,D),f(D,Ae),f(o,He),f(o,ve),f(o,Je),f(o,we)},p(X,ee){ee&1&&a!==(a=X[0].title+"")&&V(c,a),ee&1&&p!==(p=X[0].description+"")&&V(_,p),ee&1&&S!==(S=X[0].author.name+"")&&V(w,S),ee&1&&y!==(y="./#/author/"+X[0].author.id)&&d(P,"href",y),ee&1&&re!==(re=X[0].publisher.name+"")&&V(oe,re),ee&1&&_e!==(_e="./#/publisher/"+X[0].publisher.id)&&d(se,"href",_e),ee&1&&F!==(F=X[0].category.name+"")&&V(Ae,F)},i:j,o:j,d(X){X&&A(e)}}}function ho(n){let e,t,s,r,i,o,l,a;s=new yt({props:{text:"Book Details"}});const c=[uo,co],u=[];function h(p,_){return p[0]?0:1}return i=h(n),o=u[i]=c[i](n),{c(){e=g("main"),t=g("section"),x(s.$$.fragment),r=T(),o.c(),d(e,"class","container")},m(p,_){C(p,e,_),f(e,t),R(s,t,null),f(t,r),u[i].m(t,null),a=!0},p(p,[_]){let m=i;i=h(p),i===m?u[i].p(p,_):(W(),$(u[m],1,1,()=>{u[m]=null}),Y(),o=u[i],o?o.p(p,_):(o=u[i]=c[i](p),o.c()),k(o,1),o.m(t,null))},i(p){a||(k(s.$$.fragment,p),k(o),p&&(l||ce(()=>{l=rt(e,it,{duration:500}),l.start()})),a=!0)},o(p){$(s.$$.fragment,p),$(o),a=!1},d(p){p&&A(e),I(s),u[i].d()}}}function fo(n,e,t){let{params:s}=e,r=s.bookID,i;async function o(){const{data:l,error:a}=await fe.from("books").select("title, description, author(id, name), publisher(id, name), category(name)").eq("id",r);console.log(l),t(0,i=l[0])}return Mt(o),n.$$set=l=>{"params"in l&&t(2,s=l.params)},[i,r,s]}class po extends G{constructor(e){super(),J(this,e,fo,ho,H,{params:2})}}function _o(n){let e,t,s,r,i,o;const l=n[3].default,a=Ls(l,n,n[2],null);return{c(){e=g("div"),t=g("label"),s=B(n[0]),r=T(),i=g("div"),a&&a.c(),d(t,"class","col-sm-4 col-md-3 col-form-label"),d(t,"for",n[1]),d(i,"class","col-sm-8 col-md-9"),d(e,"class","my-3 row")},m(c,u){C(c,e,u),f(e,t),f(t,s),f(e,r),f(e,i),a&&a.m(i,null),o=!0},p(c,[u]){(!o||u&1)&&V(s,c[0]),(!o||u&2)&&d(t,"for",c[1]),a&&a.p&&(!o||u&4)&&Ns(a,l,c,c[2],o?Us(l,c[2],u,null):qs(c[2]),null)},i(c){o||(k(a,c),o=!0)},o(c){$(a,c),o=!1},d(c){c&&A(e),a&&a.d(c)}}}function go(n,e,t){let{$$slots:s={},$$scope:r}=e,{label:i}=e,{id:o}=e;return n.$$set=l=>{"label"in l&&t(0,i=l.label),"id"in l&&t(1,o=l.id),"$$scope"in l&&t(2,r=l.$$scope)},[i,o,r,s]}class $e extends G{constructor(e){super(),J(this,e,go,_o,H,{label:0,id:1})}}function mo(n){let e;return{c(){e=g("input"),d(e,"class","form-control"),d(e,"type","text"),d(e,"id","book-name")},m(t,s){C(t,e,s)},p:j,d(t){t&&A(e)}}}function bo(n){let e;return{c(){e=g("textarea"),d(e,"class","form-control"),d(e,"id","book-description"),d(e,"rows","4")},m(t,s){C(t,e,s)},p:j,d(t){t&&A(e)}}}function vo(n){let e;return{c(){e=g("input"),d(e,"class","form-control"),d(e,"type","file"),d(e,"id","book-cover"),d(e,"accept","image/*")},m(t,s){C(t,e,s)},p:j,d(t){t&&A(e)}}}function wo(n){let e;return{c(){e=g("input"),d(e,"class","form-control"),d(e,"type","text"),d(e,"id","book-category")},m(t,s){C(t,e,s)},p:j,d(t){t&&A(e)}}}function yo(n){let e;return{c(){e=g("input"),d(e,"list","authors"),d(e,"class","form-control"),d(e,"type","text"),d(e,"id","book-author")},m(t,s){C(t,e,s)},p:j,d(t){t&&A(e)}}}function ko(n){let e;return{c(){e=g("input"),d(e,"list","publishers"),d(e,"class","form-control"),d(e,"type","text"),d(e,"id","book-publisher")},m(t,s){C(t,e,s)},p:j,d(t){t&&A(e)}}}function $o(n){let e;return{c(){e=g("input"),d(e,"class","form-control"),d(e,"type","text"),d(e,"id","book-isbn")},m(t,s){C(t,e,s)},p:j,d(t){t&&A(e)}}}function So(n){let e,t,s,r,i,o,l,a,c,u,h,p,_,m,b,v,E,P,S,w,y,O,q,N,z,se,re,oe,_e,ge,Z,me,be;return s=new yt({props:{text:"Add Book"}}),l=new $e({props:{label:"Book Title:",id:"book-name",$$slots:{default:[mo]},$$scope:{ctx:n}}}),c=new $e({props:{label:"Book Description:",id:"book-description",$$slots:{default:[bo]},$$scope:{ctx:n}}}),h=new $e({props:{label:"Book Cover:",id:"book-cover",$$slots:{default:[vo]},$$scope:{ctx:n}}}),v=new $e({props:{label:"Category: ",id:"book-category",$$slots:{default:[wo]},$$scope:{ctx:n}}}),P=new $e({props:{label:"Author: ",id:"book-author",$$slots:{default:[yo]},$$scope:{ctx:n}}}),w=new $e({props:{label:"Publisher: ",id:"book-publisher",$$slots:{default:[ko]},$$scope:{ctx:n}}}),O=new $e({props:{label:"Category: ",id:"book-category",$$slots:{default:[$o]},$$scope:{ctx:n}}}),{c(){e=g("section"),t=g("div"),x(s.$$.fragment),r=T(),i=g("div"),o=g("div"),x(l.$$.fragment),a=T(),x(c.$$.fragment),u=T(),x(h.$$.fragment),p=T(),_=g("div"),_.innerHTML='<label for="cover-preview" class="form-label align-self-center">Preview:</label> <div class="form-input" id="preview-div"><img src="" alt="Preview" id="cover-preview" height="150"/> <button class="btn btn-sm btn-danger">Remove</button></div>',m=T(),b=g("div"),x(v.$$.fragment),E=T(),x(P.$$.fragment),S=T(),x(w.$$.fragment),y=T(),x(O.$$.fragment),q=T(),N=g("div"),N.innerHTML='<button class="btn btn-success" disabled="" id="add"><i class="bi bi-plus-circle"></i> Add Book</button> <a href="index.html"><button class="btn btn-danger" id="cancel"><i class="bi bi-x-circle"></i> Cancel</button></a>',z=T(),se=g("datalist"),re=g("option"),re.innerHTML="",oe=g("option"),oe.innerHTML="",_e=T(),ge=g("datalist"),Z=g("option"),Z.innerHTML="",d(_,"class","form-row d-none"),d(_,"id","preview-row"),d(o,"class","col-sm-12 col-lg-6"),d(b,"class","col-sm-12 col-lg-6"),d(i,"class","row justify-content-center"),d(t,"class","container-fluid "),d(N,"class","my-3"),re.__value="Jemma Development Group",$t(re,re.__value),oe.__value="Richard Osman",$t(oe,oe.__value),d(se,"id","authors"),Z.__value="Jemma Inc.",$t(Z,Z.__value),d(ge,"id","publishers"),d(e,"class","my-1 container px-5")},m(D,F){C(D,e,F),f(e,t),R(s,t,null),f(t,r),f(t,i),f(i,o),R(l,o,null),f(o,a),R(c,o,null),f(o,u),R(h,o,null),f(o,p),f(o,_),f(i,m),f(i,b),R(v,b,null),f(b,E),R(P,b,null),f(b,S),R(w,b,null),f(b,y),R(O,b,null),f(e,q),f(e,N),f(e,z),f(e,se),f(se,re),f(se,oe),f(e,_e),f(e,ge),f(ge,Z),be=!0},p(D,[F]){const Ae={};F&1&&(Ae.$$scope={dirty:F,ctx:D}),l.$set(Ae);const He={};F&1&&(He.$$scope={dirty:F,ctx:D}),c.$set(He);const ve={};F&1&&(ve.$$scope={dirty:F,ctx:D}),h.$set(ve);const Je={};F&1&&(Je.$$scope={dirty:F,ctx:D}),v.$set(Je);const we={};F&1&&(we.$$scope={dirty:F,ctx:D}),P.$set(we);const X={};F&1&&(X.$$scope={dirty:F,ctx:D}),w.$set(X);const ee={};F&1&&(ee.$$scope={dirty:F,ctx:D}),O.$set(ee)},i(D){be||(k(s.$$.fragment,D),k(l.$$.fragment,D),k(c.$$.fragment,D),k(h.$$.fragment,D),k(v.$$.fragment,D),k(P.$$.fragment,D),k(w.$$.fragment,D),k(O.$$.fragment,D),D&&(me||ce(()=>{me=rt(e,it,{duration:500}),me.start()})),be=!0)},o(D){$(s.$$.fragment,D),$(l.$$.fragment,D),$(c.$$.fragment,D),$(h.$$.fragment,D),$(v.$$.fragment,D),$(P.$$.fragment,D),$(w.$$.fragment,D),$(O.$$.fragment,D),be=!1},d(D){D&&A(e),I(s),I(l),I(c),I(h),I(v),I(P),I(w),I(O)}}}class Eo extends G{constructor(e){super(),J(this,e,null,So,H,{})}}function js(n,e,t){const s=n.slice();return s[5]=e[t][0],s[6]=e[t][1],s}function To(n){let e,t;return e=new je({}),{c(){x(e.$$.fragment)},m(s,r){R(e,s,r),t=!0},p:j,i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){I(e,s)}}}function Oo(n){let e,t,s=n[0].name+"",r,i,o,l,a;return{c(){e=g("div"),t=g("h1"),r=B(s),i=T(),o=g("p"),o.textContent=`Lorem ipsum dolor sit amet pariatur est libero! Facilis ipsum est\r
            voluptas animi aliquam dolorem sunt, iure consequuntur dignissimos\r
            doloremque! Neque velit quas, illum, facere aliquam sed\r
            exercitationem at voluptatem incidunt beatae voluptate deserunt.`,l=T(),a=g("p"),a.innerHTML='<b>Website:</b> <a href="https://github.com/salles4/">salles4.github.io</a>',d(t,"class","mb-2 pb-2"),d(o,"class",""),d(e,"class","container")},m(c,u){C(c,e,u),f(e,t),f(t,r),f(e,i),f(e,o),f(e,l),f(e,a)},p(c,u){u&1&&s!==(s=c[0].name+"")&&V(r,s)},i:j,o:j,d(c){c&&A(e)}}}function jo(n){let e,t;return e=new je({}),{c(){x(e.$$.fragment)},m(s,r){R(e,s,r),t=!0},p:j,i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){I(e,s)}}}function Ao(n){let e,t,s=le(Object.entries(n[1])),r=[];for(let o=0;o<s.length;o+=1)r[o]=As(js(n,s,o));const i=o=>$(r[o],1,1,()=>{r[o]=null});return{c(){e=g("div");for(let o=0;o<r.length;o+=1)r[o].c();d(e,"class","row")},m(o,l){C(o,e,l);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(e,null);t=!0},p(o,l){if(l&2){s=le(Object.entries(o[1]));let a;for(a=0;a<s.length;a+=1){const c=js(o,s,a);r[a]?(r[a].p(c,l),k(r[a],1)):(r[a]=As(c),r[a].c(),k(r[a],1),r[a].m(e,null))}for(W(),a=s.length;a<r.length;a+=1)i(a);Y()}},i(o){if(!t){for(let l=0;l<s.length;l+=1)k(r[l]);t=!0}},o(o){r=r.filter(Boolean);for(let l=0;l<r.length;l+=1)$(r[l]);t=!1},d(o){o&&A(e),st(r,o)}}}function As(n){let e,t;return e=new Bt({props:{title:n[6].title,id:n[6].id,author:n[6].author.name}}),{c(){x(e.$$.fragment)},m(s,r){R(e,s,r),t=!0},p(s,r){const i={};r&2&&(i.title=s[6].title),r&2&&(i.id=s[6].id),r&2&&(i.author=s[6].author.name),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){I(e,s)}}}function Po(n){let e,t,s,r;const i=[Ao,jo],o=[];function l(a,c){return a[1]?0:1}return e=l(n),t=o[e]=i[e](n),{c(){t.c(),s=pe()},m(a,c){o[e].m(a,c),C(a,s,c),r=!0},p(a,c){let u=e;e=l(a),e===u?o[e].p(a,c):(W(),$(o[u],1,1,()=>{o[u]=null}),Y(),t=o[e],t?t.p(a,c):(t=o[e]=i[e](a),t.c()),k(t,1),t.m(s.parentNode,s))},i(a){r||(k(t),r=!0)},o(a){$(t),r=!1},d(a){a&&A(s),o[e].d(a)}}}function Co(n){let e,t,s,r,i,o,l,a,c,u,h,p,_,m,b;s=new yt({props:{text:"Author Details"}});const v=[Oo,To],E=[];function P(S,w){return S[0]?0:1}return u=P(n),h=E[u]=v[u](n),_=new Ye({props:{title:"Books",icon:"journal",$$slots:{default:[Po]},$$scope:{ctx:n}}}),{c(){e=g("main"),t=g("section"),x(s.$$.fragment),r=T(),i=g("div"),o=g("div"),l=g("img"),c=T(),h.c(),p=T(),x(_.$$.fragment),d(l,"class","border p-3"),ae(l.src,a=Ro)||d(l,"src",a),d(l,"alt","author"),d(l,"height","300"),d(l,"width","300"),mt(l,"object-fit","contain"),d(o,"class","d-flex justify-content-center my-1"),d(i,"class","d-md-flex d-block"),d(e,"class","container")},m(S,w){C(S,e,w),f(e,t),R(s,t,null),f(t,r),f(t,i),f(i,o),f(o,l),f(i,c),E[u].m(i,null),f(e,p),R(_,e,null),b=!0},p(S,[w]){let y=u;u=P(S),u===y?E[u].p(S,w):(W(),$(E[y],1,1,()=>{E[y]=null}),Y(),h=E[u],h?h.p(S,w):(h=E[u]=v[u](S),h.c()),k(h,1),h.m(i,null));const O={};w&514&&(O.$$scope={dirty:w,ctx:S}),_.$set(O)},i(S){b||(k(s.$$.fragment,S),k(h),k(_.$$.fragment,S),S&&(m||ce(()=>{m=rt(e,it,{duration:500}),m.start()})),b=!0)},o(S){$(s.$$.fragment,S),$(h),$(_.$$.fragment,S),b=!1},d(S){S&&A(e),I(s),E[u].d(),I(_)}}}let Ro="./default-profile.jpg";function Io(n,e,t){let{params:s}=e,r=s.authorID,i,o;async function l(){const{data:a,error:c}=await fe.from("author").select().eq("id",r);console.log(a),t(0,i=a[0]);const{data:u,error:h}=await fe.from("books").select("id, title, author(name)").eq("publisher_id",r);console.log(u),t(1,o=u)}return Mt(l),n.$$set=a=>{"params"in a&&t(2,s=a.params)},[i,o,s]}class xo extends G{constructor(e){super(),J(this,e,Io,Co,H,{params:2})}}function Ps(n,e,t){const s=n.slice();return s[5]=e[t][0],s[6]=e[t][1],s}function Cs(n){let e,t,s=n[0].name+"",r,i,o,l,a;return{c(){e=g("div"),t=g("h1"),r=B(s),i=T(),o=g("p"),o.textContent=`Lorem ipsum dolor sit amet pariatur est libero! Facilis ipsum est\r
          voluptas animi aliquam dolorem sunt, iure consequuntur dignissimos\r
          doloremque! Neque velit quas, illum, facere aliquam sed exercitationem\r
          at voluptatem incidunt beatae voluptate deserunt.`,l=T(),a=g("p"),a.innerHTML='<b>Website:</b> <a href="https://github.com/salles4/" id="publisher-website">salles4.github.io</a>',d(t,"id","publisher-name"),d(t,"class","mb-2 pb-2"),d(o,"id","publisher-bio"),d(o,"class",""),d(e,"id","details-container"),d(e,"class","container")},m(c,u){C(c,e,u),f(e,t),f(t,r),f(e,i),f(e,o),f(e,l),f(e,a)},p(c,u){u&1&&s!==(s=c[0].name+"")&&V(r,s)},d(c){c&&A(e)}}}function Lo(n){let e,t;return e=new je({}),{c(){x(e.$$.fragment)},m(s,r){R(e,s,r),t=!0},p:j,i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){I(e,s)}}}function Do(n){let e,t,s=le(Object.entries(n[1])),r=[];for(let o=0;o<s.length;o+=1)r[o]=Rs(Ps(n,s,o));const i=o=>$(r[o],1,1,()=>{r[o]=null});return{c(){e=g("div");for(let o=0;o<r.length;o+=1)r[o].c();d(e,"class","row")},m(o,l){C(o,e,l);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(e,null);t=!0},p(o,l){if(l&2){s=le(Object.entries(o[1]));let a;for(a=0;a<s.length;a+=1){const c=Ps(o,s,a);r[a]?(r[a].p(c,l),k(r[a],1)):(r[a]=Rs(c),r[a].c(),k(r[a],1),r[a].m(e,null))}for(W(),a=s.length;a<r.length;a+=1)i(a);Y()}},i(o){if(!t){for(let l=0;l<s.length;l+=1)k(r[l]);t=!0}},o(o){r=r.filter(Boolean);for(let l=0;l<r.length;l+=1)$(r[l]);t=!1},d(o){o&&A(e),st(r,o)}}}function Rs(n){let e,t;return e=new Bt({props:{title:n[6].title,id:n[6].id,author:n[6].author.name}}),{c(){x(e.$$.fragment)},m(s,r){R(e,s,r),t=!0},p(s,r){const i={};r&2&&(i.title=s[6].title),r&2&&(i.id=s[6].id),r&2&&(i.author=s[6].author.name),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){I(e,s)}}}function Uo(n){let e,t,s,r,i,o,l,a,c,u,h,p,_,m,b,v;t=new yt({props:{text:"Publisher Details"}});let E=n[0]&&Cs(n);p=new Ye({props:{title:"Books",icon:"journal"}});const P=[Do,Lo],S=[];function w(y,O){return y[1]?0:1}return m=w(n),b=S[m]=P[m](n),{c(){e=g("section"),x(t.$$.fragment),s=T(),r=g("div"),i=g("div"),o=g("img"),a=T(),E&&E.c(),u=T(),h=g("section"),x(p.$$.fragment),_=T(),b.c(),d(o,"id","img-cover"),d(o,"class","border p-3"),ae(o.src,l=No)||d(o,"src",l),d(o,"alt","publisher"),d(o,"height","300"),d(o,"width","300"),mt(o,"object-fit","contain"),d(i,"id","publisher-cover"),d(i,"class","d-flex justify-content-center my-1"),d(r,"class","d-md-flex d-block"),d(e,"class","container"),d(h,"class","container")},m(y,O){C(y,e,O),R(t,e,null),f(e,s),f(e,r),f(r,i),f(i,o),f(r,a),E&&E.m(r,null),C(y,u,O),C(y,h,O),R(p,h,null),f(h,_),S[m].m(h,null),v=!0},p(y,[O]){y[0]?E?E.p(y,O):(E=Cs(y),E.c(),E.m(r,null)):E&&(E.d(1),E=null);let q=m;m=w(y),m===q?S[m].p(y,O):(W(),$(S[q],1,1,()=>{S[q]=null}),Y(),b=S[m],b?b.p(y,O):(b=S[m]=P[m](y),b.c()),k(b,1),b.m(h,null))},i(y){v||(k(t.$$.fragment,y),y&&(c||ce(()=>{c=rt(e,it,{duration:500}),c.start()})),k(p.$$.fragment,y),k(b),v=!0)},o(y){$(t.$$.fragment,y),$(p.$$.fragment,y),$(b),v=!1},d(y){y&&(A(e),A(u),A(h)),I(t),E&&E.d(),I(p),S[m].d()}}}let No="./default-profile.jpg";function qo(n,e,t){let{params:s}=e,r=s.publisherID,i,o;async function l(){const{data:a,error:c}=await fe.from("publisher").select().eq("id",r);console.log(a),t(0,i=a[0]);const{data:u,error:h}=await fe.from("books").select("id, title, author(name)").eq("publisher_id",r);console.log(u),t(1,o=u)}return Mt(l),n.$$set=a=>{"params"in a&&t(2,s=a.params)},[i,o,s]}class Mo extends G{constructor(e){super(),J(this,e,qo,Uo,H,{params:2})}}function Fo(n){let e;return{c(){e=g("h1"),e.textContent="Not Logged in"},m(t,s){C(t,e,s)},i:j,o:j,d(t){t&&A(e)}}}function Bo(n){let e,t,s,r;return e=new Br({}),s=new qr({props:{routes:{"/":oo,"/book/:bookID":po,"/add-book":Eo,"/author/:authorID":xo,"/publisher/:publisherID":Mo}}}),{c(){x(e.$$.fragment),t=T(),x(s.$$.fragment)},m(i,o){R(e,i,o),C(i,t,o),R(s,i,o),r=!0},i(i){r||(k(e.$$.fragment,i),k(s.$$.fragment,i),r=!0)},o(i){$(e.$$.fragment,i),$(s.$$.fragment,i),r=!1},d(i){i&&A(t),I(e,i),I(s,i)}}}function zo(n){let e,t,s,r;const i=[Bo,Fo],o=[];function l(a,c){return 0}return e=l(),t=o[e]=i[e](n),{c(){t.c(),s=pe()},m(a,c){o[e].m(a,c),C(a,s,c),r=!0},p:j,i(a){r||(k(t),r=!0)},o(a){$(t),r=!1},d(a){a&&A(s),o[e].d(a)}}}class Ho extends G{constructor(e){super(),J(this,e,null,zo,H,{})}}new Ho({target:document.getElementById("app")});
