var xs=Object.defineProperty;var Ds=(n,e,t)=>e in n?xs(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Rt=(n,e,t)=>(Ds(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function j(){}const rs=n=>n;function ot(n,e){for(const t in e)n[t]=e[t];return n}function ss(n){return n()}function fr(){return Object.create(null)}function ve(n){n.forEach(ss)}function Et(n){return typeof n=="function"}function z(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let ft;function de(n,e){return n===e?!0:(ft||(ft=document.createElement("a")),ft.href=e,n===ft.href)}function Us(n){return Object.keys(n).length===0}function ns(n,...e){if(n==null){for(const r of e)r(void 0);return j}const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Ns(n,e,t){n.$$.on_destroy.push(ns(e,t))}function is(n,e,t,r){if(n){const s=os(n,e,t,r);return n[0](s)}}function os(n,e,t,r){return n[1]&&r?ot(t.ctx.slice(),n[1](r(e))):t.ctx}function as(n,e,t,r){if(n[2]&&r){const s=n[2](r(t));if(e.dirty===void 0)return s;if(typeof s=="object"){const i=[],o=Math.max(e.dirty.length,s.length);for(let l=0;l<o;l+=1)i[l]=e.dirty[l]|s[l];return i}return e.dirty|s}return e.dirty}function ls(n,e,t,r,s,i){if(s){const o=os(e,t,r,i);n.p(o,s)}}function cs(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let r=0;r<t;r++)e[r]=-1;return e}return-1}const us=typeof window<"u";let qs=us?()=>window.performance.now():()=>Date.now(),Vt=us?n=>requestAnimationFrame(n):j;const ze=new Set;function hs(n){ze.forEach(e=>{e.c(n)||(ze.delete(e),e.f())}),ze.size!==0&&Vt(hs)}function Ms(n){let e;return ze.size===0&&Vt(hs),{promise:new Promise(t=>{ze.add(e={c:n,f:t})}),abort(){ze.delete(e)}}}function f(n,e){n.appendChild(e)}function ds(n){if(!n)return document;const e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function Bs(n){const e=m("style");return e.textContent="/* empty */",Fs(ds(n),e),e.sheet}function Fs(n,e){return f(n.head||n,e),e.sheet}function P(n,e,t){n.insertBefore(e,t||null)}function A(n){n.parentNode&&n.parentNode.removeChild(n)}function Ee(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function m(n){return document.createElement(n)}function V(n){return document.createTextNode(n)}function E(){return V(" ")}function me(){return V("")}function pe(n,e,t,r){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}function d(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function zs(n){return Array.from(n.childNodes)}function ee(n,e){e=""+e,n.data!==e&&(n.data=e)}function $e(n,e){n.value=e??""}function Ye(n,e,t,r){t==null?n.style.removeProperty(e):n.style.setProperty(e,t,"")}function fs(n,e,{bubbles:t=!1,cancelable:r=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:r})}function vt(n,e){return new n(e)}const wt=new Map;let yt=0;function Hs(n){let e=5381,t=n.length;for(;t--;)e=(e<<5)-e^n.charCodeAt(t);return e>>>0}function Js(n,e){const t={stylesheet:Bs(e),rules:{}};return wt.set(n,t),t}function Gs(n,e,t,r,s,i,o,l=0){const a=16.666/r;let c=`{
`;for(let v=0;v<=1;v+=a){const k=e+(t-e)*i(v);c+=v*100+`%{${o(k,1-k)}}
`}const u=c+`100% {${o(t,1-t)}}
}`,h=`__svelte_${Hs(u)}_${l}`,_=ds(n),{stylesheet:p,rules:g}=wt.get(_)||Js(_,n);g[h]||(g[h]=!0,p.insertRule(`@keyframes ${h} ${u}`,p.cssRules.length));const b=n.style.animation||"";return n.style.animation=`${b?`${b}, `:""}${h} ${r}ms linear ${s}ms 1 both`,yt+=1,h}function _r(n,e){const t=(n.style.animation||"").split(", "),r=t.filter(e?i=>i.indexOf(e)<0:i=>i.indexOf("__svelte")===-1),s=t.length-r.length;s&&(n.style.animation=r.join(", "),yt-=s,yt||Ks())}function Ks(){Vt(()=>{yt||(wt.forEach(n=>{const{ownerNode:e}=n.stylesheet;e&&A(e)}),wt.clear())})}let at;function st(n){at=n}function Tt(){if(!at)throw new Error("Function called outside component initialization");return at}function lt(n){Tt().$$.on_mount.push(n)}function Vs(n){Tt().$$.after_update.push(n)}function Ws(n){Tt().$$.on_destroy.push(n)}function Ys(){const n=Tt();return(e,t,{cancelable:r=!1}={})=>{const s=n.$$.callbacks[e];if(s){const i=fs(e,t,{cancelable:r});return s.slice().forEach(o=>{o.call(n,i)}),!i.defaultPrevented}return!0}}function pr(n,e){const t=n.$$.callbacks[e.type];t&&t.slice().forEach(r=>r.call(this,e))}const Be=[],kt=[];let He=[];const mr=[],_s=Promise.resolve();let Bt=!1;function ps(){Bt||(Bt=!0,_s.then(gs))}function ms(){return ps(),_s}function ge(n){He.push(n)}const It=new Set;let De=0;function gs(){if(De!==0)return;const n=at;do{try{for(;De<Be.length;){const e=Be[De];De++,st(e),Xs(e.$$)}}catch(e){throw Be.length=0,De=0,e}for(st(null),Be.length=0,De=0;kt.length;)kt.pop()();for(let e=0;e<He.length;e+=1){const t=He[e];It.has(t)||(It.add(t),t())}He.length=0}while(Be.length);for(;mr.length;)mr.pop()();Bt=!1,It.clear(),st(n)}function Xs(n){if(n.fragment!==null){n.update(),ve(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(ge)}}function Qs(n){const e=[],t=[];He.forEach(r=>n.indexOf(r)===-1?e.push(r):t.push(r)),t.forEach(r=>r()),He=e}let et;function Zs(){return et||(et=Promise.resolve(),et.then(()=>{et=null})),et}function gr(n,e,t){n.dispatchEvent(fs(`intro${t}`))}const bt=new Set;let Pe;function W(){Pe={r:0,c:[],p:Pe}}function Y(){Pe.r||ve(Pe.c),Pe=Pe.p}function w(n,e){n&&n.i&&(bt.delete(n),n.i(e))}function y(n,e,t,r){if(n&&n.o){if(bt.has(n))return;bt.add(n),Pe.c.push(()=>{bt.delete(n),r&&(t&&n.d(1),r())}),n.o(e)}else r&&r()}const en={duration:0};function Xe(n,e,t){const r={direction:"in"};let s=e(n,t,r),i=!1,o,l,a=0;function c(){o&&_r(n,o)}function u(){const{delay:_=0,duration:p=300,easing:g=rs,tick:b=j,css:v}=s||en;v&&(o=Gs(n,0,1,p,_,g,v,a++)),b(0,1);const k=qs()+_,C=k+p;l&&l.abort(),i=!0,ge(()=>gr(n,!0,"start")),l=Ms(T=>{if(i){if(T>=C)return b(1,0),gr(n,!0,"end"),c(),i=!1;if(T>=k){const $=g((T-k)/p);b($,1-$)}}return i})}let h=!1;return{start(){h||(h=!0,_r(n),Et(s)?(s=s(r),Zs().then(u)):u())},invalidate(){h=!1},end(){i&&(c(),i=!1)}}}function re(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function $t(n,e){const t={},r={},s={$$scope:1};let i=n.length;for(;i--;){const o=n[i],l=e[i];if(l){for(const a in o)a in l||(r[a]=1);for(const a in l)s[a]||(t[a]=l[a],s[a]=1);n[i]=l}else for(const a in o)s[a]=1}for(const o in r)o in t||(t[o]=void 0);return t}function St(n){return typeof n=="object"&&n!==null?n:{}}function L(n){n&&n.c()}function R(n,e,t){const{fragment:r,after_update:s}=n.$$;r&&r.m(e,t),ge(()=>{const i=n.$$.on_mount.map(ss).filter(Et);n.$$.on_destroy?n.$$.on_destroy.push(...i):ve(i),n.$$.on_mount=[]}),s.forEach(ge)}function I(n,e){const t=n.$$;t.fragment!==null&&(Qs(t.after_update),ve(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function tn(n,e){n.$$.dirty[0]===-1&&(Be.push(n),ps(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function J(n,e,t,r,s,i,o=null,l=[-1]){const a=at;st(n);const c=n.$$={fragment:null,ctx:[],props:i,update:j,not_equal:s,bound:fr(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:fr(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};o&&o(c.root);let u=!1;if(c.ctx=t?t(n,e.props||{},(h,_,...p)=>{const g=p.length?p[0]:_;return c.ctx&&s(c.ctx[h],c.ctx[h]=g)&&(!c.skip_bound&&c.bound[h]&&c.bound[h](g),u&&tn(n,h)),_}):[],c.update(),u=!0,ve(c.before_update),c.fragment=r?r(c.ctx):!1,e.target){if(e.hydrate){const h=zs(e.target);c.fragment&&c.fragment.l(h),h.forEach(A)}else c.fragment&&c.fragment.c();e.intro&&w(n.$$.fragment),R(n,e.target,e.anchor),gs()}st(a)}class G{constructor(){Rt(this,"$$");Rt(this,"$$set")}$destroy(){I(this,1),this.$destroy=j}$on(e,t){if(!Et(t))return j;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(t),()=>{const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}$set(e){this.$$set&&!Us(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const rn="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(rn);const Ue=[];function bs(n,e){return{subscribe:Wt(n,e).subscribe}}function Wt(n,e=j){let t;const r=new Set;function s(l){if(z(n,l)&&(n=l,t)){const a=!Ue.length;for(const c of r)c[1](),Ue.push(c,n);if(a){for(let c=0;c<Ue.length;c+=2)Ue[c][0](Ue[c+1]);Ue.length=0}}}function i(l){s(l(n))}function o(l,a=j){const c=[l,a];return r.add(c),r.size===1&&(t=e(s,i)||j),l(n),()=>{r.delete(c),r.size===0&&t&&(t(),t=null)}}return{set:s,update:i,subscribe:o}}function vs(n,e,t){const r=!Array.isArray(n),s=r?[n]:n;if(!s.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const i=e.length<2;return bs(t,(o,l)=>{let a=!1;const c=[];let u=0,h=j;const _=()=>{if(u)return;h();const g=e(r?c[0]:c,o,l);i?o(g):h=Et(g)?g:j},p=s.map((g,b)=>ns(g,v=>{c[b]=v,u&=~(1<<b),a&&_()},()=>{u|=1<<b}));return a=!0,_(),function(){ve(p),h(),a=!1}})}const ct=Wt(localStorage.getItem("accType"));function sn(n,e){if(n instanceof RegExp)return{keys:!1,pattern:n};var t,r,s,i,o=[],l="",a=n.split("/");for(a[0]||a.shift();s=a.shift();)t=s[0],t==="*"?(o.push("wild"),l+="/(.*)"):t===":"?(r=s.indexOf("?",1),i=s.indexOf(".",1),o.push(s.substring(1,~r?r:~i?i:s.length)),l+=~r&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(l+=(~r?"?":"")+"\\"+s.substring(i))):l+="/"+s;return{keys:o,pattern:new RegExp("^"+l+"/?$","i")}}function nn(n){let e,t,r;const s=[n[2]];var i=n[0];function o(l,a){let c={};for(let u=0;u<s.length;u+=1)c=ot(c,s[u]);return a!==void 0&&a&4&&(c=ot(c,$t(s,[St(l[2])]))),{props:c}}return i&&(e=vt(i,o(n)),e.$on("routeEvent",n[7])),{c(){e&&L(e.$$.fragment),t=me()},m(l,a){e&&R(e,l,a),P(l,t,a),r=!0},p(l,a){if(a&1&&i!==(i=l[0])){if(e){W();const c=e;y(c.$$.fragment,1,0,()=>{I(c,1)}),Y()}i?(e=vt(i,o(l,a)),e.$on("routeEvent",l[7]),L(e.$$.fragment),w(e.$$.fragment,1),R(e,t.parentNode,t)):e=null}else if(i){const c=a&4?$t(s,[St(l[2])]):{};e.$set(c)}},i(l){r||(e&&w(e.$$.fragment,l),r=!0)},o(l){e&&y(e.$$.fragment,l),r=!1},d(l){l&&A(t),e&&I(e,l)}}}function on(n){let e,t,r;const s=[{params:n[1]},n[2]];var i=n[0];function o(l,a){let c={};for(let u=0;u<s.length;u+=1)c=ot(c,s[u]);return a!==void 0&&a&6&&(c=ot(c,$t(s,[a&2&&{params:l[1]},a&4&&St(l[2])]))),{props:c}}return i&&(e=vt(i,o(n)),e.$on("routeEvent",n[6])),{c(){e&&L(e.$$.fragment),t=me()},m(l,a){e&&R(e,l,a),P(l,t,a),r=!0},p(l,a){if(a&1&&i!==(i=l[0])){if(e){W();const c=e;y(c.$$.fragment,1,0,()=>{I(c,1)}),Y()}i?(e=vt(i,o(l,a)),e.$on("routeEvent",l[6]),L(e.$$.fragment),w(e.$$.fragment,1),R(e,t.parentNode,t)):e=null}else if(i){const c=a&6?$t(s,[a&2&&{params:l[1]},a&4&&St(l[2])]):{};e.$set(c)}},i(l){r||(e&&w(e.$$.fragment,l),r=!0)},o(l){e&&y(e.$$.fragment,l),r=!1},d(l){l&&A(t),e&&I(e,l)}}}function an(n){let e,t,r,s;const i=[on,nn],o=[];function l(a,c){return a[1]?0:1}return e=l(n),t=o[e]=i[e](n),{c(){t.c(),r=me()},m(a,c){o[e].m(a,c),P(a,r,c),s=!0},p(a,[c]){let u=e;e=l(a),e===u?o[e].p(a,c):(W(),y(o[u],1,1,()=>{o[u]=null}),Y(),t=o[e],t?t.p(a,c):(t=o[e]=i[e](a),t.c()),w(t,1),t.m(r.parentNode,r))},i(a){s||(w(t),s=!0)},o(a){y(t),s=!1},d(a){a&&A(r),o[e].d(a)}}}function br(){const n=window.location.href.indexOf("#/");let e=n>-1?window.location.href.substr(n+1):"/";const t=e.indexOf("?");let r="";return t>-1&&(r=e.substr(t+1),e=e.substr(0,t)),{location:e,querystring:r}}const Yt=bs(null,function(e){e(br());const t=()=>{e(br())};return window.addEventListener("hashchange",t,!1),function(){window.removeEventListener("hashchange",t,!1)}}),ln=vs(Yt,n=>n.location);vs(Yt,n=>n.querystring);const vr=Wt(void 0);async function cn(){await ms(),window.history.back()}function un(n){n?window.scrollTo(n.__svelte_spa_router_scrollX,n.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function hn(n,e,t){let{routes:r={}}=e,{prefix:s=""}=e,{restoreScrollState:i=!1}=e;class o{constructor(S,O){if(!O||typeof O!="function"&&(typeof O!="object"||O._sveltesparouter!==!0))throw Error("Invalid component object");if(!S||typeof S=="string"&&(S.length<1||S.charAt(0)!="/"&&S.charAt(0)!="*")||typeof S=="object"&&!(S instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:D,keys:x}=sn(S);this.path=S,typeof O=="object"&&O._sveltesparouter===!0?(this.component=O.component,this.conditions=O.conditions||[],this.userData=O.userData,this.props=O.props||{}):(this.component=()=>Promise.resolve(O),this.conditions=[],this.props={}),this._pattern=D,this._keys=x}match(S){if(s){if(typeof s=="string")if(S.startsWith(s))S=S.substr(s.length)||"/";else return null;else if(s instanceof RegExp){const K=S.match(s);if(K&&K[0])S=S.substr(K[0].length)||"/";else return null}}const O=this._pattern.exec(S);if(O===null)return null;if(this._keys===!1)return O;const D={};let x=0;for(;x<this._keys.length;){try{D[this._keys[x]]=decodeURIComponent(O[x+1]||"")||null}catch{D[this._keys[x]]=null}x++}return D}async checkConditions(S){for(let O=0;O<this.conditions.length;O++)if(!await this.conditions[O](S))return!1;return!0}}const l=[];r instanceof Map?r.forEach(($,S)=>{l.push(new o(S,$))}):Object.keys(r).forEach($=>{l.push(new o($,r[$]))});let a=null,c=null,u={};const h=Ys();async function _($,S){await ms(),h($,S)}let p=null,g=null;i&&(g=$=>{$.state&&($.state.__svelte_spa_router_scrollY||$.state.__svelte_spa_router_scrollX)?p=$.state:p=null},window.addEventListener("popstate",g),Vs(()=>{un(p)}));let b=null,v=null;const k=Yt.subscribe(async $=>{b=$;let S=0;for(;S<l.length;){const O=l[S].match($.location);if(!O){S++;continue}const D={route:l[S].path,location:$.location,querystring:$.querystring,userData:l[S].userData,params:O&&typeof O=="object"&&Object.keys(O).length?O:null};if(!await l[S].checkConditions(D)){t(0,a=null),v=null,_("conditionsFailed",D);return}_("routeLoading",Object.assign({},D));const x=l[S].component;if(v!=x){x.loading?(t(0,a=x.loading),v=x,t(1,c=x.loadingParams),t(2,u={}),_("routeLoaded",Object.assign({},D,{component:a,name:a.name,params:c}))):(t(0,a=null),v=null);const K=await x();if($!=b)return;t(0,a=K&&K.default||K),v=x}O&&typeof O=="object"&&Object.keys(O).length?t(1,c=O):t(1,c=null),t(2,u=l[S].props),_("routeLoaded",Object.assign({},D,{component:a,name:a.name,params:c})).then(()=>{vr.set(c)});return}t(0,a=null),v=null,vr.set(void 0)});Ws(()=>{k(),g&&window.removeEventListener("popstate",g)});function C($){pr.call(this,n,$)}function T($){pr.call(this,n,$)}return n.$$set=$=>{"routes"in $&&t(3,r=$.routes),"prefix"in $&&t(4,s=$.prefix),"restoreScrollState"in $&&t(5,i=$.restoreScrollState)},n.$$.update=()=>{n.$$.dirty&32&&(history.scrollRestoration=i?"manual":"auto")},[a,c,u,r,s,i,C,T]}class Xt extends G{constructor(e){super(),J(this,e,hn,an,z,{routes:3,prefix:4,restoreScrollState:5})}}function wr(n){let e;return{c(){e=m("a"),e.textContent="Add book",d(e,"class","nav-link svelte-oup04o"),d(e,"href","./#/add-book")},m(t,r){P(t,e,r)},d(t){t&&A(e)}}}function dn(n){let e,t,r,s,i,o,l,a,c,u,h,_,p,g,b,v,k,C,T,$,S,O,D,x,K,U,H,X,ne,se,le,ue,we,F=n[0]=="staff"&&wr();return{c(){e=m("nav"),t=m("div"),r=m("a"),r.innerHTML=`<i class="bi bi-book"></i> 
      Library System
      <small class="fs-6 text-white-50 ms-2 d-sm-inline d-none">CTADVDBL Project</small>`,s=E(),i=m("button"),i.innerHTML='<span class="navbar-toggler-icon"></span>',o=E(),l=m("div"),a=m("div"),c=m("a"),c.textContent="All Books",u=E(),h=m("a"),h.textContent="Authors",_=E(),p=m("a"),p.textContent="Publishers",g=E(),F&&F.c(),b=E(),v=m("li"),k=m("a"),k.innerHTML='<i class="bi bi-person-fill"></i> Salles',C=E(),T=m("ul"),$=m("li"),$.innerHTML='<a class="dropdown-item disabled svelte-oup04o" href="#">Profile</a>',S=E(),O=m("li"),O.innerHTML='<a class="dropdown-item disabled svelte-oup04o" href="#">Settings</a>',D=E(),x=m("li"),x.innerHTML='<hr class="dropdown-divider"/>',K=E(),U=m("li"),H=m("a"),H.textContent="Log Out",X=E(),ne=m("button"),se=m("span"),d(r,"class","navbar-brand m-0 svelte-oup04o"),d(r,"href","./#/"),d(i,"class","navbar-toggler"),d(i,"type","button"),d(i,"data-bs-toggle","collapse"),d(i,"data-bs-target","#navbarContent"),d(c,"class","nav-link svelte-oup04o"),d(c,"href","./#/search"),d(h,"class","nav-link svelte-oup04o"),d(h,"href","./#/search/author"),d(p,"class","nav-link svelte-oup04o"),d(p,"href","./#/search/publisher"),d(k,"class","nav-link dropdown-toggle svelte-oup04o"),d(k,"href","#"),d(k,"role","button"),d(k,"data-bs-toggle","dropdown"),d(k,"aria-expanded","false"),d(H,"class","dropdown-item text-danger"),d(H,"href","/#/"),d(T,"class","dropdown-menu"),d(v,"class","nav-item dropdown"),d(se,"class",le="bi bi-"+n[1]+" svelte-oup04o"),d(ne,"title","Switch theme"),d(ne,"class","px-1 border-0 bg-transparent nav-link svelte-oup04o"),d(a,"class","navbar-nav ms-auto svelte-oup04o"),d(l,"class","collapse navbar-collapse"),d(l,"id","navbarContent"),d(t,"class","container px-4 fw-semibold"),d(e,"class","navbar navbar-expand-lg bg-primary bg-gradient shadow")},m(Q,ie){P(Q,e,ie),f(e,t),f(t,r),f(t,s),f(t,i),f(t,o),f(t,l),f(l,a),f(a,c),f(a,u),f(a,h),f(a,_),f(a,p),f(a,g),F&&F.m(a,null),f(a,b),f(a,v),f(v,k),f(v,C),f(v,T),f(T,$),f(T,S),f(T,O),f(T,D),f(T,x),f(T,K),f(T,U),f(U,H),f(a,X),f(a,ne),f(ne,se),ue||(we=[pe(H,"click",n[3]),pe(ne,"click",n[2])],ue=!0)},p(Q,[ie]){Q[0]=="staff"?F||(F=wr(),F.c(),F.m(a,b)):F&&(F.d(1),F=null),ie&2&&le!==(le="bi bi-"+Q[1]+" svelte-oup04o")&&d(se,"class",le)},i:j,o:j,d(Q){Q&&A(e),F&&F.d(),ue=!1,ve(we)}}}function fn(n,e,t){let r,s;ct.subscribe(a=>t(0,s=a));let i=localStorage.getItem("theme")||"light";function o(){t(4,i=i=="light"?"dark":"light"),localStorage.setItem("theme",i)}function l(){ct.set(""),localStorage.removeItem("accType")}return n.$$.update=()=>{n.$$.dirty&16&&document.querySelector("body").setAttribute("data-bs-theme",i),n.$$.dirty&16&&t(1,r=i=="dark"?"moon-stars-fill":"brightness-high-fill")},[s,r,o,l,i]}class ws extends G{constructor(e){super(),J(this,e,fn,dn,z,{})}}function _n(n){let e,t,r,s,i,o,l,a,c,u,h,_,p,g,b,v,k,C;return{c(){e=m("section"),t=m("div"),r=m("div"),s=m("div"),i=m("img"),l=E(),a=m("div"),c=m("img"),h=E(),_=m("div"),p=m("img"),b=E(),v=m("button"),v.innerHTML='<span class="carousel-control-prev-icon"></span>',k=E(),C=m("button"),C.innerHTML='<span class="carousel-control-next-icon"></span>',de(i.src,o=Lt)||d(i,"src",o),d(i,"class","d-block w-100"),d(i,"alt","..."),d(s,"class","carousel-item active"),de(c.src,u=Lt)||d(c,"src",u),d(c,"class","d-block w-100"),d(c,"alt","..."),d(a,"class","carousel-item"),de(p.src,g=Lt)||d(p,"src",g),d(p,"class","d-block w-100"),d(p,"alt","..."),d(_,"class","carousel-item"),d(r,"class","carousel-inner"),d(v,"class","carousel-control-prev"),d(v,"type","button"),d(v,"data-bs-target","#homeAdCarousel"),d(v,"data-bs-slide","prev"),d(C,"class","carousel-control-next"),d(C,"type","button"),d(C,"data-bs-target","#homeAdCarousel"),d(C,"data-bs-slide","next"),d(t,"id","homeAdCarousel"),d(t,"class","carousel slide"),d(t,"data-bs-ride","carousel"),d(t,"data-bs-interval","8000")},m(T,$){P(T,e,$),f(e,t),f(t,r),f(r,s),f(s,i),f(r,l),f(r,a),f(a,c),f(r,h),f(r,_),f(_,p),f(t,b),f(t,v),f(t,k),f(t,C)},p:j,i:j,o:j,d(T){T&&A(e)}}}let Lt="./cover.jpg";class pn extends G{constructor(e){super(),J(this,e,null,_n,z,{})}}function mn(n){let e,t,r,s,i,o,l,a,c,u,h,_,p,g;return{c(){e=m("div"),t=m("img"),s=E(),i=m("div"),o=m("h5"),l=m("a"),a=V(n[1]),u=E(),h=m("small"),_=m("i"),p=E(),g=V(n[2]),de(t.src,r="./"+n[0]+".jpg")||d(t,"src",r),d(t,"alt","book cover"),d(t,"class","svelte-1a99e4f"),d(l,"class","stretched-link svelte-1a99e4f"),d(l,"href",c="./#/book/"+n[0]),d(o,"class","card-title"),d(_,"class","bi bi-person"),d(h,"class","card-text"),d(i,"class","card-body"),d(e,"class","card col-md-3 col-6 svelte-1a99e4f")},m(b,v){P(b,e,v),f(e,t),f(e,s),f(e,i),f(i,o),f(o,l),f(l,a),f(i,u),f(i,h),f(h,_),f(h,p),f(h,g)},p(b,[v]){v&1&&!de(t.src,r="./"+b[0]+".jpg")&&d(t,"src",r),v&2&&ee(a,b[1]),v&1&&c!==(c="./#/book/"+b[0])&&d(l,"href",c),v&4&&ee(g,b[2])},i:j,o:j,d(b){b&&A(e)}}}function gn(n,e,t){let{id:r=0}=e,{title:s}=e,{author:i}=e;return n.$$set=o=>{"id"in o&&t(0,r=o.id),"title"in o&&t(1,s=o.title),"author"in o&&t(2,i=o.author)},[r,s,i]}class jt extends G{constructor(e){super(),J(this,e,gn,mn,z,{id:0,title:1,author:2})}}function yr(n){let e;return{c(){e=m("div"),e.innerHTML='<button class="btn btn-outline-primary btn-sm">See All <i class="bi bi-arrow-right"></i></button>',d(e,"class","align-middle align-self-center")},m(t,r){P(t,e,r)},d(t){t&&A(e)}}}function bn(n){let e,t,r,s,i,o,l,a,c,u,h=n[2]!==""&&yr();const _=n[4].default,p=is(_,n,n[3],null);return{c(){e=m("section"),t=m("div"),r=m("h4"),s=m("i"),o=E(),l=V(n[0]),a=E(),h&&h.c(),c=E(),p&&p.c(),d(s,"class",i="bi bi-"+n[1]),d(r,"class","my-3"),d(t,"class","border-bottom border-2 d-flex justify-content-between mb-2")},m(g,b){P(g,e,b),f(e,t),f(t,r),f(r,s),f(r,o),f(r,l),f(t,a),h&&h.m(t,null),f(e,c),p&&p.m(e,null),u=!0},p(g,[b]){(!u||b&2&&i!==(i="bi bi-"+g[1]))&&d(s,"class",i),(!u||b&1)&&ee(l,g[0]),g[2]!==""?h||(h=yr(),h.c(),h.m(t,null)):h&&(h.d(1),h=null),p&&p.p&&(!u||b&8)&&ls(p,_,g,g[3],u?as(_,g[3],b,null):cs(g[3]),null)},i(g){u||(w(p,g),u=!0)},o(g){y(p,g),u=!1},d(g){g&&A(e),h&&h.d(),p&&p.d(g)}}}function vn(n,e,t){let{$$slots:r={},$$scope:s}=e,{title:i}=e,{icon:o}=e,{link:l=""}=e;return n.$$set=a=>{"title"in a&&t(0,i=a.title),"icon"in a&&t(1,o=a.icon),"link"in a&&t(2,l=a.link),"$$scope"in a&&t(3,s=a.$$scope)},[i,o,l,s,r]}class Je extends G{constructor(e){super(),J(this,e,vn,bn,z,{title:0,icon:1,link:2})}}const wn="modulepreload",yn=function(n){return"/library-proj/"+n},kr={},Ve=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.all(t.map(l=>{if(l=yn(l),l in kr)return;kr[l]=!0;const a=l.endsWith(".css"),c=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":wn,a||(u.as="script",u.crossOrigin=""),u.href=l,o&&u.setAttribute("nonce",o),document.head.appendChild(u),a)return new Promise((h,_)=>{u.addEventListener("load",h),u.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${l}`)))})}))}return s.then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},kn=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ve(()=>Promise.resolve().then(()=>ht),void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class Qt extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class $n extends Qt{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Sn extends Qt{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class En extends Qt{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Ft;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Ft||(Ft={}));var Tn=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function a(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(l,a)}c((r=r.apply(n,e||[])).next())})};class jn{constructor(e,{headers:t={},customFetch:r,region:s=Ft.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=kn(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return Tn(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:o}=t;let l={},{region:a}=t;a||(a=this.region),a&&a!=="any"&&(l["x-region"]=a);let c;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",c=o):typeof o=="string"?(l["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(l["Content-Type"]="application/json",c=JSON.stringify(o)));const u=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),s),body:c}).catch(g=>{throw new $n(g)}),h=u.headers.get("x-relay-error");if(h&&h==="true")throw new Sn(u);if(!u.ok)throw new En(u);let _=((r=u.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),p;return _==="application/json"?p=yield u.json():_==="application/octet-stream"?p=yield u.blob():_==="text/event-stream"?p=u:_==="multipart/form-data"?p=yield u.formData():p=yield u.text(),{data:p,error:null}}catch(s){return{data:null,error:s}}})}}var On=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},We=On();const An=We.fetch,Zt=We.fetch.bind(We),ys=We.Headers,Cn=We.Request,Pn=We.Response,ht=Object.freeze(Object.defineProperty({__proto__:null,Headers:ys,Request:Cn,Response:Pn,default:Zt,fetch:An},Symbol.toStringTag,{value:"Module"}));class Rn extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}class In{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Zt:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,l,a;let c=null,u=null,h=null,_=i.status,p=i.statusText;if(i.ok){if(this.method!=="HEAD"){const k=await i.text();k===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=k:u=JSON.parse(k))}const b=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),v=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");b&&v&&v.length>1&&(h=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,_=406,p="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const b=await i.text();try{c=JSON.parse(b),Array.isArray(c)&&i.status===404&&(u=[],c=null,_=200,p="OK")}catch{i.status===404&&b===""?(_=204,p="No Content"):c={message:b}}if(c&&this.isMaybeSingle&&(!((a=c==null?void 0:c.details)===null||a===void 0)&&a.includes("0 rows"))&&(c=null,_=200,p="OK"),c&&this.shouldThrowOnError)throw new Rn(c)}return{error:c,data:u,count:h,status:_,statusText:p}});return this.shouldThrowOnError||(s=s.catch(i=>{var o,l,a;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(a=i==null?void 0:i.code)!==null&&a!==void 0?a:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}}class Ln extends In{select(e){let t=!1;const r=(e??"*").split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:i=s}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){const i=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:i=!1,format:o="text"}={}){var l;const a=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${c}"; options=${a};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class Fe extends Ln{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}}class xn{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=t,this.schema=r,this.fetch=s}select(e,{head:t=!1,count:r}={}){const s=t?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new Fe({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const o=e.reduce((l,a)=>l.concat(Object.keys(a)),[]);if(o.length>0){const l=[...new Set(o)].map(a=>`"${a}"`);this.url.searchParams.set("columns",l.join(","))}}return new Fe({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:i=!0}={}){const o="POST",l=[`resolution=${r?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&l.push(this.headers.Prefer),s&&l.push(`count=${s}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const a=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(a.length>0){const c=[...new Set(a)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Fe({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const r="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new Fe({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new Fe({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const Dn="1.15.2",Un={"X-Client-Info":`postgrest-js/${Dn}`};class er{constructor(e,{headers:t={},schema:r,fetch:s}={}){this.url=e,this.headers=Object.assign(Object.assign({},Un),t),this.schemaName=r,this.fetch=s}from(e){const t=new URL(`${this.url}/${e}`);return new xn(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new er(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:s=!1,count:i}={}){let o;const l=new URL(`${this.url}/rpc/${e}`);let a;r||s?(o=r?"HEAD":"GET",Object.entries(t).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{l.searchParams.append(u,h)})):(o="POST",a=t);const c=Object.assign({},this.headers);return i&&(c.Prefer=`count=${i}`),new Fe({method:o,url:l,headers:c,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}}const Nn="2.9.5",qn={"X-Client-Info":`realtime-js/${Nn}`},Mn="1.0.0",ks=1e4,Bn=1e3;var Ge;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Ge||(Ge={}));var ce;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(ce||(ce={}));var _e;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(_e||(_e={}));var zt;(function(n){n.websocket="websocket"})(zt||(zt={}));var Ce;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Ce||(Ce={}));class $s{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class Fn{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const s=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(e.slice(o,o+s));o=o+s;const a=r.decode(e.slice(o,o+i));o=o+i;const c=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:a,payload:c}}}class xt{constructor(e,t,r={},s=ks){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var $r;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})($r||($r={}));class nt{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=nt.syncState(this.state,s,i,o),this.pendingDiffs.forEach(a=>{this.state=nt.syncDiff(this.state,a,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=nt.syncDiff(this.state,s,i,o),l())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const i=this.cloneDeep(e),o=this.transformState(t),l={},a={};return this.map(i,(c,u)=>{o[c]||(a[c]=u)}),this.map(o,(c,u)=>{const h=i[c];if(h){const _=u.map(v=>v.presence_ref),p=h.map(v=>v.presence_ref),g=u.filter(v=>p.indexOf(v.presence_ref)<0),b=h.filter(v=>_.indexOf(v.presence_ref)<0);g.length>0&&(l[c]=g),b.length>0&&(a[c]=b)}else l[c]=u}),this.syncDiff(i,{joins:l,leaves:a},r,s)}static syncDiff(e,t,r,s){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(l,a)=>{var c;const u=(c=e[l])!==null&&c!==void 0?c:[];if(e[l]=this.cloneDeep(a),u.length>0){const h=e[l].map(p=>p.presence_ref),_=u.filter(p=>h.indexOf(p.presence_ref)<0);e[l].unshift(..._)}r(l,u,a)}),this.map(o,(l,a)=>{let c=e[l];if(!c)return;const u=a.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[l]=c,s(l,c,a),c.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var B;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(B||(B={}));const Sr=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,o)=>(i[o]=zn(o,n,e,s),i),{})},zn=(n,e,t,r)=>{const s=e.find(l=>l.name===n),i=s==null?void 0:s.type,o=t[n];return i&&!r.includes(i)?Ss(i,o):Ht(o)},Ss=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return Kn(e,t)}switch(n){case B.bool:return Hn(e);case B.float4:case B.float8:case B.int2:case B.int4:case B.int8:case B.numeric:case B.oid:return Jn(e);case B.json:case B.jsonb:return Gn(e);case B.timestamp:return Vn(e);case B.abstime:case B.date:case B.daterange:case B.int4range:case B.int8range:case B.money:case B.reltime:case B.text:case B.time:case B.timestamptz:case B.timetz:case B.tsrange:case B.tstzrange:return Ht(e);default:return Ht(e)}},Ht=n=>n,Hn=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},Jn=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},Gn=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},Kn=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let i;const o=n.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>Ss(e,l))}return n},Vn=n=>typeof n=="string"?n.replace(" ","T"):n;var Er;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Er||(Er={}));var Tr;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes"})(Tr||(Tr={}));var jr;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(jr||(jr={}));class tr{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=ce.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},t.config),this.timeout=this.socket.timeout,this.joinPush=new xt(this,_e.join,this.params,this.timeout),this.rejoinTimer=new $s(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ce.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ce.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=ce.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ce.errored,this.rejoinTimer.scheduleTimeout())}),this._on(_e.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new nt(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(e,t=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:o}}=this.params;this._onError(c=>e&&e("CHANNEL_ERROR",c)),this._onClose(()=>e&&e("CLOSED"));const l={},a={broadcast:i,presence:o,postgres_changes:(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(c=>c.filter))!==null&&s!==void 0?s:[]};this.socket.accessToken&&(l.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:a},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",({postgres_changes:c})=>{var u;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),c===void 0){e&&e("SUBSCRIBED");return}else{const h=this.bindings.postgres_changes,_=(u=h==null?void 0:h.length)!==null&&u!==void 0?u:0,p=[];for(let g=0;g<_;g++){const b=h[g],{filter:{event:v,schema:k,table:C,filter:T}}=b,$=c&&c[g];if($&&$.event===v&&$.schema===k&&$.table===C&&$.filter===T)p.push(Object.assign(Object.assign({},b),{id:$.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,e&&e("SUBSCRIBED");return}}).receive("error",c=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,l={method:"POST",headers:{apikey:(r=this.socket.apiKey)!==null&&r!==void 0?r:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o}]})};try{return(await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=t.timeout)!==null&&s!==void 0?s:this.timeout)).ok?"ok":"error"}catch(a){return a.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,a;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((a=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||a===void 0)&&a.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ce.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(_e.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const s=new xt(this,_e.leave,{},e);s.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}_broadcastEndpointURL(){let e=this.socket.endPoint;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(e,t,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),o}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new xt(this,e,t,r);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,i;const o=e.toLocaleLowerCase(),{close:l,error:a,leave:c,join:u}=_e;if(r&&[l,a,c,u].indexOf(o)>=0&&r!==this._joinRef())return;let _=this._onMessage(o,t,r);if(t&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(p=>{var g,b,v;return((g=p.filter)===null||g===void 0?void 0:g.event)==="*"||((v=(b=p.filter)===null||b===void 0?void 0:b.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===o}).map(p=>p.callback(_,r)):(i=this.bindings[o])===null||i===void 0||i.filter(p=>{var g,b,v,k,C,T;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const $=p.id,S=(g=p.filter)===null||g===void 0?void 0:g.event;return $&&((b=t.ids)===null||b===void 0?void 0:b.includes($))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((v=t.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const $=(C=(k=p==null?void 0:p.filter)===null||k===void 0?void 0:k.event)===null||C===void 0?void 0:C.toLocaleLowerCase();return $==="*"||$===((T=t==null?void 0:t.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof _=="object"&&"ids"in _){const g=_.data,{schema:b,table:v,commit_timestamp:k,type:C,errors:T}=g;_=Object.assign(Object.assign({},{schema:b,table:v,commit_timestamp:k,eventType:C,new:{},old:{},errors:T}),this._getPayloadRecords(g))}p.callback(_,r)})}_isClosed(){return this.state===ce.closed}_isJoined(){return this.state===ce.joined}_isJoining(){return this.state===ce.joining}_isLeaving(){return this.state===ce.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&tr.isEqual(s.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(_e.close,{},e)}_onError(e){this._on(_e.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ce.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Sr(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Sr(e.columns,e.old_record)),t}}const Wn=()=>{},Yn=typeof WebSocket<"u";class Xn{constructor(e,t){var r;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.headers=qn,this.params={},this.timeout=ks,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Wn,this.conn=null,this.sendBuffer=[],this.serializer=new Fn,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...l)=>Ve(()=>Promise.resolve().then(()=>ht),void 0).then(({default:a})=>a(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${e}/${zt.websocket}`,t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const s=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;s&&(this.accessToken=s,this.apiKey=s),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,o)=>o(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new $s(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(Yn){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new Qn(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),Ve(()=>import("./browser-BImCA5dO.js").then(e=>e.b),[]).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Ge.connecting:return Ce.Connecting;case Ge.open:return Ce.Open;case Ge.closing:return Ce.Closing;default:return Ce.Closed}}isConnected(){return this.connectionState()===Ce.Open}channel(e,t={config:{}}){const r=new tr(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){const{topic:t,event:r,payload:s,ref:i}=e,o=()=>{this.encode(e,l=>{var a;(a=this.conn)===null||a===void 0||a.send(l)})};this.log("push",`${t} ${r} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(e){this.accessToken=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(_e.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Mn}))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:s,payload:i,ref:o}=t;(o&&o===this.pendingHeartbeatRef||s===(i==null?void 0:i.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${s} ${o&&"("+o+")"||""}`,i),this.channels.filter(l=>l._isMember(r)).forEach(l=>l._trigger(s,i,o)),this.stateChangeCallbacks.message.forEach(l=>l(t))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(_e.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(Bn,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class Qn{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Ge.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class rr extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function te(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class Zn extends rr{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Or extends rr{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var ei=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function a(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(l,a)}c((r=r.apply(n,e||[])).next())})};const Es=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ve(()=>Promise.resolve().then(()=>ht),void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},ti=()=>ei(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ve(()=>Promise.resolve().then(()=>ht),void 0)).Response:Response});var Qe=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function a(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(l,a)}c((r=r.apply(n,e||[])).next())})};const Dt=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),ri=(n,e)=>Qe(void 0,void 0,void 0,function*(){const t=yield ti();n instanceof t?n.json().then(r=>{e(new Zn(Dt(r),n.status||500))}).catch(r=>{e(new Or(Dt(r),r))}):e(new Or(Dt(n),n))}),si=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};function Ot(n,e,t,r,s,i){return Qe(this,void 0,void 0,function*(){return new Promise((o,l)=>{n(t,si(e,r,s,i)).then(a=>{if(!a.ok)throw a;return r!=null&&r.noResolveJson?a:a.json()}).then(a=>o(a)).catch(a=>ri(a,l))})})}function Jt(n,e,t,r){return Qe(this,void 0,void 0,function*(){return Ot(n,"GET",e,t,r)})}function ke(n,e,t,r,s){return Qe(this,void 0,void 0,function*(){return Ot(n,"POST",e,r,s,t)})}function ni(n,e,t,r,s){return Qe(this,void 0,void 0,function*(){return Ot(n,"PUT",e,r,s,t)})}function Ts(n,e,t,r,s){return Qe(this,void 0,void 0,function*(){return Ot(n,"DELETE",e,r,s,t)})}var he=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function a(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(l,a)}c((r=r.apply(n,e||[])).next())})};const ii={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ar={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class oi{constructor(e,t={},r,s){this.url=e,this.headers=t,this.bucketId=r,this.fetch=Es(s)}uploadOrUpdate(e,t,r,s){return he(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Ar),s),l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl)):(i=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType);const a=this._removeEmptyFolders(t),c=this._getFinalPath(a),u=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:i,headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{})),h=yield u.json();return u.ok?{data:{path:a,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(i){if(te(i))return{data:null,error:i};throw i}})}upload(e,t,r){return he(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return he(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let a;const c=Object.assign({upsert:Ar.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",c.cacheControl),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.append("cacheControl",c.cacheControl)):(a=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield this.fetch(l.toString(),{method:"PUT",body:a,headers:u}),_=yield h.json();return h.ok?{data:{path:i,fullPath:_.Key},error:null}:{data:null,error:_}}catch(a){if(te(a))return{data:null,error:a};throw a}})}createSignedUploadUrl(e){return he(this,void 0,void 0,function*(){try{let t=this._getFinalPath(e);const r=yield ke(this.fetch,`${this.url}/object/upload/sign/${t}`,{},{headers:this.headers}),s=new URL(this.url+r.url),i=s.searchParams.get("token");if(!i)throw new rr("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:i},error:null}}catch(t){if(te(t))return{data:null,error:t};throw t}})}update(e,t,r){return he(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t){return he(this,void 0,void 0,function*(){try{return{data:yield ke(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers}),error:null}}catch(r){if(te(r))return{data:null,error:r};throw r}})}copy(e,t){return he(this,void 0,void 0,function*(){try{return{data:{path:(yield ke(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers})).Key},error:null}}catch(r){if(te(r))return{data:null,error:r};throw r}})}createSignedUrl(e,t,r){return he(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield ke(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(te(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return he(this,void 0,void 0,function*(){try{const s=yield ke(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(te(s))return{data:null,error:s};throw s}})}download(e,t){return he(this,void 0,void 0,function*(){const s=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield Jt(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(te(l))return{data:null,error:l};throw l}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&s.push(i);const l=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});a!==""&&s.push(a);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${c}`)}}}remove(e){return he(this,void 0,void 0,function*(){try{return{data:yield Ts(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(te(t))return{data:null,error:t};throw t}})}list(e,t,r){return he(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},ii),t),{prefix:e||""});return{data:yield ke(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(te(s))return{data:null,error:s};throw s}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const ai="2.5.5",li={"X-Client-Info":`storage-js/${ai}`};var Ne=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function a(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(l,a)}c((r=r.apply(n,e||[])).next())})};class ci{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},li),t),this.fetch=Es(r)}listBuckets(){return Ne(this,void 0,void 0,function*(){try{return{data:yield Jt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(te(e))return{data:null,error:e};throw e}})}getBucket(e){return Ne(this,void 0,void 0,function*(){try{return{data:yield Jt(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(te(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Ne(this,void 0,void 0,function*(){try{return{data:yield ke(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(te(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return Ne(this,void 0,void 0,function*(){try{return{data:yield ni(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(te(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Ne(this,void 0,void 0,function*(){try{return{data:yield ke(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(te(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Ne(this,void 0,void 0,function*(){try{return{data:yield Ts(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(te(t))return{data:null,error:t};throw t}})}}class ui extends ci{constructor(e,t={},r){super(e,t,r)}from(e){return new oi(this.url,this.headers,e,this.fetch)}}const hi="2.43.2";let rt="";typeof Deno<"u"?rt="deno":typeof document<"u"?rt="web":typeof navigator<"u"&&navigator.product==="ReactNative"?rt="react-native":rt="node";const di={"X-Client-Info":`supabase-js-${rt}/${hi}`},fi={headers:di},_i={schema:"public"},pi={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},mi={};var gi=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function a(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(l,a)}c((r=r.apply(n,e||[])).next())})};const bi=n=>{let e;return n?e=n:typeof fetch>"u"?e=Zt:e=fetch,(...t)=>e(...t)},vi=()=>typeof Headers>"u"?ys:Headers,wi=(n,e,t)=>{const r=bi(t),s=vi();return(i,o)=>gi(void 0,void 0,void 0,function*(){var l;const a=(l=yield e())!==null&&l!==void 0?l:n;let c=new s(o==null?void 0:o.headers);return c.has("apikey")||c.set("apikey",n),c.has("Authorization")||c.set("Authorization",`Bearer ${a}`),r(i,Object.assign(Object.assign({},o),{headers:c}))})};function yi(n){return n.replace(/\/$/,"")}function ki(n,e){const{db:t,auth:r,realtime:s,global:i}=n,{db:o,auth:l,realtime:a,global:c}=e;return{db:Object.assign(Object.assign({},o),t),auth:Object.assign(Object.assign({},l),r),realtime:Object.assign(Object.assign({},a),s),global:Object.assign(Object.assign({},c),i)}}const js="2.64.2",$i="http://localhost:9999",Si="supabase.auth.token",Ei={"X-Client-Info":`gotrue-js/${js}`},Cr=10,Gt="X-Supabase-Api-Version",Os={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function Ti(n){return Math.round(Date.now()/1e3)+n}function ji(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const fe=()=>typeof document<"u",Te={tested:!1,writable:!1},it=()=>{if(!fe())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Te.tested)return Te.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Te.tested=!0,Te.writable=!0}catch{Te.tested=!0,Te.writable=!1}return Te.writable};function Ut(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}const As=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ve(()=>Promise.resolve().then(()=>ht),void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Oi=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Cs=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},_t=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Nt=async(n,e)=>{await n.removeItem(e)};function Ai(n){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",r,s,i,o,l,a,c,u=0;for(n=n.replace("-","+").replace("_","/");u<n.length;)o=e.indexOf(n.charAt(u++)),l=e.indexOf(n.charAt(u++)),a=e.indexOf(n.charAt(u++)),c=e.indexOf(n.charAt(u++)),r=o<<2|l>>4,s=(l&15)<<4|a>>2,i=(a&3)<<6|c,t=t+String.fromCharCode(r),a!=64&&s!=0&&(t=t+String.fromCharCode(s)),c!=64&&i!=0&&(t=t+String.fromCharCode(i));return t}class At{constructor(){this.promise=new At.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}At.promiseConstructor=Promise;function Pr(n){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=n.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=t[1];return JSON.parse(Ai(r))}async function Ci(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function Pi(n,e){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await n(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){s(o);return}}})()})}function Ri(n){return("0"+n.toString(16)).substr(-2)}function Ii(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let i=0;i<56;i++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,Ri).join("")}async function Li(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}function xi(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Di(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await Li(n);return xi(t)}async function qe(n,e,t=!1){const r=Ii();let s=r;t&&(s+="/PASSWORD_RECOVERY"),await Cs(n,`${e}-code-verifier`,s);const i=await Di(r);return[i,r===i?"plain":"s256"]}const Ui=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Ni(n){const e=n.headers.get(Gt);if(!e||!e.match(Ui))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class sr extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function N(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class qi extends sr{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function Mi(n){return N(n)&&n.name==="AuthApiError"}class Ps extends sr{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Re extends sr{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class je extends Re{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class qt extends Re{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class pt extends Re{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class mt extends Re{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Rr extends Re{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Kt extends Re{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Mt(n){return N(n)&&n.name==="AuthRetryableFetchError"}class Ir extends Re{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}var Bi=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};const Ae=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Fi=[502,503,504];async function Lr(n){var e;if(!Oi(n))throw new Kt(Ae(n),0);if(Fi.includes(n.status))throw new Kt(Ae(n),n.status);let t;try{t=await n.json()}catch(i){throw new Ps(Ae(i),i)}let r;const s=Ni(n);if(s&&s.getTime()>=Os["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new Ir(Ae(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[])}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Ir(Ae(t),n.status,t.weak_password.reasons);throw new qi(Ae(t),n.status||500,r)}const zi=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function q(n,e,t,r){var s;const i=Object.assign({},r==null?void 0:r.headers);i[Gt]||(i[Gt]=Os["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",a=await Hi(n,e,t+l,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(a):{data:Object.assign({},a),error:null}}async function Hi(n,e,t,r,s,i){const o=zi(e,r,s,i);let l;try{l=await n(t,Object.assign({},o))}catch(a){throw console.error(a),new Kt(Ae(a),0)}if(l.ok||await Lr(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(a){await Lr(a)}}function ye(n){var e;let t=null;Vi(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=Ti(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function xr(n){const e=ye(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Se(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function Ji(n){return{data:n,error:null}}function Gi(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i}=n,o=Bi(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i},a=Object.assign({},o);return{data:{properties:l,user:a},error:null}}function Ki(n){return n}function Vi(n){return n.access_token&&n.refresh_token&&n.expires_in}var Wi=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};class Yi{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=As(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await q(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(N(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await q(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Se})}catch(r){if(N(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Wi(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await q(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:Gi,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(N(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await q(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Se})}catch(t){if(N(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,i,o,l,a;try{const c={nextPage:null,lastPage:0,total:0},u=await q(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Ki});if(u.error)throw u.error;const h=await u.json(),_=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(a=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&a!==void 0?a:[];return p.length>0&&(p.forEach(g=>{const b=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(g.split(";")[1].split("=")[1]);c[`${v}Page`]=b}),c.total=parseInt(_)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(N(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await q(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Se})}catch(t){if(N(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await q(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Se})}catch(r){if(N(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){try{return await q(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Se})}catch(r){if(N(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await q(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(N(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await q(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(N(t))return{data:null,error:t};throw t}}}const Xi={getItem:n=>it()?globalThis.localStorage.getItem(n):null,setItem:(n,e)=>{it()&&globalThis.localStorage.setItem(n,e)},removeItem:n=>{it()&&globalThis.localStorage.removeItem(n)}};function Dr(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function Qi(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Me={debug:!!(globalThis&&it()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Rs extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Zi extends Rs{}async function eo(n,e,t){Me.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Me.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){Me.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{Me.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw Me.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Zi(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Me.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}})}Qi();const to={url:$i,storageKey:Si,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ei,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},tt=30*1e3,Ur=3;async function Nr(n,e,t){return await t()}class ut{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ut.nextInstanceID,ut.nextInstanceID+=1,this.instanceID>0&&fe()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},to),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Yi({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=As(s.fetch),this.lock=s.lock||Nr,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:fe()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=eo:this.lock=Nr,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:it()?this.storage=Xi:(this.memoryStorage={},this.storage=Dr(this.memoryStorage)):(this.memoryStorage={},this.storage=Dr(this.memoryStorage)),fe()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${js}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=fe()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:t,error:r}=await this._getSessionFromURL(e);if(r)return this._debug("#_initialize()","error detecting session from URL",r),(r==null?void 0:r.message)==="Identity is already linked"||(r==null?void 0:r.message)==="Identity is already linked to another user"?{error:r}:(await this._removeSession(),{error:r});const{session:s,redirectType:i}=t;return this._debug("#_initialize()","detected session in URL",s,"redirect type",i),await this._saveSession(s),setTimeout(async()=>{i==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return N(e)?{error:e}:{error:new Ps("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{await this._removeSession();const i=await q(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:ye}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:c,session:a},error:null}}catch(i){if(N(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,r,s;try{await this._removeSession();let i;if("email"in e){const{email:u,password:h,options:_}=e;let p=null,g=null;this.flowType==="pkce"&&([p,g]=await qe(this.storage,this.storageKey)),i=await q(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:_==null?void 0:_.emailRedirectTo,body:{email:u,password:h,data:(t=_==null?void 0:_.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken},code_challenge:p,code_challenge_method:g},xform:ye})}else if("phone"in e){const{phone:u,password:h,options:_}=e;i=await q(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(r=_==null?void 0:_.data)!==null&&r!==void 0?r:{},channel:(s=_==null?void 0:_.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken}},xform:ye})}else throw new pt("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:c,session:a},error:null}}catch(i){if(N(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{await this._removeSession();let t;if("email"in e){const{email:i,password:o,options:l}=e;t=await q(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:xr})}else if("phone"in e){const{phone:i,password:o,options:l}=e;t=await q(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:xr})}else throw new pt("You must provide either an email or phone number and a password");const{data:r,error:s}=t;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new qt}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(N(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,s,i;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await _t(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(t??"").split("/"),{data:i,error:o}=await q(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:ye});return await Nt(this.storage,`${this.storageKey}-code-verifier`),o?{data:{user:null,session:null,redirectType:null},error:o}:!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new qt}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}async signInWithIdToken(e){await this._removeSession();try{const{options:t,provider:r,token:s,access_token:i,nonce:o}=e,l=await q(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:ye}),{data:a,error:c}=l;return c?{data:{user:null,session:null},error:c}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new qt}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:c})}catch(t){if(N(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,s,i,o;try{if(await this._removeSession(),"email"in e){const{email:l,options:a}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await qe(this.storage,this.storageKey));const{error:h}=await q(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=a==null?void 0:a.data)!==null&&t!==void 0?t:{},create_user:(r=a==null?void 0:a.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:a}=e,{data:c,error:u}=await q(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=a==null?void 0:a.data)!==null&&s!==void 0?s:{},create_user:(i=a==null?void 0:a.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},channel:(o=a==null?void 0:a.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new pt("You must provide either an email or phone number.")}catch(l){if(N(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var t,r;try{e.type!=="email_change"&&e.type!=="phone_change"&&await this._removeSession();let s,i;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await q(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:ye});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const a=o.session,c=o.user;return a!=null&&a.access_token&&(await this._saveSession(a),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:c,session:a},error:null}}catch(s){if(N(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,r,s;try{await this._removeSession();let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await qe(this.storage,this.storageKey)),await q(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Ji})}catch(i){if(N(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new je;const{error:s}=await q(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(N(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{e.type!="email_change"&&e.type!="phone_change"&&await this._removeSession();const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:i}=e,{error:o}=await q(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:s,options:i}=e,{data:o,error:l}=await q(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new pt("You must provide either an email or phone number and a type")}catch(t){if(N(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await _t(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){const o=this.suppressGetSessionWarning;e=new Proxy(e,{get(a,c,u){return!o&&c==="user"&&console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),Reflect.get(a,c,u)}})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await q(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Se}):await this._useSession(async t=>{var r,s,i;const{data:o,error:l}=t;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new je}:await q(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Se})})}catch(t){if(N(t))return{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new je;const o=s.session;let l=null,a=null;this.flowType==="pkce"&&e.email!=null&&([l,a]=await qe(this.storage,this.storageKey));const{data:c,error:u}=await q(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:a}),jwt:o.access_token,xform:Se});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(N(r))return{data:{user:null},error:r};throw r}}_decodeJWT(e){return Pr(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new je;const t=Date.now()/1e3;let r=t,s=!0,i=null;const o=Pr(e.access_token);if(o.exp&&(r=o.exp,s=r<=t),s){const{session:l,error:a}=await this._callRefreshToken(e.refresh_token);if(a)return{data:{user:null,session:null},error:a};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:a}=await this._getUser(e.access_token);if(a)throw a;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(N(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new je;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(N(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e){try{if(!fe())throw new mt("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new mt("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new Rr("Not a valid PKCE flow url.");const t=Ut(window.location.href);if(e){if(!t.code)throw new Rr("No code detected.");const{data:C,error:T}=await this._exchangeCodeForSession(t.code);if(T)throw T;const $=new URL(window.location.href);return $.searchParams.delete("code"),window.history.replaceState(window.history.state,"",$.toString()),{data:{session:C.session,redirectType:null},error:null}}if(t.error||t.error_description||t.error_code)throw new mt(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:l,expires_at:a,token_type:c}=t;if(!i||!l||!o||!c)throw new mt("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let _=u+h;a&&(_=parseInt(a));const p=_-u;p*1e3<=tt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const g=_-h;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,_,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",g,_,u);const{data:b,error:v}=await this._getUser(i);if(v)throw v;const k={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:_,refresh_token:o,token_type:c,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:k,redirectType:t.type},error:null}}catch(t){if(N(t))return{data:{session:null,redirectType:null},error:t};throw t}}_isImplicitGrantFlow(){const e=Ut(window.location.href);return!!(fe()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=Ut(window.location.href),t=await _t(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{error:i};const o=(r=s.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(Mi(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Nt(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const t=ji(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:i},error:o}=t;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await qe(this.storage,this.storageKey,!0));try{return await q(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(N(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(N(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:s}=await this._useSession(async i=>{var o,l,a,c,u;const{data:h,error:_}=i;if(_)throw _;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:!0});return await q(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return fe()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(N(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:o}=t;if(o)throw o;return await q(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(N(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await Pi(async s=>(s>0&&await Ci(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await q(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ye})),(s,i)=>{const o=200*Math.pow(2,s);return i&&Mt(i)&&Date.now()+o-r<tt})}catch(r){if(this._debug(t,"error",r),N(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),fe()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await _t(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),r!==null&&await this._removeSession();return}const s=Math.round(Date.now()/1e3),i=((e=r.expires_at)!==null&&e!==void 0?e:1/0)<s+Cr;if(this._debug(t,`session has${i?"":" not"} expired with margin of ${Cr}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:o}=await this._callRefreshToken(r.refresh_token);o&&(console.error(o),Mt(o)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(t,"error",r),console.error(r);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new je;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new At;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new je;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(s,"error",i),N(i)){const o={session:null,error:i};return Mt(i)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(a){i.push(a)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Cs(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Nt(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&fe()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),tt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/tt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${tt}ms, refresh threshold is ${Ur} ticks`),s<=Ur&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Rs)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!fe()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await qe(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await q(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(N(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:o}=t;if(o)return{data:null,error:o};const{data:l,error:a}=await q(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return a?{data:null,error:a}:(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(N(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{data:null,error:i};const{data:o,error:l}=await q(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(t){if(N(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await q(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(N(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],s=r.filter(i=>i.factor_type==="totp"&&i.status==="verified");return{data:{all:r,totp:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const o=this._decodeJWT(s.access_token);let l=null;o.aal&&(l=o.aal);let a=l;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(a="aal2");const u=o.amr||[];return{data:{currentLevel:l,nextLevel:a,currentAuthenticationMethods:u},error:null}}))}}ut.nextInstanceID=0;const ro=ut;class so extends ro{constructor(e){super(e)}}var no=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{c(r.next(u))}catch(h){o(h)}}function a(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(l,a)}c((r=r.apply(n,e||[])).next())})};class io{constructor(e,t,r){var s,i,o,l,a,c,u,h;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const _=yi(e);this.realtimeUrl=`${_}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${_}/auth/v1`,this.storageUrl=`${_}/storage/v1`,this.functionsUrl=`${_}/functions/v1`;const p=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,g={db:_i,realtime:mi,auth:Object.assign(Object.assign({},pi),{storageKey:p}),global:fi},b=ki(r??{},g);this.storageKey=(i=(s=b.auth)===null||s===void 0?void 0:s.storageKey)!==null&&i!==void 0?i:"",this.headers=(l=(o=b.global)===null||o===void 0?void 0:o.headers)!==null&&l!==void 0?l:{},this.auth=this._initSupabaseAuthClient((a=b.auth)!==null&&a!==void 0?a:{},this.headers,(c=b.global)===null||c===void 0?void 0:c.fetch),this.fetch=wi(t,this._getAccessToken.bind(this),(u=b.global)===null||u===void 0?void 0:u.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},b.realtime)),this.rest=new er(`${_}/rest/v1`,{headers:this.headers,schema:(h=b.db)===null||h===void 0?void 0:h.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new jn(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new ui(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return no(this,void 0,void 0,function*(){const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,storageKey:i,flowType:o,debug:l},a,c){var u;const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new so({url:this.authUrl,headers:Object.assign(Object.assign({},h),a),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,flowType:o,debug:l,fetch:c,hasCustomAuthorizationHeader:(u="Authorization"in this.headers)!==null&&u!==void 0?u:!1})}_initRealtimeClient(e){return new Xn(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.realtime.setAuth(r??null),this.changedAccessToken=r):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const oo=(n,e,t)=>new io(n,e,t),be=oo("https://oatzrwezibkcabfwxppo.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9hdHpyd2V6aWJrY2FiZnd4cHBvIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTcxMzYwOTE3MSwiZXhwIjoyMDI5MTg1MTcxfQ.u2HUJZ-hGi8Jk97FWI-hiQ3NpyMMM7V6hHQaL_Gvx1s");function Ze(n,{delay:e=0,duration:t=400,easing:r=rs}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:r,css:i=>`opacity: ${i*s}`}}function ao(n){let e;return{c(){e=m("div"),e.innerHTML='<div class="spinner-grow text-primary m-5" role="status"></div>',d(e,"class","d-flex justify-content-center")},m(t,r){P(t,e,r)},p:j,i:j,o:j,d(t){t&&A(e)}}}class Ie extends G{constructor(e){super(),J(this,e,null,ao,z,{})}}function lo(n){let e,t,r,s,i,o,l,a,c;return{c(){e=m("div"),t=m("img"),s=E(),i=m("div"),o=m("h6"),l=m("a"),a=V(n[0]),d(t,"class","object-fit-contain rounded my-2"),d(t,"height","150"),de(t.src,r="./default-profile.jpg")||d(t,"src",r),d(t,"alt","author"),d(l,"class","stretched-link svelte-1rzxrzv"),d(l,"href",c="./#/author/"+n[1]),d(o,"class","card-title text-center"),d(i,"class","card-body p-1"),d(e,"class","card col-md-2 col-4 border-1 svelte-1rzxrzv")},m(u,h){P(u,e,h),f(e,t),f(e,s),f(e,i),f(i,o),f(o,l),f(l,a)},p(u,[h]){h&1&&ee(a,u[0]),h&2&&c!==(c="./#/author/"+u[1])&&d(l,"href",c)},i:j,o:j,d(u){u&&A(e)}}}function co(n,e,t){let{name:r}=e,{id:s}=e;return n.$$set=i=>{"name"in i&&t(0,r=i.name),"id"in i&&t(1,s=i.id)},[r,s]}class Is extends G{constructor(e){super(),J(this,e,co,lo,z,{name:0,id:1})}}function uo(n){let e,t,r,s,i,o,l,a,c;return{c(){e=m("div"),t=m("img"),s=E(),i=m("div"),o=m("h6"),l=m("a"),a=V(n[0]),d(t,"class","object-fit-contain rounded my-2"),d(t,"height","150"),de(t.src,r="./default-profile.jpg")||d(t,"src",r),d(t,"alt","publisher"),d(l,"class","stretched-link svelte-1rzxrzv"),d(l,"href",c="./#/publisher/"+n[1]),d(o,"class","card-title text-center"),d(i,"class","card-body p-1"),d(e,"class","card col-md-2 col-4 border-1 svelte-1rzxrzv")},m(u,h){P(u,e,h),f(e,t),f(e,s),f(e,i),f(i,o),f(o,l),f(l,a)},p(u,[h]){h&1&&ee(a,u[0]),h&2&&c!==(c="./#/publisher/"+u[1])&&d(l,"href",c)},i:j,o:j,d(u){u&&A(e)}}}function ho(n,e,t){let{name:r}=e,{id:s}=e;return n.$$set=i=>{"name"in i&&t(0,r=i.name),"id"in i&&t(1,s=i.id)},[r,s]}class Ls extends G{constructor(e){super(),J(this,e,ho,uo,z,{name:0,id:1})}}function fo(n){let e,t,r,s,i,o,l,a,c,u;return{c(){e=m("div"),t=m("div"),r=m("h2"),r.textContent="Error",s=E(),i=m("p"),o=V(n[0]),l=V(": "),a=V(n[1]),c=E(),u=m("a"),u.textContent="Reload",d(u,"href","/#/"),d(u,"class","fw-bold"),d(t,"class","text-center"),d(e,"class","d-flex align-items-center justify-content-center my-3")},m(h,_){P(h,e,_),f(e,t),f(t,r),f(t,s),f(t,i),f(i,o),f(i,l),f(i,a),f(t,c),f(t,u)},p(h,[_]){_&1&&ee(o,h[0]),_&2&&ee(a,h[1])},i:j,o:j,d(h){h&&A(e)}}}function _o(n,e,t){let{code:r="err"}=e,{message:s}=e;return n.$$set=i=>{"code"in i&&t(0,r=i.code),"message"in i&&t(1,s=i.message)},[r,s]}let nr=class extends G{constructor(e){super(),J(this,e,_o,fo,z,{code:0,message:1})}};function qr(n,e,t){const r=n.slice();return r[9]=e[t][0],r[10]=e[t][1],r}function Mr(n,e,t){const r=n.slice();return r[9]=e[t][0],r[13]=e[t][1],r}function Br(n,e,t){const r=n.slice();return r[9]=e[t][0],r[16]=e[t][1],r}function po(n){let e,t;return e=new Ie({}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p:j,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function mo(n){let e,t;return e=new nr({props:{message:n[3]}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&8&&(i.message=r[3]),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function go(n){let e,t,r=re(Object.entries(n[0])),s=[];for(let o=0;o<r.length;o+=1)s[o]=Fr(Br(n,r,o));const i=o=>y(s[o],1,1,()=>{s[o]=null});return{c(){e=m("div");for(let o=0;o<s.length;o+=1)s[o].c();d(e,"class","row justify-content-around")},m(o,l){P(o,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(o,l){if(l&1){r=re(Object.entries(o[0]));let a;for(a=0;a<r.length;a+=1){const c=Br(o,r,a);s[a]?(s[a].p(c,l),w(s[a],1)):(s[a]=Fr(c),s[a].c(),w(s[a],1),s[a].m(e,null))}for(W(),a=r.length;a<s.length;a+=1)i(a);Y()}},i(o){if(!t){for(let l=0;l<r.length;l+=1)w(s[l]);t=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)y(s[l]);t=!1},d(o){o&&A(e),Ee(s,o)}}}function Fr(n){let e,t;return e=new jt({props:{title:n[16].title,id:n[16].id,author:n[16].author}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&1&&(i.title=r[16].title),s&1&&(i.id=r[16].id),s&1&&(i.author=r[16].author),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function bo(n){let e,t,r,s;const i=[go,mo,po],o=[];function l(a,c){return a[0]?0:a[3]?1:2}return e=l(n),t=o[e]=i[e](n),{c(){t.c(),r=me()},m(a,c){o[e].m(a,c),P(a,r,c),s=!0},p(a,c){let u=e;e=l(a),e===u?o[e].p(a,c):(W(),y(o[u],1,1,()=>{o[u]=null}),Y(),t=o[e],t?t.p(a,c):(t=o[e]=i[e](a),t.c()),w(t,1),t.m(r.parentNode,r))},i(a){s||(w(t),s=!0)},o(a){y(t),s=!1},d(a){a&&A(r),o[e].d(a)}}}function vo(n){let e,t;return e=new Ie({}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p:j,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function wo(n){let e,t;return e=new nr({props:{message:n[4]}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&16&&(i.message=r[4]),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function yo(n){let e,t,r=re(Object.entries(n[1])),s=[];for(let o=0;o<r.length;o+=1)s[o]=zr(Mr(n,r,o));const i=o=>y(s[o],1,1,()=>{s[o]=null});return{c(){e=m("div");for(let o=0;o<s.length;o+=1)s[o].c();d(e,"class","row justify-content-around")},m(o,l){P(o,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(o,l){if(l&2){r=re(Object.entries(o[1]));let a;for(a=0;a<r.length;a+=1){const c=Mr(o,r,a);s[a]?(s[a].p(c,l),w(s[a],1)):(s[a]=zr(c),s[a].c(),w(s[a],1),s[a].m(e,null))}for(W(),a=r.length;a<s.length;a+=1)i(a);Y()}},i(o){if(!t){for(let l=0;l<r.length;l+=1)w(s[l]);t=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)y(s[l]);t=!1},d(o){o&&A(e),Ee(s,o)}}}function zr(n){let e,t;return e=new Is({props:{id:n[13].id,name:n[13].name}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&2&&(i.id=r[13].id),s&2&&(i.name=r[13].name),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function ko(n){let e,t,r,s;const i=[yo,wo,vo],o=[];function l(a,c){return a[1]?0:a[4]?1:2}return e=l(n),t=o[e]=i[e](n),{c(){t.c(),r=me()},m(a,c){o[e].m(a,c),P(a,r,c),s=!0},p(a,c){let u=e;e=l(a),e===u?o[e].p(a,c):(W(),y(o[u],1,1,()=>{o[u]=null}),Y(),t=o[e],t?t.p(a,c):(t=o[e]=i[e](a),t.c()),w(t,1),t.m(r.parentNode,r))},i(a){s||(w(t),s=!0)},o(a){y(t),s=!1},d(a){a&&A(r),o[e].d(a)}}}function $o(n){let e,t;return e=new Ie({}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p:j,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function So(n){let e,t;return e=new nr({props:{message:n[5]}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&32&&(i.message=r[5]),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function Eo(n){let e,t,r=re(Object.entries(n[2])),s=[];for(let o=0;o<r.length;o+=1)s[o]=Hr(qr(n,r,o));const i=o=>y(s[o],1,1,()=>{s[o]=null});return{c(){e=m("div");for(let o=0;o<s.length;o+=1)s[o].c();d(e,"class","row justify-content-around")},m(o,l){P(o,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(o,l){if(l&4){r=re(Object.entries(o[2]));let a;for(a=0;a<r.length;a+=1){const c=qr(o,r,a);s[a]?(s[a].p(c,l),w(s[a],1)):(s[a]=Hr(c),s[a].c(),w(s[a],1),s[a].m(e,null))}for(W(),a=r.length;a<s.length;a+=1)i(a);Y()}},i(o){if(!t){for(let l=0;l<r.length;l+=1)w(s[l]);t=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)y(s[l]);t=!1},d(o){o&&A(e),Ee(s,o)}}}function Hr(n){let e,t;return e=new Ls({props:{id:n[10].id,name:n[10].name}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&4&&(i.id=r[10].id),s&4&&(i.name=r[10].name),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function To(n){let e,t,r,s;const i=[Eo,So,$o],o=[];function l(a,c){return a[2]?0:a[5]?1:2}return e=l(n),t=o[e]=i[e](n),{c(){t.c(),r=me()},m(a,c){o[e].m(a,c),P(a,r,c),s=!0},p(a,c){let u=e;e=l(a),e===u?o[e].p(a,c):(W(),y(o[u],1,1,()=>{o[u]=null}),Y(),t=o[e],t?t.p(a,c):(t=o[e]=i[e](a),t.c()),w(t,1),t.m(r.parentNode,r))},i(a){s||(w(t),s=!0)},o(a){y(t),s=!1},d(a){a&&A(r),o[e].d(a)}}}function jo(n){let e,t,r,s,i,o,l,a,c,u;return t=new pn({}),s=new Je({props:{title:"Books",icon:"journal",link:"#",$$slots:{default:[bo]},$$scope:{ctx:n}}}),o=new Je({props:{title:"Authors",icon:"person",link:"#",$$slots:{default:[ko]},$$scope:{ctx:n}}}),a=new Je({props:{title:"Publishers",icon:"building",link:"#",$$slots:{default:[To]},$$scope:{ctx:n}}}),{c(){e=m("main"),L(t.$$.fragment),r=E(),L(s.$$.fragment),i=E(),L(o.$$.fragment),l=E(),L(a.$$.fragment),d(e,"class","container mb-5")},m(h,_){P(h,e,_),R(t,e,null),f(e,r),R(s,e,null),f(e,i),R(o,e,null),f(e,l),R(a,e,null),u=!0},p(h,[_]){const p={};_&524297&&(p.$$scope={dirty:_,ctx:h}),s.$set(p);const g={};_&524306&&(g.$$scope={dirty:_,ctx:h}),o.$set(g);const b={};_&524324&&(b.$$scope={dirty:_,ctx:h}),a.$set(b)},i(h){u||(w(t.$$.fragment,h),w(s.$$.fragment,h),w(o.$$.fragment,h),w(a.$$.fragment,h),h&&(c||ge(()=>{c=Xe(e,Ze,{duration:500}),c.start()})),u=!0)},o(h){y(t.$$.fragment,h),y(s.$$.fragment,h),y(o.$$.fragment,h),y(a.$$.fragment,h),u=!1},d(h){h&&A(e),I(t),I(s),I(o),I(a)}}}function Oo(n,e,t){let r,s,i,o,l,a;async function c(){const{data:_,error:p}=await be.rpc("get_books");t(0,r=_),t(3,o=p?p.message:"")}async function u(){const{data:_,error:p}=await be.rpc("get_authors");t(1,s=_),t(4,l=p?p.message:"")}async function h(){const{data:_,error:p}=await be.rpc("get_publishers");t(2,i=_),t(5,a=p||"")}return c(),u(),h(),[r,s,i,o,l,a]}class Ao extends G{constructor(e){super(),J(this,e,Oo,jo,z,{})}}function Co(n){let e,t,r,s,i,o,l,a;return{c(){e=m("div"),t=m("button"),t.innerHTML='<i class="bi bi-arrow-left-circle"></i>',r=E(),s=m("div"),i=m("h4"),o=V(n[0]),d(t,"class","btn"),Ye(t,"font-size","1.5em"),d(i,"class","my-auto"),d(e,"class","d-flex border-bottom border-1 my-3 align-items-center")},m(c,u){P(c,e,u),f(e,t),f(e,r),f(e,s),f(s,i),f(i,o),l||(a=pe(t,"click",n[1]),l=!0)},p(c,[u]){u&1&&ee(o,c[0])},i:j,o:j,d(c){c&&A(e),l=!1,a()}}}function Po(n,e,t){let{text:r}=e;const s=()=>cn();return n.$$set=i=>{"text"in i&&t(0,r=i.text)},[r,s]}class dt extends G{constructor(e){super(),J(this,e,Po,Co,z,{text:0})}}function Ro(n){let e,t;return e=new Ie({}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p:j,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function Io(n){let e,t,r,s,i,o,l,a=n[0].title+"",c,u,h,_=n[0].description+"",p,g,b,v,k,C,T=n[0].author.name+"",$,S,O,D,x,K,U,H=n[0].publisher.name+"",X,ne,se,le,ue,we,F,Q=n[0].category.name+"",ie;return{c(){e=m("div"),t=m("div"),r=m("img"),i=E(),o=m("div"),l=m("h1"),c=V(a),u=E(),h=m("p"),p=V(_),g=E(),b=m("p"),v=m("b"),v.textContent="Author:",k=E(),C=m("a"),$=V(T),O=E(),D=m("p"),x=m("b"),x.textContent="Publisher:",K=E(),U=m("a"),X=V(H),se=E(),le=m("p"),ue=m("b"),ue.textContent="Category:",we=E(),F=m("a"),ie=V(Q),d(r,"id","img-cover"),d(r,"class","border p-3"),de(r.src,s="./"+n[1]+".jpg")||d(r,"src",s),d(r,"alt","book cover"),d(r,"height","300"),d(r,"width","300"),Ye(r,"object-fit","contain"),d(t,"id","book-cover"),d(t,"class","d-flex justify-content-center my-1"),d(l,"id","book-title"),d(l,"class","mb-2 pb-2"),d(h,"id","book-description"),d(C,"href",S="./#/author/"+n[0].author.id),d(U,"href",ne="./#/publisher/"+n[0].publisher.id),d(F,"href","/"),d(o,"id","details-container"),d(o,"class","container"),d(e,"class","d-md-flex d-block")},m(oe,ae){P(oe,e,ae),f(e,t),f(t,r),f(e,i),f(e,o),f(o,l),f(l,c),f(o,u),f(o,h),f(h,p),f(o,g),f(o,b),f(b,v),f(b,k),f(b,C),f(C,$),f(o,O),f(o,D),f(D,x),f(D,K),f(D,U),f(U,X),f(o,se),f(o,le),f(le,ue),f(le,we),f(le,F),f(F,ie)},p(oe,ae){ae&1&&a!==(a=oe[0].title+"")&&ee(c,a),ae&1&&_!==(_=oe[0].description+"")&&ee(p,_),ae&1&&T!==(T=oe[0].author.name+"")&&ee($,T),ae&1&&S!==(S="./#/author/"+oe[0].author.id)&&d(C,"href",S),ae&1&&H!==(H=oe[0].publisher.name+"")&&ee(X,H),ae&1&&ne!==(ne="./#/publisher/"+oe[0].publisher.id)&&d(U,"href",ne),ae&1&&Q!==(Q=oe[0].category.name+"")&&ee(ie,Q)},i:j,o:j,d(oe){oe&&A(e)}}}function Lo(n){let e,t,r,s,i,o,l,a;r=new dt({props:{text:"Book Details"}});const c=[Io,Ro],u=[];function h(_,p){return _[0]?0:1}return i=h(n),o=u[i]=c[i](n),{c(){e=m("main"),t=m("section"),L(r.$$.fragment),s=E(),o.c(),d(e,"class","container")},m(_,p){P(_,e,p),f(e,t),R(r,t,null),f(t,s),u[i].m(t,null),a=!0},p(_,[p]){let g=i;i=h(_),i===g?u[i].p(_,p):(W(),y(u[g],1,1,()=>{u[g]=null}),Y(),o=u[i],o?o.p(_,p):(o=u[i]=c[i](_),o.c()),w(o,1),o.m(t,null))},i(_){a||(w(r.$$.fragment,_),w(o),_&&(l||ge(()=>{l=Xe(e,Ze,{duration:500}),l.start()})),a=!0)},o(_){y(r.$$.fragment,_),y(o),a=!1},d(_){_&&A(e),I(r),u[i].d()}}}function xo(n,e,t){let{params:r}=e,s=r.bookID,i;async function o(){const{data:l,error:a}=await be.from("books").select("title, description, author(id, name), publisher(id, name), category(name)").eq("id",s);console.log(l),t(0,i=l[0])}return lt(o),n.$$set=l=>{"params"in l&&t(2,r=l.params)},[i,s,r]}class Do extends G{constructor(e){super(),J(this,e,xo,Lo,z,{params:2})}}function Uo(n){let e,t,r,s,i,o;const l=n[3].default,a=is(l,n,n[2],null);return{c(){e=m("div"),t=m("label"),r=V(n[0]),s=E(),i=m("div"),a&&a.c(),d(t,"class","col-sm-4 col-md-3 col-form-label"),d(t,"for",n[1]),d(i,"class","col-sm-8 col-md-9"),d(e,"class","my-3 row")},m(c,u){P(c,e,u),f(e,t),f(t,r),f(e,s),f(e,i),a&&a.m(i,null),o=!0},p(c,[u]){(!o||u&1)&&ee(r,c[0]),(!o||u&2)&&d(t,"for",c[1]),a&&a.p&&(!o||u&4)&&ls(a,l,c,c[2],o?as(l,c[2],u,null):cs(c[2]),null)},i(c){o||(w(a,c),o=!0)},o(c){y(a,c),o=!1},d(c){c&&A(e),a&&a.d(c)}}}function No(n,e,t){let{$$slots:r={},$$scope:s}=e,{label:i}=e,{id:o}=e;return n.$$set=l=>{"label"in l&&t(0,i=l.label),"id"in l&&t(1,o=l.id),"$$scope"in l&&t(2,s=l.$$scope)},[i,o,s,r]}class Oe extends G{constructor(e){super(),J(this,e,No,Uo,z,{label:0,id:1})}}function qo(n){let e;return{c(){e=m("input"),d(e,"class","form-control"),d(e,"type","text"),d(e,"id","book-name")},m(t,r){P(t,e,r)},p:j,d(t){t&&A(e)}}}function Mo(n){let e;return{c(){e=m("textarea"),d(e,"class","form-control"),d(e,"id","book-description"),d(e,"rows","4")},m(t,r){P(t,e,r)},p:j,d(t){t&&A(e)}}}function Bo(n){let e,t,r;return{c(){e=m("input"),d(e,"class","form-control"),d(e,"type","file"),d(e,"id","book-cover"),d(e,"accept","image/*")},m(s,i){P(s,e,i),n[5](e),t||(r=pe(e,"change",n[4]),t=!0)},p:j,d(s){s&&A(e),n[5](null),t=!1,r()}}}function Fo(n){let e;return{c(){e=m("input"),d(e,"class","form-control"),d(e,"type","text"),d(e,"id","book-category")},m(t,r){P(t,e,r)},p:j,d(t){t&&A(e)}}}function zo(n){let e;return{c(){e=m("input"),d(e,"list","authors"),d(e,"class","form-control"),d(e,"type","text"),d(e,"id","book-author")},m(t,r){P(t,e,r)},p:j,d(t){t&&A(e)}}}function Ho(n){let e;return{c(){e=m("input"),d(e,"list","publishers"),d(e,"class","form-control"),d(e,"type","text"),d(e,"id","book-publisher")},m(t,r){P(t,e,r)},p:j,d(t){t&&A(e)}}}function Jo(n){let e;return{c(){e=m("input"),d(e,"class","form-control"),d(e,"type","text"),d(e,"id","book-isbn")},m(t,r){P(t,e,r)},p:j,d(t){t&&A(e)}}}function Go(n){let e,t,r,s,i,o,l,a,c,u,h,_,p,g,b,v,k,C,T,$,S,O,D,x,K,U,H,X,ne,se,le,ue,we,F,Q,ie,oe,ae,Le,Ct,xe,Pt,ir;return r=new dt({props:{text:"Add Book"}}),l=new Oe({props:{label:"Book Title:",id:"book-name",$$slots:{default:[qo]},$$scope:{ctx:n}}}),c=new Oe({props:{label:"Book Description:",id:"book-description",$$slots:{default:[Mo]},$$scope:{ctx:n}}}),h=new Oe({props:{label:"Book Cover:",id:"book-cover",$$slots:{default:[Bo]},$$scope:{ctx:n}}}),x=new Oe({props:{label:"Category:",id:"book-category",$$slots:{default:[Fo]},$$scope:{ctx:n}}}),U=new Oe({props:{label:"Author: ",id:"book-author",$$slots:{default:[zo]},$$scope:{ctx:n}}}),X=new Oe({props:{label:"Publisher: ",id:"book-publisher",$$slots:{default:[Ho]},$$scope:{ctx:n}}}),se=new Oe({props:{label:"Category: ",id:"book-category",$$slots:{default:[Jo]},$$scope:{ctx:n}}}),{c(){e=m("section"),t=m("div"),L(r.$$.fragment),s=E(),i=m("div"),o=m("div"),L(l.$$.fragment),a=E(),L(c.$$.fragment),u=E(),L(h.$$.fragment),_=E(),p=m("div"),g=m("label"),g.textContent="Preview:",b=E(),v=m("div"),k=m("img"),T=E(),$=m("button"),$.textContent="Remove",O=E(),D=m("div"),L(x.$$.fragment),K=E(),L(U.$$.fragment),H=E(),L(X.$$.fragment),ne=E(),L(se.$$.fragment),le=E(),ue=m("div"),ue.innerHTML='<button class="btn btn-success" disabled="" id="add"><i class="bi bi-plus-circle"></i> Add Book</button> <a href="./#/"><button class="btn btn-danger" id="cancel"><i class="bi bi-x-circle"></i> Cancel</button></a>',we=E(),F=m("datalist"),Q=m("option"),Q.innerHTML="",ie=m("option"),ie.innerHTML="",oe=E(),ae=m("datalist"),Le=m("option"),Le.innerHTML="",d(g,"for","cover-preview"),d(g,"class","col-sm-4 col-md-3 col-form-label align-self-center"),de(k.src,C=n[3])||d(k,"src",C),d(k,"alt","Preview"),d(k,"id","cover-preview"),d(k,"height","150"),d($,"class","btn btn-sm btn-danger"),d(v,"class","col-sm-8 col-md-9"),d(v,"id","preview-div"),d(p,"class",S="my-3 row "+n[2]),d(o,"class","col-sm-12 col-lg-6"),d(D,"class","col-sm-12 col-lg-6"),d(i,"class","row justify-content-center"),d(t,"class","container-fluid"),d(ue,"class","my-3"),Q.__value="Jemma Development Group",$e(Q,Q.__value),ie.__value="Richard Osman",$e(ie,ie.__value),d(F,"id","authors"),Le.__value="Jemma Inc.",$e(Le,Le.__value),d(ae,"id","publishers"),d(e,"class","my-1 container px-5")},m(M,Z){P(M,e,Z),f(e,t),R(r,t,null),f(t,s),f(t,i),f(i,o),R(l,o,null),f(o,a),R(c,o,null),f(o,u),R(h,o,null),f(o,_),f(o,p),f(p,g),f(p,b),f(p,v),f(v,k),f(v,T),f(v,$),f(i,O),f(i,D),R(x,D,null),f(D,K),R(U,D,null),f(D,H),R(X,D,null),f(D,ne),R(se,D,null),f(e,le),f(e,ue),f(e,we),f(e,F),f(F,Q),f(F,ie),f(e,oe),f(e,ae),f(ae,Le),xe=!0,Pt||(ir=pe($,"click",n[6]),Pt=!0)},p(M,[Z]){const or={};Z&128&&(or.$$scope={dirty:Z,ctx:M}),l.$set(or);const ar={};Z&128&&(ar.$$scope={dirty:Z,ctx:M}),c.$set(ar);const lr={};Z&131&&(lr.$$scope={dirty:Z,ctx:M}),h.$set(lr),(!xe||Z&8&&!de(k.src,C=M[3]))&&d(k,"src",C),(!xe||Z&4&&S!==(S="my-3 row "+M[2]))&&d(p,"class",S);const cr={};Z&128&&(cr.$$scope={dirty:Z,ctx:M}),x.$set(cr);const ur={};Z&128&&(ur.$$scope={dirty:Z,ctx:M}),U.$set(ur);const hr={};Z&128&&(hr.$$scope={dirty:Z,ctx:M}),X.$set(hr);const dr={};Z&128&&(dr.$$scope={dirty:Z,ctx:M}),se.$set(dr)},i(M){xe||(w(r.$$.fragment,M),w(l.$$.fragment,M),w(c.$$.fragment,M),w(h.$$.fragment,M),w(x.$$.fragment,M),w(U.$$.fragment,M),w(X.$$.fragment,M),w(se.$$.fragment,M),M&&(Ct||ge(()=>{Ct=Xe(e,Ze,{duration:500}),Ct.start()})),xe=!0)},o(M){y(r.$$.fragment,M),y(l.$$.fragment,M),y(c.$$.fragment,M),y(h.$$.fragment,M),y(x.$$.fragment,M),y(U.$$.fragment,M),y(X.$$.fragment,M),y(se.$$.fragment,M),xe=!1},d(M){M&&A(e),I(r),I(l),I(c),I(h),I(x),I(U),I(X),I(se),Pt=!1,ir()}}}function Ko(n,e,t){let r,s,i="d-none",o;function l(){r=this.files,t(0,r)}function a(u){kt[u?"unshift":"push"](()=>{s=u,t(1,s)})}const c=()=>{t(1,s.value="",s),t(0,r="")};return n.$$.update=()=>{if(n.$$.dirty&1)if(r&&r[0]){console.log(r),t(2,i="");const u=URL.createObjectURL(r[0]);t(3,o=u)}else console.log(r),t(2,i="d-none")},[r,s,i,o,l,a,c]}class Vo extends G{constructor(e){super(),J(this,e,Ko,Go,z,{})}}function Jr(n,e,t){const r=n.slice();return r[5]=e[t][0],r[6]=e[t][1],r}function Wo(n){let e,t;return e=new Ie({}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p:j,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function Yo(n){let e,t,r=n[0].name+"",s,i,o,l,a;return{c(){e=m("div"),t=m("h1"),s=V(r),i=E(),o=m("p"),o.textContent=`Lorem ipsum dolor sit amet pariatur est libero! Facilis ipsum est\r
            voluptas animi aliquam dolorem sunt, iure consequuntur dignissimos\r
            doloremque! Neque velit quas, illum, facere aliquam sed\r
            exercitationem at voluptatem incidunt beatae voluptate deserunt.`,l=E(),a=m("p"),a.innerHTML='<b>Website:</b> <a href="https://github.com/salles4/">salles4.github.io</a>',d(t,"class","mb-2 pb-2"),d(o,"class",""),d(e,"class","container")},m(c,u){P(c,e,u),f(e,t),f(t,s),f(e,i),f(e,o),f(e,l),f(e,a)},p(c,u){u&1&&r!==(r=c[0].name+"")&&ee(s,r)},i:j,o:j,d(c){c&&A(e)}}}function Xo(n){let e,t;return e=new Ie({}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p:j,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function Qo(n){let e,t,r=re(Object.entries(n[1])),s=[];for(let o=0;o<r.length;o+=1)s[o]=Gr(Jr(n,r,o));const i=o=>y(s[o],1,1,()=>{s[o]=null});return{c(){e=m("div");for(let o=0;o<s.length;o+=1)s[o].c();d(e,"class","row")},m(o,l){P(o,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(o,l){if(l&2){r=re(Object.entries(o[1]));let a;for(a=0;a<r.length;a+=1){const c=Jr(o,r,a);s[a]?(s[a].p(c,l),w(s[a],1)):(s[a]=Gr(c),s[a].c(),w(s[a],1),s[a].m(e,null))}for(W(),a=r.length;a<s.length;a+=1)i(a);Y()}},i(o){if(!t){for(let l=0;l<r.length;l+=1)w(s[l]);t=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)y(s[l]);t=!1},d(o){o&&A(e),Ee(s,o)}}}function Gr(n){let e,t;return e=new jt({props:{title:n[6].title,id:n[6].id,author:n[6].author.name}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&2&&(i.title=r[6].title),s&2&&(i.id=r[6].id),s&2&&(i.author=r[6].author.name),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function Zo(n){let e,t,r,s;const i=[Qo,Xo],o=[];function l(a,c){return a[1]?0:1}return e=l(n),t=o[e]=i[e](n),{c(){t.c(),r=me()},m(a,c){o[e].m(a,c),P(a,r,c),s=!0},p(a,c){let u=e;e=l(a),e===u?o[e].p(a,c):(W(),y(o[u],1,1,()=>{o[u]=null}),Y(),t=o[e],t?t.p(a,c):(t=o[e]=i[e](a),t.c()),w(t,1),t.m(r.parentNode,r))},i(a){s||(w(t),s=!0)},o(a){y(t),s=!1},d(a){a&&A(r),o[e].d(a)}}}function ea(n){let e,t,r,s,i,o,l,a,c,u,h,_,p,g,b;r=new dt({props:{text:"Author Details"}});const v=[Yo,Wo],k=[];function C(T,$){return T[0]?0:1}return u=C(n),h=k[u]=v[u](n),p=new Je({props:{title:"Books",icon:"journal",$$slots:{default:[Zo]},$$scope:{ctx:n}}}),{c(){e=m("main"),t=m("section"),L(r.$$.fragment),s=E(),i=m("div"),o=m("div"),l=m("img"),c=E(),h.c(),_=E(),L(p.$$.fragment),d(l,"class","border p-3"),de(l.src,a=ta)||d(l,"src",a),d(l,"alt","author"),d(l,"height","300"),d(l,"width","300"),Ye(l,"object-fit","contain"),d(o,"class","d-flex justify-content-center my-1"),d(i,"class","d-md-flex d-block"),d(e,"class","container")},m(T,$){P(T,e,$),f(e,t),R(r,t,null),f(t,s),f(t,i),f(i,o),f(o,l),f(i,c),k[u].m(i,null),f(e,_),R(p,e,null),b=!0},p(T,[$]){let S=u;u=C(T),u===S?k[u].p(T,$):(W(),y(k[S],1,1,()=>{k[S]=null}),Y(),h=k[u],h?h.p(T,$):(h=k[u]=v[u](T),h.c()),w(h,1),h.m(i,null));const O={};$&514&&(O.$$scope={dirty:$,ctx:T}),p.$set(O)},i(T){b||(w(r.$$.fragment,T),w(h),w(p.$$.fragment,T),T&&(g||ge(()=>{g=Xe(e,Ze,{duration:500}),g.start()})),b=!0)},o(T){y(r.$$.fragment,T),y(h),y(p.$$.fragment,T),b=!1},d(T){T&&A(e),I(r),k[u].d(),I(p)}}}let ta="./default-profile.jpg";function ra(n,e,t){let{params:r}=e,s=r.authorID,i,o;async function l(){const{data:a,error:c}=await be.from("author").select().eq("id",s);console.log(a),t(0,i=a[0]);const{data:u,error:h}=await be.from("books").select("id, title, author(name)").eq("publisher_id",s);console.log(u),t(1,o=u)}return lt(l),n.$$set=a=>{"params"in a&&t(2,r=a.params)},[i,o,r]}class sa extends G{constructor(e){super(),J(this,e,ra,ea,z,{params:2})}}function Kr(n,e,t){const r=n.slice();return r[5]=e[t][0],r[6]=e[t][1],r}function Vr(n){let e,t,r=n[0].name+"",s,i,o,l,a;return{c(){e=m("div"),t=m("h1"),s=V(r),i=E(),o=m("p"),o.textContent=`Lorem ipsum dolor sit amet pariatur est libero! Facilis ipsum est\r
          voluptas animi aliquam dolorem sunt, iure consequuntur dignissimos\r
          doloremque! Neque velit quas, illum, facere aliquam sed exercitationem\r
          at voluptatem incidunt beatae voluptate deserunt.`,l=E(),a=m("p"),a.innerHTML='<b>Website:</b> <a href="https://github.com/salles4/" id="publisher-website">salles4.github.io</a>',d(t,"id","publisher-name"),d(t,"class","mb-2 pb-2"),d(o,"id","publisher-bio"),d(o,"class",""),d(e,"id","details-container"),d(e,"class","container")},m(c,u){P(c,e,u),f(e,t),f(t,s),f(e,i),f(e,o),f(e,l),f(e,a)},p(c,u){u&1&&r!==(r=c[0].name+"")&&ee(s,r)},d(c){c&&A(e)}}}function na(n){let e,t;return e=new Ie({}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p:j,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function ia(n){let e,t,r=re(Object.entries(n[1])),s=[];for(let o=0;o<r.length;o+=1)s[o]=Wr(Kr(n,r,o));const i=o=>y(s[o],1,1,()=>{s[o]=null});return{c(){e=m("div");for(let o=0;o<s.length;o+=1)s[o].c();d(e,"class","row")},m(o,l){P(o,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(o,l){if(l&2){r=re(Object.entries(o[1]));let a;for(a=0;a<r.length;a+=1){const c=Kr(o,r,a);s[a]?(s[a].p(c,l),w(s[a],1)):(s[a]=Wr(c),s[a].c(),w(s[a],1),s[a].m(e,null))}for(W(),a=r.length;a<s.length;a+=1)i(a);Y()}},i(o){if(!t){for(let l=0;l<r.length;l+=1)w(s[l]);t=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)y(s[l]);t=!1},d(o){o&&A(e),Ee(s,o)}}}function Wr(n){let e,t;return e=new jt({props:{title:n[6].title,id:n[6].id,author:n[6].author.name}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&2&&(i.title=r[6].title),s&2&&(i.id=r[6].id),s&2&&(i.author=r[6].author.name),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function oa(n){let e,t,r,s,i,o,l,a,c,u,h,_,p,g,b,v;t=new dt({props:{text:"Publisher Details"}});let k=n[0]&&Vr(n);_=new Je({props:{title:"Books",icon:"journal"}});const C=[ia,na],T=[];function $(S,O){return S[1]?0:1}return g=$(n),b=T[g]=C[g](n),{c(){e=m("section"),L(t.$$.fragment),r=E(),s=m("div"),i=m("div"),o=m("img"),a=E(),k&&k.c(),u=E(),h=m("section"),L(_.$$.fragment),p=E(),b.c(),d(o,"id","img-cover"),d(o,"class","border p-3"),de(o.src,l=aa)||d(o,"src",l),d(o,"alt","publisher"),d(o,"height","300"),d(o,"width","300"),Ye(o,"object-fit","contain"),d(i,"id","publisher-cover"),d(i,"class","d-flex justify-content-center my-1"),d(s,"class","d-md-flex d-block"),d(e,"class","container"),d(h,"class","container")},m(S,O){P(S,e,O),R(t,e,null),f(e,r),f(e,s),f(s,i),f(i,o),f(s,a),k&&k.m(s,null),P(S,u,O),P(S,h,O),R(_,h,null),f(h,p),T[g].m(h,null),v=!0},p(S,[O]){S[0]?k?k.p(S,O):(k=Vr(S),k.c(),k.m(s,null)):k&&(k.d(1),k=null);let D=g;g=$(S),g===D?T[g].p(S,O):(W(),y(T[D],1,1,()=>{T[D]=null}),Y(),b=T[g],b?b.p(S,O):(b=T[g]=C[g](S),b.c()),w(b,1),b.m(h,null))},i(S){v||(w(t.$$.fragment,S),S&&(c||ge(()=>{c=Xe(e,Ze,{duration:500}),c.start()})),w(_.$$.fragment,S),w(b),v=!0)},o(S){y(t.$$.fragment,S),y(_.$$.fragment,S),y(b),v=!1},d(S){S&&(A(e),A(u),A(h)),I(t),k&&k.d(),I(_),T[g].d()}}}let aa="./default-profile.jpg";function la(n,e,t){let{params:r}=e,s=r.publisherID,i,o;async function l(){const{data:a,error:c}=await be.from("publisher").select().eq("id",s);console.log(a),t(0,i=a[0]);const{data:u,error:h}=await be.from("books").select("id, title, author(name)").eq("publisher_id",s);console.log(u),t(1,o=u)}return lt(l),n.$$set=a=>{"params"in a&&t(2,r=a.params)},[i,o,r]}class ca extends G{constructor(e){super(),J(this,e,la,oa,z,{params:2})}}function ua(n){let e,t,r,s,i,o,l,a,c,u;return{c(){e=m("div"),t=m("div"),r=m("i"),i=E(),o=m("div"),l=m("h5"),a=m("a"),c=V(n[0]),d(r,"class",s="bi bi-"+n[2]),d(t,"class","d-flex justify-content-center"),Ye(t,"font-size","4em"),d(a,"class","stretched-link svelte-1vxezln"),d(a,"href",u="./#/"+n[1]),d(l,"class","card-title text-center my-3"),d(o,"class","card-body p-1"),d(e,"class","card col-md-3 col-6 border-1 py-4 svelte-1vxezln")},m(h,_){P(h,e,_),f(e,t),f(t,r),f(e,i),f(e,o),f(o,l),f(l,a),f(a,c)},p(h,[_]){_&4&&s!==(s="bi bi-"+h[2])&&d(r,"class",s),_&1&&ee(c,h[0]),_&2&&u!==(u="./#/"+h[1])&&d(a,"href",u)},i:j,o:j,d(h){h&&A(e)}}}function ha(n,e,t){let{name:r}=e,{link:s}=e,{icon:i=""}=e;return n.$$set=o=>{"name"in o&&t(0,r=o.name),"link"in o&&t(1,s=o.link),"icon"in o&&t(2,i=o.icon)},[r,s,i]}class gt extends G{constructor(e){super(),J(this,e,ha,ua,z,{name:0,link:1,icon:2})}}function da(n){let e,t,r,s,i,o,l,a,c,u,h,_;return t=new Je({props:{title:"Welcome!",icon:"wrench-adjustable"}}),i=new gt({props:{name:"Borrow",link:"borrow",icon:"journal-arrow-up"}}),l=new gt({props:{name:"Return",link:"return",icon:"journal-arrow-down"}}),c=new gt({props:{name:"Add Book",link:"add-book",icon:"journal-plus"}}),h=new gt({props:{name:"Manage",link:"manage",icon:"journal-album"}}),{c(){e=m("main"),L(t.$$.fragment),r=E(),s=m("div"),L(i.$$.fragment),o=E(),L(l.$$.fragment),a=E(),L(c.$$.fragment),u=E(),L(h.$$.fragment),d(s,"class","row"),d(e,"class","container")},m(p,g){P(p,e,g),R(t,e,null),f(e,r),f(e,s),R(i,s,null),f(s,o),R(l,s,null),f(s,a),R(c,s,null),f(s,u),R(h,s,null),_=!0},p:j,i(p){_||(w(t.$$.fragment,p),w(i.$$.fragment,p),w(l.$$.fragment,p),w(c.$$.fragment,p),w(h.$$.fragment,p),_=!0)},o(p){y(t.$$.fragment,p),y(i.$$.fragment,p),y(l.$$.fragment,p),y(c.$$.fragment,p),y(h.$$.fragment,p),_=!1},d(p){p&&A(e),I(t),I(i),I(l),I(c),I(h)}}}class fa extends G{constructor(e){super(),J(this,e,null,da,z,{})}}function Yr(n,e,t){const r=n.slice();return r[12]=e[t][0],r[13]=e[t][1],r}function Xr(n,e,t){const r=n.slice();return r[12]=e[t][0],r[13]=e[t][1],r}function Qr(n,e,t){const r=n.slice();return r[12]=e[t][0],r[13]=e[t][1],r}function _a(n){let e;return{c(){e=m("div"),e.innerHTML='<div class="text-center"><h1><i class="bi bi-patch-question"></i></h1> <h4>No Results</h4></div>',d(e,"class","d-flex justify-content-center")},m(t,r){P(t,e,r)},p:j,i:j,o:j,d(t){t&&A(e)}}}function pa(n){let e,t,r=re(Object.entries(n[1].publisher)),s=[];for(let o=0;o<r.length;o+=1)s[o]=Zr(Yr(n,r,o));const i=o=>y(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=me()},m(o,l){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(o,l);P(o,e,l),t=!0},p(o,l){if(l&2){r=re(Object.entries(o[1].publisher));let a;for(a=0;a<r.length;a+=1){const c=Yr(o,r,a);s[a]?(s[a].p(c,l),w(s[a],1)):(s[a]=Zr(c),s[a].c(),w(s[a],1),s[a].m(e.parentNode,e))}for(W(),a=r.length;a<s.length;a+=1)i(a);Y()}},i(o){if(!t){for(let l=0;l<r.length;l+=1)w(s[l]);t=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)y(s[l]);t=!1},d(o){o&&A(e),Ee(s,o)}}}function ma(n){let e,t,r=re(Object.entries(n[1].author)),s=[];for(let o=0;o<r.length;o+=1)s[o]=es(Xr(n,r,o));const i=o=>y(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=me()},m(o,l){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(o,l);P(o,e,l),t=!0},p(o,l){if(l&2){r=re(Object.entries(o[1].author));let a;for(a=0;a<r.length;a+=1){const c=Xr(o,r,a);s[a]?(s[a].p(c,l),w(s[a],1)):(s[a]=es(c),s[a].c(),w(s[a],1),s[a].m(e.parentNode,e))}for(W(),a=r.length;a<s.length;a+=1)i(a);Y()}},i(o){if(!t){for(let l=0;l<r.length;l+=1)w(s[l]);t=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)y(s[l]);t=!1},d(o){o&&A(e),Ee(s,o)}}}function ga(n){let e,t,r=re(Object.entries(n[1].books)),s=[];for(let o=0;o<r.length;o+=1)s[o]=ts(Qr(n,r,o));const i=o=>y(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=me()},m(o,l){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(o,l);P(o,e,l),t=!0},p(o,l){if(l&2){r=re(Object.entries(o[1].books));let a;for(a=0;a<r.length;a+=1){const c=Qr(o,r,a);s[a]?(s[a].p(c,l),w(s[a],1)):(s[a]=ts(c),s[a].c(),w(s[a],1),s[a].m(e.parentNode,e))}for(W(),a=r.length;a<s.length;a+=1)i(a);Y()}},i(o){if(!t){for(let l=0;l<r.length;l+=1)w(s[l]);t=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)y(s[l]);t=!1},d(o){o&&A(e),Ee(s,o)}}}function Zr(n){let e,t;return e=new Ls({props:{id:n[13].id,name:n[13].name}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&2&&(i.id=r[13].id),s&2&&(i.name=r[13].name),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function es(n){let e,t;return e=new Is({props:{id:n[13].id,name:n[13].name}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&2&&(i.id=r[13].id),s&2&&(i.name=r[13].name),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function ts(n){let e,t;return e=new jt({props:{title:n[13].title,id:n[13].id,author:n[13].author.name}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},p(r,s){const i={};s&2&&(i.title=r[13].title),s&2&&(i.id=r[13].id),s&2&&(i.author=r[13].author.name),e.$set(i)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function ba(n){let e,t,r,s,i,o,l,a,c,u,h,_,p,g,b,v,k,C,T,$,S,O;t=new dt({props:{text:"Library Holdings"}});const D=[ga,ma,pa,_a],x=[];function K(U,H){return U[1].books?0:U[1].author?1:U[1].publisher?2:3}return k=K(n),C=x[k]=D[k](n),{c(){e=m("main"),L(t.$$.fragment),r=E(),s=m("div"),i=m("div"),o=m("select"),l=m("option"),l.textContent="Books",a=m("option"),a.textContent="Author",c=m("option"),c.textContent="Publisher",u=E(),h=m("div"),_=m("input"),p=E(),g=m("button"),g.innerHTML='<i class="bi bi-search"></i>',b=E(),v=m("div"),C.c(),l.selected=!0,l.__value="books",$e(l,l.__value),a.__value="author",$e(a,a.__value),c.__value="publisher",$e(c,c.__value),d(o,"name","searchtype"),d(o,"class","form-select"),d(i,"class","col-auto col-md-2 p-0 pe-md-4"),d(_,"class","form-control form-control-lg"),d(_,"type","search"),d(_,"placeholder","Search"),d(_,"name","Search"),d(h,"class","col-6 col-md-6 p-0"),d(g,"class","btn btn-lg btn-success col-auto col-md-1"),d(g,"type","submit"),d(s,"class","row justify-content-center align-items-center my-4 mx-auto col-12"),d(v,"class","row"),d(e,"class","container")},m(U,H){P(U,e,H),R(t,e,null),f(e,r),f(e,s),f(s,i),f(i,o),f(o,l),f(o,a),f(o,c),n[4](o),f(s,u),f(s,h),f(h,_),$e(_,n[0]),f(s,p),f(s,g),f(e,b),f(e,v),x[k].m(v,null),$=!0,S||(O=[pe(o,"change",n[3]),pe(_,"input",n[5]),pe(_,"keyup",n[6]),pe(g,"click",n[3])],S=!0)},p(U,[H]){H&1&&_.value!==U[0]&&$e(_,U[0]);let X=k;k=K(U),k===X?x[k].p(U,H):(W(),y(x[X],1,1,()=>{x[X]=null}),Y(),C=x[k],C?C.p(U,H):(C=x[k]=D[k](U),C.c()),w(C,1),C.m(v,null))},i(U){$||(w(t.$$.fragment,U),w(C),U&&(T||ge(()=>{T=Xe(e,Ze,{duration:500}),T.start()})),$=!0)},o(U){y(t.$$.fragment,U),y(C),$=!1},d(U){U&&A(e),I(t),n[4](null),x[k].d(),S=!1,ve(O)}}}function va(n,e,t){let r;Ns(n,ln,b=>t(8,r=b));function s(){switch(r){case"/search/author":t(2,u.value="author",u);break;case"/search/publisher":t(2,u.value="publisher",u);break;default:t(2,u.value="books",u)}}const i={books:"id, title, author(name)",author:"id, name",publisher:"id, name"},o={books:"title",author:"name",publisher:"name"};let l="books",a="",c={books:void 0,author:void 0,publisher:void 0},u;async function h(){l=u.value,console.log(l);const{data:b,error:v}=await be.from(l).select(i[l]).ilike(o[l],`%${a}%`);v&&console.log(v),t(1,c.books=void 0,c),t(1,c.author=void 0,c),t(1,c.publisher=void 0,c),t(1,c[l]=b,c),t(1,c)}lt(s),lt(h);function _(b){kt[b?"unshift":"push"](()=>{u=b,t(2,u)})}function p(){a=this.value,t(0,a)}return[a,c,u,h,_,p,b=>b.key==="Enter"&&h()]}class Ke extends G{constructor(e){super(),J(this,e,va,ba,z,{})}}function wa(n){let e,t,r,s,i,o;return{c(){e=m("div"),t=m("button"),t.textContent="Client",r=E(),s=m("button"),s.textContent="Staff",d(t,"class","m-2 btn btn-primary btn-lg"),d(s,"class","m-2 btn btn-danger btn-lg"),d(e,"class","d-flex justify-content-center align-items-center"),Ye(e,"height","90vh")},m(l,a){P(l,e,a),f(e,t),f(e,r),f(e,s),i||(o=[pe(t,"click",n[0]),pe(s,"click",n[1])],i=!0)},p:j,i:j,o:j,d(l){l&&A(e),i=!1,ve(o)}}}function ya(n){return document.querySelector("body").setAttribute("data-bs-theme","dark"),[()=>{ct.set("client"),localStorage.setItem("accType","client")},()=>{ct.set("staff"),localStorage.setItem("accType","staff")}]}class ka extends G{constructor(e){super(),J(this,e,ya,wa,z,{})}}function $a(n){let e,t;return e=new Xt({props:{routes:{"*":ka}}}),{c(){L(e.$$.fragment)},m(r,s){R(e,r,s),t=!0},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function Sa(n){let e,t,r,s;return e=new ws({}),r=new Xt({props:{routes:{"/":fa,"/add-book":Vo,"/search":Ke,"/search/author":Ke,"/search/publisher":Ke}}}),{c(){L(e.$$.fragment),t=E(),L(r.$$.fragment)},m(i,o){R(e,i,o),P(i,t,o),R(r,i,o),s=!0},i(i){s||(w(e.$$.fragment,i),w(r.$$.fragment,i),s=!0)},o(i){y(e.$$.fragment,i),y(r.$$.fragment,i),s=!1},d(i){i&&A(t),I(e,i),I(r,i)}}}function Ea(n){let e,t,r,s;return e=new ws({}),r=new Xt({props:{routes:{"/":Ao,"/book/:bookID":Do,"/author/:authorID":sa,"/publisher/:publisherID":ca,"/search":Ke,"/search/author":Ke,"/search/publisher":Ke}}}),{c(){L(e.$$.fragment),t=E(),L(r.$$.fragment)},m(i,o){R(e,i,o),P(i,t,o),R(r,i,o),s=!0},i(i){s||(w(e.$$.fragment,i),w(r.$$.fragment,i),s=!0)},o(i){y(e.$$.fragment,i),y(r.$$.fragment,i),s=!1},d(i){i&&A(t),I(e,i),I(r,i)}}}function Ta(n){let e,t,r,s;const i=[Ea,Sa,$a],o=[];function l(a,c){return a[0]=="client"?0:a[0]=="staff"?1:2}return e=l(n),t=o[e]=i[e](n),{c(){t.c(),r=me()},m(a,c){o[e].m(a,c),P(a,r,c),s=!0},p(a,[c]){let u=e;e=l(a),e!==u&&(W(),y(o[u],1,1,()=>{o[u]=null}),Y(),t=o[e],t||(t=o[e]=i[e](a),t.c()),w(t,1),t.m(r.parentNode,r))},i(a){s||(w(t),s=!0)},o(a){y(t),s=!1},d(a){a&&A(r),o[e].d(a)}}}function ja(n,e,t){let r;return ct.subscribe(s=>{t(0,r=s)}),[r]}class Oa extends G{constructor(e){super(),J(this,e,ja,Ta,z,{})}}new Oa({target:document.getElementById("app")});
